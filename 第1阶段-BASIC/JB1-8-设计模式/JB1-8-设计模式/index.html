<!doctype html><html lang=en><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>JB1-8-设计模式</title>
<meta name=description content="Java道经第1卷 - 第8阶 - v1-8-basic-design(JAR) - 设计模式
心法: 设计模式分类
GoF四人帮在《设计模式 - 可复用面向对象软件基础》一书总结了23种设计模式，根据用途分为3类。 第一类: 创建型设计模式: 中文 英文 设计模式的核心特点 单例模式 Singleton 保证系统中仅 …"><meta name=keywords content='blog,lsx2216,hugo'><meta property="og:url" content="https://lsx2216.netlify.app/%E7%AC%AC1%E9%98%B6%E6%AE%B5-BASIC/JB1-8-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/JB1-8-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><meta property="og:type" content="website"><meta property="og:title" content="JB1-8-设计模式"><meta property="og:description" content="Java道经第1卷 - 第8阶 - v1-8-basic-design(JAR) - 设计模式
心法: 设计模式分类
GoF四人帮在《设计模式 - 可复用面向对象软件基础》一书总结了23种设计模式，根据用途分为3类。 第一类: 创建型设计模式: 中文 英文 设计模式的核心特点 单例模式 Singleton 保证系统中仅 …"><meta property="og:image" content="https://lsx2216.netlify.app/assets/images/user.jpg"><meta property="og:image:secure_url" content="https://lsx2216.netlify.app/assets/images/user.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="JB1-8-设计模式"><meta name=twitter:description content="Java道经第1卷 - 第8阶 - v1-8-basic-design(JAR) - 设计模式
心法: 设计模式分类
GoF四人帮在《设计模式 - 可复用面向对象软件基础》一书总结了23种设计模式，根据用途分为3类。 第一类: 创建型设计模式: 中文 英文 设计模式的核心特点 单例模式 Singleton 保证系统中仅 …"><meta property="twitter:domain" content="https://lsx2216.netlify.app/%E7%AC%AC1%E9%98%B6%E6%AE%B5-BASIC/JB1-8-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/JB1-8-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><meta property="twitter:url" content="https://lsx2216.netlify.app/%E7%AC%AC1%E9%98%B6%E6%AE%B5-BASIC/JB1-8-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/JB1-8-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><meta name=twitter:image content="https://lsx2216.netlify.app/assets/images/user.jpg"><link rel=canonical href=https://lsx2216.netlify.app/%E7%AC%AC1%E9%98%B6%E6%AE%B5-BASIC/JB1-8-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/JB1-8-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.3eb19cb61dde9e37b9522867f3e024aeb68e26ab8e03252e46e365abcb19acf7.js integrity="sha256-PrGcth3enje5Uihn8+AkrraOJquOAyUuRuNlq8sZrPc="></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css integrity=sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js integrity=sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})})</script>    <link rel="shortcut icon" href="/assets/images/user.jpg" type="image/x-icon">
</head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://lsx2216.netlify.app/><img src=/assets/images/user.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://lsx2216.netlify.app/>lsx2216</a></div><div class=nav-links><div class=nav-link><a href=https://lsx2216.netlify.app/ aria-label><span data-feather=home></span> Home</a></div><div class=nav-link><a href=https://lsx2216.netlify.app/projects/ aria-label><span data-feather=code></span> Projects</a></div><div class=nav-link><a href=https://github.com aria-label=github><span data-feather=github></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://lsx2216.netlify.app/><span data-feather=home></span> Home</a></li><li class=nav-item><a href=https://lsx2216.netlify.app/projects/><span data-feather=code></span> Projects</a></li><li class=nav-item><a href=https://github.com><span data-feather=github></span></a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>JB1-8-设计模式</h1></div><div class=post-content><blockquote><p>Java道经第1卷 - 第8阶 - v1-8-basic-design(JAR) - 设计模式</p></blockquote><hr><blockquote><p>心法: 设计模式分类</p></blockquote><ul><li>GoF四人帮在《设计模式 - 可复用面向对象软件基础》一书总结了23种设计模式，根据用途分为3类。</li></ul><ol><li>第一类: 创建型设计模式:</li></ol><table><thead><tr><th>中文</th><th>英文</th><th>设计模式的核心特点</th></tr></thead><tbody><tr><td>单例模式</td><td><code>Singleton</code></td><td>保证系统中仅可以存在唯一实例</td></tr><tr><td>建造者模式</td><td><code>Builder</code></td><td>创建实例和使用实例的代码解耦，注重细节</td></tr><tr><td>工厂模式</td><td><code>Factory</code></td><td>创建实例和使用实例的代码解耦，注重整体</td></tr><tr><td>原型模式</td><td><code>Prototype</code></td><td>克隆实例</td></tr></tbody></table><ol start=2><li>第二类: 结构型设计模式:</li></ol><table><thead><tr><th>中文</th><th>英文</th><th>设计模式的核心特点</th></tr></thead><tbody><tr><td>适配器模式</td><td><code>Adapter</code></td><td>接口和接口兼容</td></tr><tr><td>桥接模式</td><td><code>Bridge</code></td><td>抽象和接口解耦，抽离配置</td></tr><tr><td>过滤器模式</td><td><code>Filter</code></td><td>根据指定条件进行过滤</td></tr><tr><td>装饰器模式</td><td><code>Decorator</code></td><td>在不破坏原结构的情况下扩展类</td></tr><tr><td>组合模式</td><td><code>Composite</code></td><td>使用树形结构来表示整体和局部的层次结构</td></tr><tr><td>外观模式</td><td><code>Facade</code></td><td>在客户端和复杂系统结构之间再添加一层</td></tr><tr><td>享元模式</td><td><code>Flyweight</code></td><td>利用缓存池技术减少重复对象的创建过程</td></tr><tr><td>代理模式</td><td><code>Proxy</code></td><td>聘用代理来代替执行客户端任务，拓展客户业务功能</td></tr></tbody></table><ol start=3><li>第三类: 行为型设计模式:</li></ol><table><thead><tr><th>中文</th><th>英文</th><th>设计模式的核心特点</th></tr></thead><tbody><tr><td>策略模式</td><td><code>Strategy</code></td><td>将各种策略封装成类，并交给用户来决定使用哪一种</td></tr><tr><td>模板模式</td><td><code>Template</code></td><td>父类控制整体流程，子类实现每个流程的具体步骤</td></tr><tr><td>空对象模式</td><td><code>Null Object</code></td><td>设计空对象以避免空指针异常以及省略调用方的null值检查</td></tr><tr><td>命令模式</td><td><code>Command</code></td><td>对 <code>Invoker</code> 命令调用者和 <code>Receiver</code> 命令接收者进行解耦</td></tr><tr><td>解释器模式</td><td><code>Interpreter</code></td><td>-</td></tr><tr><td>迭代器模式</td><td><code>Iterator</code></td><td>-</td></tr><tr><td>中介者模式</td><td><code>Mediator</code></td><td>-</td></tr><tr><td>备忘录模式</td><td><code>Memento</code></td><td>-</td></tr><tr><td>观察者模式</td><td><code>Observer</code></td><td>-</td></tr><tr><td>状态模式</td><td><code>State</code></td><td>-</td></tr><tr><td>访问者模式</td><td><code>Visitor</code></td><td>-</td></tr><tr><td>责任链模式</td><td><code>Chain of Responsibility</code></td><td>-</td></tr></tbody></table><h1 id=ch01-单例设计模式>CH01. 单例设计模式</h1><blockquote><p>心法: 单例模式 <code>Singleton Pattern</code>，也叫单件模式</p></blockquote><ul><li>单例模式下的类，有且只有一个该类的实例可以提供给调用方。</li><li>单例模式优点:<ul><li>在内存中只有一个实例，减少内存开销，且避免频繁地创建实例和销毁实例。</li></ul></li><li>单例模式缺点:<ul><li>违反了单一职责，单例类既要负责创建实例，又要负责业务功能。</li></ul></li></ul><h2 id=ep01-饿汉式单例模式>EP01. 饿汉式单例模式</h2><blockquote><p>心法: 饿汉式单例模式</p></blockquote><ul><li>饿汉单例模式:<ul><li>核心: 类加载时，就提前new好一个该类的实例备用。</li><li>优点: 不用加锁也能保证线程安全，执行效率高。</li><li>缺点: 无论是否有人使用该实例，它都会一直占用着内存。</li></ul></li><li>饿汉单例模式流程:<ol><li>将构造器私有化。</li><li>在内部自己new一个实例备用。</li><li>对外提供一个可以获取该类唯一实例的静态方法。</li></ol></li></ul><blockquote><p>武技: 设计饿汉式单例模式</p></blockquote><ol><li>开发测试类 <code>HungrySingletonTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> singleton;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HungrySingletonTest</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Demo</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/* 类加载时，就提前new好一个该类的实例备用 */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>static</span> Demo instance <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Demo();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/** 单例模式的构造器，必须私有化 */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>Demo</span>() {
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/** 对外提供一个可以获取该类唯一实例的静态方法 */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> Demo <span style=color:#a6e22e>getInstance</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> instance;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/** 业务方法 */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>method01</span>() {
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;我是普通的业务方法&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testHungrySingleton</span>() {
</span></span><span style=display:flex><span>        Demo demo01 <span style=color:#f92672>=</span> Demo.<span style=color:#a6e22e>getInstance</span>();
</span></span><span style=display:flex><span>        Demo demo02 <span style=color:#f92672>=</span> Demo.<span style=color:#a6e22e>getInstance</span>();
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(demo01 <span style=color:#f92672>==</span> demo02);
</span></span><span style=display:flex><span>        demo01.<span style=color:#a6e22e>method01</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep02-饱汉式单例模式>EP02. 饱汉式单例模式</h2><blockquote><p>心法: 饱汉式单例模式，也叫懒汉单例模式</p></blockquote><ul><li>饱汉单例模式:<ul><li>核心: 仅在有人想要获取该实例时，才会执行实例化操作。</li><li>优点: 节省内存。</li><li>缺点: 存在线程安全问题。</li></ul></li><li>饱汉单例模式流程:<ol><li>将构造器私有化。</li><li>对外提供一个可以获取该类唯一实例的静态方法。</li><li>在对外提供的静态方法内部，进行实例化操作，需要添加一道null值检查以保证单例性。</li></ol></li></ul><blockquote><p>武技: 设计饱汉式单例模式</p></blockquote><ol><li>开发测试类 <code>FullSingletonTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> singleton;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FullSingletonTest</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 单例类 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Demo</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/** 饱汉模式下的实例: 仅声明不赋值 */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> Demo instance;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/** 单例模式的构造器，必须私有化 */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>Demo</span>() {
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/** 对外提供一个可以获取该类唯一实例的静态方法 */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> Demo <span style=color:#a6e22e>getInstance</span>() {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// null值检查以保证单例性</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (instance <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>                instance <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Demo();
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> instance;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/** 业务方法 */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>method01</span>() {
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;我是普通的业务方法&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testFullSingleton</span>() {
</span></span><span style=display:flex><span>        Demo demo01 <span style=color:#f92672>=</span> Demo.<span style=color:#a6e22e>getInstance</span>();
</span></span><span style=display:flex><span>        Demo demo02 <span style=color:#f92672>=</span> Demo.<span style=color:#a6e22e>getInstance</span>();
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(demo01 <span style=color:#f92672>==</span> demo02);
</span></span><span style=display:flex><span>        demo01.<span style=color:#a6e22e>method01</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep03-双重检查锁模式>EP03. 双重检查锁模式</h2><blockquote><p>心法: 双重检查锁单例模式</p></blockquote><ul><li>双重检查锁单例模式:<ul><li>核心: 线程安全版的饱汉单例模式。</li><li>优点: 线程安全。</li><li>缺点: 需要添加锁才能保证线程安全问题，效率低。</li></ul></li><li>双重检查锁单例模式流程:<ol><li>将构造器私有化。</li><li>对外提供一个可以获取该类唯一实例的静态方法。</li><li>在对外提供的静态方法内部，进行实例化操作，实例化操作需要添加锁以保证线程安全。</li><li>在锁内添加一层null值检查以保证单例性。</li><li>在锁外添加一层null值检查以提高DCL性能。</li></ol></li></ul><blockquote><p>武技: 设计双重检查锁单例模式</p></blockquote><ol><li>开发测试类 <code>DclSingletonTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> singleton;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DclSingletonTest</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 单例类 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Demo</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/** DCL模式下的实例: 仅声明不赋值，并使用volatile保证有序性 */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>volatile</span> <span style=color:#66d9ef>static</span> Demo instance;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/** 单例模式的构造器，必须私有化 */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>Demo</span>() {
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/** 对外提供一个可以获取该类唯一实例的静态方法 */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> Demo <span style=color:#a6e22e>getInstance</span>() {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// null值检查: 以提高DCL性能</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (instance <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 添加锁: 保证线程安全</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>synchronized</span> (Demo.<span style=color:#a6e22e>class</span>) {
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// null值检查: 以保证单例性</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (instance <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>                        instance <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Demo();
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> instance;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/** 业务方法 */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>method01</span>() {
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;我是普通的业务方法&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testDclSingleton</span>() {
</span></span><span style=display:flex><span>        Demo demo01 <span style=color:#f92672>=</span> Demo.<span style=color:#a6e22e>getInstance</span>();
</span></span><span style=display:flex><span>        Demo demo02 <span style=color:#f92672>=</span> Demo.<span style=color:#a6e22e>getInstance</span>();
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(demo01 <span style=color:#f92672>==</span> demo02);
</span></span><span style=display:flex><span>        demo01.<span style=color:#a6e22e>method01</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep04-静态内部类模式>EP04. 静态内部类模式</h2><blockquote><p>心法: 静态内部类单例模式</p></blockquote><ul><li>静态内部类单例模式:<ul><li>核心: 高效率版的DCL单例模式。</li><li>优点: 静态内部类仅在被调用时才会加载，所以该模式也属于懒加载，效率高，且无线程安全问题。</li><li>缺点: 暂无。</li></ul></li><li>静态内部类单例模式流程:<ol><li>将构造器私有化。</li><li>对外提供一个可以获取该类唯一实例的静态方法。</li><li>在单例类中声明一个静态内部类。</li><li>在静态内部类中声明并赋值一个实例。</li></ol></li></ul><blockquote><p>武技: 设计静态内部类单例模式</p></blockquote><ol><li>开发测试类 <code>InnerSingletonTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> singleton;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>InnerSingletonTest</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 单例类 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Demo</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/** 在单例类中声明一个静态内部类 */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DemoHolder</span> {
</span></span><span style=display:flex><span>            <span style=color:#75715e>/** 在静态内部类中声明并赋值一个实例 */</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> Demo INSTANCE <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Demo();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/** 单例模式的构造器，必须私有化 */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>Demo</span>() {
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/** 对外提供一个可以获取该类唯一实例的静态方法 */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> Demo <span style=color:#a6e22e>getInstance</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> DemoHolder.<span style=color:#a6e22e>INSTANCE</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testInnerSingleton</span>() {
</span></span><span style=display:flex><span>        Demo demo01 <span style=color:#f92672>=</span> Demo.<span style=color:#a6e22e>getInstance</span>();
</span></span><span style=display:flex><span>        Demo demo02 <span style=color:#f92672>=</span> Demo.<span style=color:#a6e22e>getInstance</span>();
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(demo01 <span style=color:#f92672>==</span> demo02);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep05-枚举类单例模式>EP05. 枚举类单例模式</h2><blockquote><p>心法: 枚举类单例模式</p></blockquote><ul><li>枚举类单例模式:<ul><li>核心: 高效率版的DCL单例模式。</li><li>优点: 静态内部类仅在被调用时才会加载，所以该模式也属于懒加载，效率高，且无线程安全问题。</li><li>缺点: 暂无。</li></ul></li><li>枚举类单例模式流程:<ol><li>将单例类设计为枚举类，枚举类中可以编写普通的业务方法。</li><li>设计一个枚举常量作为实例，枚举类中的常量天生具有单例性。</li></ol></li></ul><blockquote><p>武技: 设计枚举内部类单例模式</p></blockquote><ol><li>开发测试类 <code>EnumSingletonTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> singleton;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>EnumSingletonTest</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 单例类: 设计为枚举类 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>enum</span> Demo {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/** 枚举类中的常量天生具有单例性 */</span>
</span></span><span style=display:flex><span>        INSTANCE;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/** 业务方法 */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>method01</span>() {
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;Enum中可以编写普通的业务方法&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testInnerSingleton</span>() {
</span></span><span style=display:flex><span>        Demo demo01 <span style=color:#f92672>=</span> Demo.<span style=color:#a6e22e>INSTANCE</span>;
</span></span><span style=display:flex><span>        Demo demo02 <span style=color:#f92672>=</span> Demo.<span style=color:#a6e22e>INSTANCE</span>;
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(demo01 <span style=color:#f92672>==</span> demo02);
</span></span><span style=display:flex><span>        demo01.<span style=color:#a6e22e>method01</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=ch02-建造者设计模式>CH02. 建造者设计模式</h1><blockquote><p>心法: 建造者模式 <code>Builder Pattern</code></p></blockquote><ul><li>建造者模式允许用户只通过复杂对象的类型和内容就可以构建它们，而不需要用户知道内部的具体细节。</li><li>建造者模式是将一个复杂对象的构建与它的表示进行分离，使得一个相同的构建过程可以创建不同的表示。</li></ul><blockquote><p>心法: 创建产品类</p></blockquote><ol><li>开发产品类 <code>Robot</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> builder.entity;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** 产品类: 机器人类 */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Data</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Robot</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 机器人组件 - 头 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String head;
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 机器人组件 - 身躯 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String body;
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 机器人组件 - 脚 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String foot;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep01-有序建造者模式>EP01. 有序建造者模式</h2><blockquote><p>心法: 有序建造者模式的角色</p></blockquote><ul><li>抽象建造者 <code>Base Builder</code>: 仅用于定义公共抽象的构建方法，并不涉及具体的实例部件的创建细节。</li><li>具体建造者 <code>Concrete Builder</code>: 需要继承抽象建造者类并重写建造相关的抽象方法，用于实现建造的细节。</li><li>指挥者 <code>Director</code>: 用于调用具体建造者来创建产品，它会决定建造顺序。</li></ul><blockquote><p>武技: 测试有序建造者模式</p></blockquote><ol><li>开发抽象建造者类 <code>BaseRobotBuilder</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> builder.order;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** 建造者类: 仅用于定义公共抽象的构建方法，并不涉及具体的实例部件的创建细节 */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BaseRobotBuilder</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 使用protected将实例共享给全部子类 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> Robot robot <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Robot();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 构建机器人的头 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>buildHead</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 构建机器人的身体 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>buildBody</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 构建机器人的脚 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>buildFoot</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 返回已构建好的机器人 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Robot <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> robot;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>开发具体建造者类 <code>GoldRobotBuilder</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> builder.order;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** 具体建造者类 - 黄金机器人建造者: 负责实现构建细节 */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>GoldRobotBuilder</span> <span style=color:#66d9ef>extends</span> BaseRobotBuilder {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>buildHead</span>() {
</span></span><span style=display:flex><span>        robot.<span style=color:#a6e22e>setHead</span>(<span style=color:#e6db74>&#34;黄金头&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>buildBody</span>() {
</span></span><span style=display:flex><span>        robot.<span style=color:#a6e22e>setBody</span>(<span style=color:#e6db74>&#34;黄金躯&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>buildFoot</span>() {
</span></span><span style=display:flex><span>        robot.<span style=color:#a6e22e>setFoot</span>(<span style=color:#e6db74>&#34;黄金脚&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>开发具体建造者类 <code>SilverRobotBuilder</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> builder.order;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** 具体建造者类 - 白银机器人建造者: 负责实现构建细节 */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SilverRobotBuilder</span> <span style=color:#66d9ef>extends</span> BaseRobotBuilder {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>buildHead</span>() {
</span></span><span style=display:flex><span>        robot.<span style=color:#a6e22e>setHead</span>(<span style=color:#e6db74>&#34;白银头&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>buildBody</span>() {
</span></span><span style=display:flex><span>        robot.<span style=color:#a6e22e>setBody</span>(<span style=color:#e6db74>&#34;白银躯&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>buildFoot</span>() {
</span></span><span style=display:flex><span>        robot.<span style=color:#a6e22e>setFoot</span>(<span style=color:#e6db74>&#34;白银脚&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=4><li>开发指挥者类 <code>RobotDirector</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> builder.order;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** 指挥者: 用于调用具体建造者来创建产品 */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RobotDirector</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 指挥建造一个黄金机器人 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Robot <span style=color:#a6e22e>buildGoldRobot</span>() {
</span></span><span style=display:flex><span>        GoldRobotBuilder goldRobotBuilder <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> GoldRobotBuilder();
</span></span><span style=display:flex><span>        goldRobotBuilder.<span style=color:#a6e22e>buildHead</span>();
</span></span><span style=display:flex><span>        goldRobotBuilder.<span style=color:#a6e22e>buildBody</span>();
</span></span><span style=display:flex><span>        goldRobotBuilder.<span style=color:#a6e22e>buildFoot</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> goldRobotBuilder.<span style=color:#a6e22e>build</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 指挥建造一个白银机器人 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Robot <span style=color:#a6e22e>buildSilverRobot</span>() {
</span></span><span style=display:flex><span>        SilverRobotBuilder silverRobotBuilder <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SilverRobotBuilder();
</span></span><span style=display:flex><span>        silverRobotBuilder.<span style=color:#a6e22e>buildHead</span>();
</span></span><span style=display:flex><span>        silverRobotBuilder.<span style=color:#a6e22e>buildBody</span>();
</span></span><span style=display:flex><span>        silverRobotBuilder.<span style=color:#a6e22e>buildFoot</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> silverRobotBuilder.<span style=color:#a6e22e>build</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=5><li>开发测试类 <code>OrderBuilderTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> builder;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>OrderBuilderTest</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testBuilder</span>() {
</span></span><span style=display:flex><span>        RobotDirector robotDirector <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> RobotDirector();
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(robotDirector.<span style=color:#a6e22e>buildGoldRobot</span>());
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(robotDirector.<span style=color:#a6e22e>buildSilverRobot</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep02-无序建造者模式>EP02. 无序建造者模式</h2><blockquote><p>心法: 无序建造者模式</p></blockquote><ul><li>无序建造者模式没有指挥者角色，建造顺序由调用方指定，使用更加灵活。</li></ul><blockquote><p>武技: 测试无序建造者模式</p></blockquote><ol><li>开发抽象建造者类 <code>BaseRobotBuilder</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> builder.unorder;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** 建造者类: 仅定义公共抽象方法 */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BaseRobotBuilder</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 使用protected将实例共享给全部子类 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> Robot robot <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Robot();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> BaseRobotBuilder <span style=color:#a6e22e>buildHead</span>(String head);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> BaseRobotBuilder <span style=color:#a6e22e>buildBody</span>(String body);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> BaseRobotBuilder <span style=color:#a6e22e>buildFoot</span>(String foot);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Robot <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> robot;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>开发具体建造者类 <code>RobotBuilder</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> builder.unorder;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** 具体建造者类: 负责实现构建细节 */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RobotBuilder</span> <span style=color:#66d9ef>extends</span> BaseRobotBuilder {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> BaseRobotBuilder <span style=color:#a6e22e>buildHead</span>(String head) {
</span></span><span style=display:flex><span>        robot.<span style=color:#a6e22e>setHead</span>(head);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> BaseRobotBuilder <span style=color:#a6e22e>buildBody</span>(String body) {
</span></span><span style=display:flex><span>        robot.<span style=color:#a6e22e>setBody</span>(body);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> BaseRobotBuilder <span style=color:#a6e22e>buildFoot</span>(String foot) {
</span></span><span style=display:flex><span>        robot.<span style=color:#a6e22e>setFoot</span>(foot);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>开发测试类 <code>UnOrderBuilderTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> builder;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>UnOrderBuilderTest</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testBuilder</span>() {
</span></span><span style=display:flex><span>        Robot goldRobot <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> RobotBuilder()
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>buildBody</span>(<span style=color:#e6db74>&#34;黄金头&#34;</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>buildFoot</span>(<span style=color:#e6db74>&#34;黄金脚&#34;</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>buildHead</span>(<span style=color:#e6db74>&#34;黄金驱&#34;</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>build</span>();
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(goldRobot);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Robot silverRobot <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> RobotBuilder()
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>buildFoot</span>(<span style=color:#e6db74>&#34;白银脚&#34;</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>buildBody</span>(<span style=color:#e6db74>&#34;白银头&#34;</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>buildHead</span>(<span style=color:#e6db74>&#34;白银驱&#34;</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>build</span>();
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(silverRobot);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=ch03-工厂设计模式>CH03. 工厂设计模式</h1><blockquote><p>Open-Closed Principle: OCP开闭原则表示一个软件的实体应当对添加拓展开放，对修改重构关闭。</p></blockquote><blockquote><p>武技: 开发测试类 <code>factory.CarTest</code> 测试传统模式下，接口方法的调用:</p></blockquote><ul><li>开发汽车接口类 <code>Car</code>: 开发汽车接口方法 <code>drive()</code>。</li><li>开发奔驰实现类 <code>Benz</code>: 实现汽车接口的 <code>drive()</code>。</li><li>开发测试方法 <code>CarTest</code>:<ul><li>创建一辆奔驰实例并调用 <code>drive()</code>: 没有达到生产者和使用者的分离。</li></ul></li></ul><h2 id=ep01-静态工厂模式>EP01. 静态工厂模式</h2><blockquote><p>心法: 静态工厂模式</p></blockquote><ul><li>静态工厂用于分离生产者和使用者，但不满足OCP开闭原则，比如当添加奥迪实现类时，需要修改重构工厂类代码。</li></ul><blockquote><p>武技: 开发测试类 <code>factory.StaticFactoryTest</code> 测试静态工厂模式下，接口方法的调用:</p></blockquote><ul><li>开发汽车接口类 <code>Car</code>: 开发汽车接口方法 <code>drive()</code>。</li><li>开发奔驰实现类 <code>Benz</code>: 实现汽车接口的 <code>drive()</code>。</li><li>开发静态工厂类 <code>CarFactory</code>: 开发静态方法 <code>buildBenz()</code> 用于创建并返回一个奔驰实例。</li><li>开发测试方法 <code>CarFactoryTest</code>:<ul><li>从工厂类中获取一辆奔驰实例并调用 <code>drive()</code>: 生产者使用者分离，但不满足OCP原则。</li></ul></li></ul><h2 id=ep02-工厂方法模式>EP02. 工厂方法模式</h2><blockquote><p>心法: 工厂方法模式</p></blockquote><ul><li>工厂方法将工厂类设计成了接口以满足OCP原则，但仍需使用者去new对应的工厂实现类，理论上优于静态工厂，但实际开发中还是静态工厂用的比较多。</li></ul><blockquote><p>武技: 开发测试类 <code>factory.FactoryMethodTest</code> 测试静态工厂模式下，接口方法的调用:</p></blockquote><ul><li>开发汽车接口类 <code>Car</code>: 开发汽车接口方法 <code>drive()</code>。</li><li>开发奔驰实现类 <code>Benz</code>: 实现汽车接口的 <code>drive()</code>。</li><li>开发车厂接口 <code>CarFactory</code>: 开发车厂接口方法 <code>build()</code>。</li><li>开发奔驰车厂实现类 <code>BenzFactory</code>: 实现车厂接口的 <code>build()</code></li><li>开发测试方法 <code>CarFactoryTest</code>:<ul><li>从奔驰车厂中 <code>.build()</code> 一辆奔驰实例并调用 <code>drive()</code>: 满足OCP原则，但仍需要使用者new工厂。</li></ul></li></ul><h2 id=ep03-抽象工厂模式>EP03. 抽象工厂模式</h2><blockquote><p>心法: 抽象工厂模式</p></blockquote><ul><li>抽象工厂在大型项目中常见，用于针对一条产品线（发动机 + 轮胎）进行整体操作，满足OCP原则，添加新产品线时，无需修改其他产品线代码。</li></ul><blockquote><p>武技: 代码均在 <code>factory.abstractfactory</code> 包内:</p></blockquote><ul><li>开发轮胎接口方法 <code>Tires.info()</code>:<ul><li>好轮胎实现类: <code>GoodTires</code>，重写 <code>info()</code>。</li><li>坏轮胎实现类: <code>BadTires</code>，重写 <code>info()</code>。</li></ul></li><li>开发发动机接口方法 <code>Engine.info()</code>:<ul><li>好发动机实现类: <code>GoodEngine</code>，重写 <code>info()</code>。</li><li>坏发动机实现类: <code>BadEngine</code>，重写 <code>info()</code>。</li></ul></li><li>开发车厂接口方法 <code>CarFactory.getEngine()/getTires()</code>:<ul><li>好车厂实现类: <code>GoodCarFactory</code>，返回好轮胎和好发动机。</li><li>坏车厂实现类: <code>BadCarFactory</code>，返回坏轮胎和坏发动机。</li></ul></li><li>tst: <code>CarFactoryTest</code>:<ul><li>创造一个好车厂或者坏车厂，就可以决定创造出来的零件都是好的或都是坏的。</li></ul></li></ul><h1 id=ch04-原型设计模式>CH04. 原型设计模式</h1><blockquote><p>心法: 原型模式 <code>Prototype Pattern</code></p></blockquote><ul><li>原型模式就是Java中的克隆技术，以某个实例为原型克隆出一个新实例:<ul><li>新实例具有和原实例相同的属性值。</li><li>克隆操作不需要执行新实例的构造器，也不需要为属性重新赋值，效率更高。</li></ul></li></ul><blockquote><p>武技: 开发用于测试原型模式的原型类</p></blockquote><ol><li>开发原型类 <code>Sheep</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> prototype.entity;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Data</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Sheep</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String name;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Date birth;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep01-浅克隆原型模式>EP01. 浅克隆原型模式</h2><blockquote><p>心法: 浅克隆原型模式</p></blockquote><ul><li>浅克隆核心: 引用类型属性克隆的是原型的内存地址:<ul><li>此时若内存地址指向的值发生改变，则所有克隆类的该属性值均随之改变。</li><li>就像你和你的影子，你变胖了，你的影子也会变胖。</li></ul></li><li>浅克隆方式:<ul><li>底层直接调用Object类中的 <code>clone()</code> 方法即可，所以要求原型类必须实现 <code>Cloneable</code> 接口。</li></ul></li></ul><blockquote><p>武技: 测试浅克隆原型模式</p></blockquote><ol><li>在 <code>Sheep</code> 类中添加浅克隆方法 <code>shallowClone()</code>:<ul><li>需要实现 <code>Cloneable</code> 接口。</li></ul></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Sheep</span> <span style=color:#66d9ef>implements</span> Cloneable {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ..</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@SneakyThrows</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Sheep <span style=color:#a6e22e>shallowClone</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 浅克隆底层直接调用Object类中的clone()方法即可</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> (Sheep) <span style=color:#66d9ef>super</span>.<span style=color:#a6e22e>clone</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>开发测试类 <code>ShallowCloneTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> prototype;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ShallowCloneTest</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testShallowClone</span>() {
</span></span><span style=display:flex><span>        Date now <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Date();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 原型羊dorset</span>
</span></span><span style=display:flex><span>        Sheep dorset <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Sheep();
</span></span><span style=display:flex><span>        dorset.<span style=color:#a6e22e>setName</span>(<span style=color:#e6db74>&#34;dorset&#34;</span>);
</span></span><span style=display:flex><span>        dorset.<span style=color:#a6e22e>setBirth</span>(now);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 通过原型羊dorset进行浅克隆</span>
</span></span><span style=display:flex><span>        Sheep dolly <span style=color:#f92672>=</span> dorset.<span style=color:#a6e22e>shallowClone</span>();
</span></span><span style=display:flex><span>        dolly.<span style=color:#a6e22e>setName</span>(<span style=color:#e6db74>&#34;dolly&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 将now的值进行修改，查看是否会影响到两只羊的birth属性</span>
</span></span><span style=display:flex><span>        now.<span style=color:#a6e22e>setTime</span>(999999999999L);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;修改后的日期值：&#34;</span> <span style=color:#f92672>+</span> now);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;dorset的生日：&#34;</span> <span style=color:#f92672>+</span> dorset.<span style=color:#a6e22e>getBirth</span>());
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;dolly的生日：&#34;</span> <span style=color:#f92672>+</span> dolly.<span style=color:#a6e22e>getBirth</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep02-深克隆原型模式>EP02. 深克隆原型模式</h2><blockquote><p>心法: 深克隆原型模式</p></blockquote><ul><li>深克隆核心: 引用类型属性也会将值克隆一份并分配新的内存地址:<ul><li>此时就算内存地址指向的值发生改变，也不影响任何克隆类。</li><li>就像你和你的克隆人，你变胖了，但你的克隆人不变:</li></ul></li><li>深克隆方式:<ul><li>深克隆不调用Object类中的 <code>clone()</code>，所以无需实现 <code>Cloneable</code> 接口。</li><li>深克隆就是对实例的序列化和反序列化操作，所以必须让原型类实现 <code>Serializable</code> 接口。</li><li>一次深克隆相当于将原型类中的引用类型属性浅克隆两次，所以当引用类型属性较多时不适用。</li></ul></li></ul><blockquote><p>武技: 测试原型模式 - 深克隆</p></blockquote><ol><li>在 <code>Sheep</code> 类中添加深克隆方法 <code>deepClone()</code>:<ul><li>需要实现 <code>Serializable</code> 接口。</li></ul></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Sheep</span> <span style=color:#66d9ef>implements</span> Serializable {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ..</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@SneakyThrows</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Sheep <span style=color:#a6e22e>deepClone</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建字节数组输出流</span>
</span></span><span style=display:flex><span>        ByteArrayOutputStream baos <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ByteArrayOutputStream();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建对象输出流</span>
</span></span><span style=display:flex><span>        ObjectOutputStream oos <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ObjectOutputStream(baos);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 将当前sheep通过对象输出流写入内存字节数组</span>
</span></span><span style=display:flex><span>        oos.<span style=color:#a6e22e>writeObject</span>(<span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>        oos.<span style=color:#a6e22e>flush</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建字节输出输入流</span>
</span></span><span style=display:flex><span>        ByteArrayInputStream bais <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ByteArrayInputStream(baos.<span style=color:#a6e22e>toByteArray</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建对象输入流</span>
</span></span><span style=display:flex><span>        ObjectInputStream ois <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ObjectInputStream(bais);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 通过对象输入流将sheep从内存字节数组读取出来</span>
</span></span><span style=display:flex><span>        Sheep result <span style=color:#f92672>=</span> (Sheep) ois.<span style=color:#a6e22e>readObject</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 释放资源</span>
</span></span><span style=display:flex><span>        oos.<span style=color:#a6e22e>close</span>();
</span></span><span style=display:flex><span>        ois.<span style=color:#a6e22e>close</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> result;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>开发测试类 <code>DeepCloneTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> prototype;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DeepCloneTest</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testDeepClone</span>() {
</span></span><span style=display:flex><span>        Date now <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Date();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 原型羊dorset</span>
</span></span><span style=display:flex><span>        Sheep dorset <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Sheep();
</span></span><span style=display:flex><span>        dorset.<span style=color:#a6e22e>setName</span>(<span style=color:#e6db74>&#34;dorset&#34;</span>);
</span></span><span style=display:flex><span>        dorset.<span style=color:#a6e22e>setBirth</span>(now);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 通过原型羊dorset进行浅克隆</span>
</span></span><span style=display:flex><span>        Sheep dolly <span style=color:#f92672>=</span> dorset.<span style=color:#a6e22e>deepClone</span>();
</span></span><span style=display:flex><span>        dolly.<span style=color:#a6e22e>setName</span>(<span style=color:#e6db74>&#34;dolly&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 将now的值进行修改，查看是否会影响到两只羊的birth属性</span>
</span></span><span style=display:flex><span>        now.<span style=color:#a6e22e>setTime</span>(999999999999L);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;修改后的日期值：&#34;</span> <span style=color:#f92672>+</span> now);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;dorset的生日：&#34;</span> <span style=color:#f92672>+</span> dorset.<span style=color:#a6e22e>getBirth</span>());
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;dolly的生日：&#34;</span> <span style=color:#f92672>+</span> dolly.<span style=color:#a6e22e>getBirth</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=ch05-结构型设计模式>CH05. 结构型设计模式</h1><h2 id=ep01-适配器设计模式>EP01. 适配器设计模式</h2><blockquote><p>心法: 适配器模式 <code>Adaptor Pattern</code>，也叫包装器模式</p></blockquote><ul><li>适配器模式的核心:<ul><li>将一个接口转换为客户端所期待的接口，从而使两个接口不兼容的类可以在一起工作。</li></ul></li><li>适配器模式的场景:<ul><li>当内存卡和笔记本接口不兼容时，使用读卡器就是一种适配器模式的解决方案。</li><li>驱动技术大多使用的也是适配器模式，比如JDBC技术，其底层使用的就是适配器模式。</li></ul></li><li>适配器模式的优点:<ul><li>增强程序的可扩展性，此模式下，用户可以随意扩展程序的功能，却不需要修改原来的接口。</li></ul></li><li>适配器模式的缺点:<ul><li>当系统中大量使用适配器模式时，可能会造成结构混乱，此时更建议直接对系统进行重构。</li></ul></li></ul><blockquote><p>武技: 测试适配器模式</p></blockquote><ol><li>开发原接口类 <code>UserService</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> adapter;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** 原接口: 接口方法内容设计不够优化 */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>UserService</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>c</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>r</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>u</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>d</span>();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>开发新接口类 <code>UserServicePro</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> adapter;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** 新接口: 与原接口不兼容 */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>UserServicePro</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>insert</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>select</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>update</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>delete</span>();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>开发新接口的实现类 <code>UserServiceImpl</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> adapter;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** 新接口实现类 */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>UserServiceImpl</span> <span style=color:#66d9ef>implements</span> UserServicePro {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>insert</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;升级版的添加方法&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>select</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;升级版的查询方法&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>update</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;升级版的修改方法&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>delete</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;升级版的删除方法&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=4><li>开发适配器类 <code>Adapter</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> adapter;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** 适配器类: 用于将新接口兼容到原接口*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Adapter</span> <span style=color:#66d9ef>implements</span> UserService {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> UserServicePro userServicePro;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Adapter</span>(UserServicePro userServicePro) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>userServicePro</span> <span style=color:#f92672>=</span> userServicePro;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>c</span>() {
</span></span><span style=display:flex><span>        userServicePro.<span style=color:#a6e22e>insert</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>r</span>() {
</span></span><span style=display:flex><span>        userServicePro.<span style=color:#a6e22e>select</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>u</span>() {
</span></span><span style=display:flex><span>        userServicePro.<span style=color:#a6e22e>update</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>d</span>() {
</span></span><span style=display:flex><span>        userServicePro.<span style=color:#a6e22e>delete</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=5><li>开发测试类 <code>AdapterTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> adapter;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AdapterTest</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testAdapter</span>() {
</span></span><span style=display:flex><span>        UserService userService <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Adapter(<span style=color:#66d9ef>new</span> UserServiceImpl());
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 调用的还是原来的方法，不过底层使用的已经是新版本的具体实现了</span>
</span></span><span style=display:flex><span>        userService.<span style=color:#a6e22e>c</span>();
</span></span><span style=display:flex><span>        userService.<span style=color:#a6e22e>r</span>();
</span></span><span style=display:flex><span>        userService.<span style=color:#a6e22e>u</span>();
</span></span><span style=display:flex><span>        userService.<span style=color:#a6e22e>d</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep02-桥接设计模式>EP02. 桥接设计模式</h2><blockquote><p>心法: 桥接模式 <code>Bridge Pattern</code>，也叫柄体模式，也叫接口模式</p></blockquote><ul><li>桥接模式核心: 用于将抽象部分与它的实现部分进行解耦，使它们都可以独立地变化。</li><li>桥接模式场景: 假设开发了一个手机抽象类，包含华为和小米2种品牌和高中低3种配置:<ul><li>则需要设计低配小米，中配小米，高配小米，低配华为等共 <code>M * N</code> 种不同的实现类。</li><li>使用桥接模式，可以将手机配置剥离出去成为独立的接口，然后在手机品牌的实现类中进行引入。</li><li>此时只需设计2种手机品牌的实现类和3种手机配置的实现类，共计 <code>M + N</code> 个实现类即可。</li><li>此模式下，相当于将品牌的选择和配置的组合方式，交给调用方来选择。</li></ul></li></ul><blockquote><p>武技: 测试桥接模式</p></blockquote><ol><li>开发手机配置的接口 <code>PhoneConfig</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> bridge;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** 手机配置接口 */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>PhoneConfig</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 手机颜色 */</span>
</span></span><span style=display:flex><span>    String <span style=color:#a6e22e>getColor</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 手机运存 */</span>
</span></span><span style=display:flex><span>    Integer <span style=color:#a6e22e>getRam</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 手机存储 */</span>
</span></span><span style=display:flex><span>    Integer <span style=color:#a6e22e>getRom</span>();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>开发手机低配置实现类 <code>LowPhoneConfig</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> bridge;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>LowPhoneConfig</span> <span style=color:#66d9ef>implements</span> PhoneConfig {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getColor</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;低配白&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Integer <span style=color:#a6e22e>getRam</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> 8;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Integer <span style=color:#a6e22e>getRom</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> 64;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>开发手机中配置实现类 <code>MiddlePhoneConfig</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> bridge;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MiddlePhoneConfig</span> <span style=color:#66d9ef>implements</span> PhoneConfig {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getColor</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;中配黑&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Integer <span style=color:#a6e22e>getRam</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> 16;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Integer <span style=color:#a6e22e>getRom</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> 128;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=4><li>开发手机高配置实现类 <code>HighPhoneConfig</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> bridge;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HighPhoneConfig</span> <span style=color:#66d9ef>implements</span> PhoneConfig {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getColor</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;高配红&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Integer <span style=color:#a6e22e>getRam</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> 32;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Integer <span style=color:#a6e22e>getRom</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> 256;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=5><li>开发手机抽象类 <code>Phone</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> bridge;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** 手机抽象类 */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Phone</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 手机的各种配置被剥离出去，并在此进行引入 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> PhoneConfig phoneConfig;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 抽象类的构造器只能由子类来调用 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Phone</span>(PhoneConfig phoneConfig) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>phoneConfig</span> <span style=color:#f92672>=</span> phoneConfig;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 获取手机的完整信息: 具体实现由子类来决定 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> String <span style=color:#a6e22e>getInfo</span>();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=6><li>开发华为手机类 <code>HuaWeiPhone</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> bridge;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HuaWeiPhone</span> <span style=color:#66d9ef>extends</span> Phone {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>HuaWeiPhone</span>(PhoneConfig phoneConfig) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 将手机的配置传递给父类构造器</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>super</span>(phoneConfig);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getInfo</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> String.<span style=color:#a6e22e>format</span>(<span style=color:#e6db74>&#34;华为手机信息: [%s，运存%dG，存储%dG]&#34;</span>,
</span></span><span style=display:flex><span>                phoneConfig.<span style=color:#a6e22e>getColor</span>(),
</span></span><span style=display:flex><span>                phoneConfig.<span style=color:#a6e22e>getRam</span>(),
</span></span><span style=display:flex><span>                phoneConfig.<span style=color:#a6e22e>getRom</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=7><li>开发华为手机类 <code>XiaoMiPhone</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> bridge;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>XiaoMiPhone</span> <span style=color:#66d9ef>extends</span> Phone {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>XiaoMiPhone</span>(PhoneConfig phoneConfig) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 将手机的配置传递给父类构造器</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>super</span>(phoneConfig);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getInfo</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> String.<span style=color:#a6e22e>format</span>(<span style=color:#e6db74>&#34;小米手机信息: [%s，运存%dG，存储%dG]&#34;</span>,
</span></span><span style=display:flex><span>                phoneConfig.<span style=color:#a6e22e>getColor</span>(),
</span></span><span style=display:flex><span>                phoneConfig.<span style=color:#a6e22e>getRam</span>(),
</span></span><span style=display:flex><span>                phoneConfig.<span style=color:#a6e22e>getRom</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=8><li>开发测试类 <code>BridgeTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> bridge;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BridgeTest</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testBridge</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建华为手机实例，自定义配置</span>
</span></span><span style=display:flex><span>        HuaWeiPhone lowHuaWeiPhone <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HuaWeiPhone(<span style=color:#66d9ef>new</span> LowPhoneConfig());
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;低配-&#34;</span> <span style=color:#f92672>+</span> lowHuaWeiPhone.<span style=color:#a6e22e>getInfo</span>());
</span></span><span style=display:flex><span>        HuaWeiPhone middleHuaWeiPhone <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HuaWeiPhone(<span style=color:#66d9ef>new</span> MiddlePhoneConfig());
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;中配-&#34;</span> <span style=color:#f92672>+</span> middleHuaWeiPhone.<span style=color:#a6e22e>getInfo</span>());
</span></span><span style=display:flex><span>        HuaWeiPhone highHuaWeiPhone <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HuaWeiPhone(<span style=color:#66d9ef>new</span> HighPhoneConfig());
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;高配-&#34;</span> <span style=color:#f92672>+</span> highHuaWeiPhone.<span style=color:#a6e22e>getInfo</span>());
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建小米手机实例，自定义配置</span>
</span></span><span style=display:flex><span>        XiaoMiPhone lowXiaoMiPhone <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> XiaoMiPhone(<span style=color:#66d9ef>new</span> LowPhoneConfig());
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;低配-&#34;</span> <span style=color:#f92672>+</span> lowXiaoMiPhone.<span style=color:#a6e22e>getInfo</span>());
</span></span><span style=display:flex><span>        XiaoMiPhone middleXiaoMiPhone <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> XiaoMiPhone(<span style=color:#66d9ef>new</span> MiddlePhoneConfig());
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;中配-&#34;</span> <span style=color:#f92672>+</span> middleXiaoMiPhone.<span style=color:#a6e22e>getInfo</span>());
</span></span><span style=display:flex><span>        XiaoMiPhone highXiaoMiPhone <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> XiaoMiPhone(<span style=color:#66d9ef>new</span> HighPhoneConfig());
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;高配-&#34;</span> <span style=color:#f92672>+</span> highXiaoMiPhone.<span style=color:#a6e22e>getInfo</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep03-过滤器设计模式>EP03. 过滤器设计模式</h2><blockquote><p>心法: 过滤器模式 <code>Filter Pattern</code>，也叫标准模式</p></blockquote><ul><li>允许用户使用不同标准来过滤一组对象，比如MyBatisGenerator工具的SQL拼装，就是使用的该模式。</li></ul><blockquote><p>武技: 测试过滤器设计模式</p></blockquote><ol><li>开发过滤实体类 <code>Student</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> filter.entity;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Data</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@AllArgsConstructor</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@NoArgsConstructor</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Student</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String name;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Integer age;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Integer gender;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>开发过滤接口 <code>Criteria</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> filter;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>Criteria</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * 过滤方法
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param students 被过滤的集合
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @return 过滤后，满足条件的集合
</span></span></span><span style=display:flex><span><span style=color:#75715e>     */</span>
</span></span><span style=display:flex><span>    Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>filter</span>(Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> students);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>开发过滤接口实现类 <code>CriteriaAge</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> filter;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CriteriaAge</span> <span style=color:#66d9ef>implements</span> Criteria {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Integer age;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>CriteriaAge</span>(Integer age) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>age</span> <span style=color:#f92672>=</span> age;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>filter</span>(Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> students) {
</span></span><span style=display:flex><span>        Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> result <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashSet<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 将所有符合指定年龄条件的集合项添加到result集合</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (Student student : students) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (Objects.<span style=color:#a6e22e>equals</span>(student.<span style=color:#a6e22e>getAge</span>(), <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>age</span>)) {
</span></span><span style=display:flex><span>                result.<span style=color:#a6e22e>add</span>(student);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> result;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=4><li>开发过滤接口实现类 <code>CriteriaGender</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> filter;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CriteriaGender</span> <span style=color:#66d9ef>implements</span> Criteria {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Integer gender;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>CriteriaGender</span>(Integer gender) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gender</span> <span style=color:#f92672>=</span> gender;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>filter</span>(Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> students) {
</span></span><span style=display:flex><span>        Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> result <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashSet<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 将所有符合指定性别条件的集合项添加到result集合</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (Student student : students) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (Objects.<span style=color:#a6e22e>equals</span>(student.<span style=color:#a6e22e>getGender</span>(), <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gender</span>)) {
</span></span><span style=display:flex><span>                result.<span style=color:#a6e22e>add</span>(student);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> result;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=5><li>开发过滤接口实现类 <code>CriteriaOr</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> filter;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CriteriaOr</span> <span style=color:#66d9ef>implements</span> Criteria {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Criteria criteriaOne;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Criteria criteriaTwo;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>CriteriaOr</span>(Criteria criteriaOne, Criteria criteriaTwo) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>criteriaOne</span> <span style=color:#f92672>=</span> criteriaOne;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>criteriaTwo</span> <span style=color:#f92672>=</span> criteriaTwo;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>filter</span>(Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> students) {
</span></span><span style=display:flex><span>        Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> result <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashSet<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 过滤出满足条件1的集合结果1，Set自动去重</span>
</span></span><span style=display:flex><span>        Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> resultOne <span style=color:#f92672>=</span> criteriaOne.<span style=color:#a6e22e>filter</span>(students);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 过滤出满足条件2的集合结果2，Set自动去重</span>
</span></span><span style=display:flex><span>        Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> resultTwo <span style=color:#f92672>=</span> criteriaTwo.<span style=color:#a6e22e>filter</span>(students);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 求并集: 将结果1和结果2都添加到result集合即可，Set自动去重</span>
</span></span><span style=display:flex><span>        result.<span style=color:#a6e22e>addAll</span>(resultOne);
</span></span><span style=display:flex><span>        result.<span style=color:#a6e22e>addAll</span>(resultTwo);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> result;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=6><li>开发过滤器接口实现类 <code>CriteriaAnd</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> filter;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CriteriaAnd</span> <span style=color:#66d9ef>implements</span> Criteria {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Criteria criteriaOne;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Criteria criteriaTwo;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>CriteriaAnd</span>(Criteria criteriaOne, Criteria criteriaTwo) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>criteriaOne</span> <span style=color:#f92672>=</span> criteriaOne;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>criteriaTwo</span> <span style=color:#f92672>=</span> criteriaTwo;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>filter</span>(Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> students) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 过滤出满足条件1的集合结果1，Set自动去重</span>
</span></span><span style=display:flex><span>        Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> resultOne <span style=color:#f92672>=</span> criteriaOne.<span style=color:#a6e22e>filter</span>(students);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 过滤出满足条件2的集合结果2，Set自动去重</span>
</span></span><span style=display:flex><span>        Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> resultTwo <span style=color:#f92672>=</span> criteriaTwo.<span style=color:#a6e22e>filter</span>(students);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 将满足条件1的集合结果1添加到result集合</span>
</span></span><span style=display:flex><span>        Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> result <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashSet<span style=color:#f92672>&lt;&gt;</span>(resultOne);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 求交集: 将同时存在于result集合和resultTwo集合中的元素保留在result集合中</span>
</span></span><span style=display:flex><span>        result.<span style=color:#a6e22e>retainAll</span>(resultTwo);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> result;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=7><li>开发测试类 <code>FilterTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> filter;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FilterTest</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testFilter</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 准备学生集合数据</span>
</span></span><span style=display:flex><span>        Set<span style=color:#f92672>&lt;</span>Student<span style=color:#f92672>&gt;</span> students <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashSet<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>        students.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> Student(<span style=color:#e6db74>&#34;赵四&#34;</span>, 58, 1));
</span></span><span style=display:flex><span>        students.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> Student(<span style=color:#e6db74>&#34;刘能&#34;</span>, 59, 1));
</span></span><span style=display:flex><span>        students.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> Student(<span style=color:#e6db74>&#34;王云&#34;</span>, 58, 0));
</span></span><span style=display:flex><span>        students.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> Student(<span style=color:#e6db74>&#34;刘英&#34;</span>, 59, 0));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 使用过滤模式过滤学生</span>
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;全部女学生: &#34;</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>new</span> CriteriaGender(0).<span style=color:#a6e22e>filter</span>(students));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;全部男学生: &#34;</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>new</span> CriteriaGender(1).<span style=color:#a6e22e>filter</span>(students));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;全部58岁的学生: &#34;</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>new</span> CriteriaAge(58).<span style=color:#a6e22e>filter</span>(students));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;全部59岁的学生: &#34;</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>new</span> CriteriaAge(59).<span style=color:#a6e22e>filter</span>(students));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;全部女学生或58岁的学生: &#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>+</span> <span style=color:#66d9ef>new</span> CriteriaOr(<span style=color:#66d9ef>new</span> CriteriaGender(0), <span style=color:#66d9ef>new</span> CriteriaAge(58)).<span style=color:#a6e22e>filter</span>(students));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;全部女学生且58岁的学生: &#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>+</span> <span style=color:#66d9ef>new</span> CriteriaAnd(<span style=color:#66d9ef>new</span> CriteriaGender(0), <span style=color:#66d9ef>new</span> CriteriaAge(58)).<span style=color:#a6e22e>filter</span>(students));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep04-装饰器设计模式>EP04. 装饰器设计模式</h2><blockquote><p>心法: 装饰器模式 <code>Decorator Pattern</code></p></blockquote><ul><li>装饰器模式用于在不改变现有对象结构的情况下，动态地给该对象拓展一些额外功能。</li><li>装饰器模式遵守开闭原则，对添加开放，对修改关闭。</li><li>使用子类继承同样可以达到同样的拓展效果，但设计模式不推荐使用继承。</li></ul><blockquote><p>武技: 测试装饰器模式</p></blockquote><ol><li>开发英雄实体类 <code>Hero</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> decorator.entity;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Data</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@AllArgsConstructor</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@NoArgsConstructor</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Hero</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 英雄名称 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String heroName;
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 攻击力 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Integer ATT;
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 防御力 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Integer DEF;
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 血量 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Integer HP;
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 蓝量 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Integer MP;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 获取英雄信息 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getMessage</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> String.<span style=color:#a6e22e>format</span>(<span style=color:#e6db74>&#34;我是英雄%s: 攻击%d，防御%d，血量%d，蓝量%d&#34;</span>,
</span></span><span style=display:flex><span>                heroName, ATT, DEF, HP, MP);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>开发装饰器接口 <code>SkinDecorator</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> decorator;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SkinDecorator</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 获取英雄信息 */</span>
</span></span><span style=display:flex><span>    String <span style=color:#a6e22e>getMessage</span>();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>开发装饰器实现类 <code>AlphaTeamSkinDecorator</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> decorator;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AlphaTeamSkinDecorator</span> <span style=color:#66d9ef>implements</span> SkinDecorator {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Hero hero;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>AlphaTeamSkinDecorator</span>(Hero hero) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>hero</span> <span style=color:#f92672>=</span> hero;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getMessage</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 原功能直接调用，并拓展新的功能</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> hero.<span style=color:#a6e22e>getMessage</span>() <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;，使用 [阿尔法小队] 皮肤&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=4><li>开发装饰器实现类 <code>ElfKingSkinDecorator</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> decorator;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ElfKingSkinDecorator</span> <span style=color:#66d9ef>implements</span> SkinDecorator {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Hero hero;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>ElfKingSkinDecorator</span>(Hero hero) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>hero</span> <span style=color:#f92672>=</span> hero;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getMessage</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 原功能直接调用，并拓展新的功能</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> hero.<span style=color:#a6e22e>getMessage</span>() <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;，使用 [精灵王] 皮肤&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=5><li>开发测试类 <code>DecoratorTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> decorator;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DecoratorTest</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testDecorator</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建后羿实体</span>
</span></span><span style=display:flex><span>        Hero hero <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Hero(<span style=color:#e6db74>&#34;后羿&#34;</span>, 1, 2, 3, 4);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建后羿精灵王皮肤装饰器</span>
</span></span><span style=display:flex><span>        SkinDecorator skinDecorator <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ElfKingSkinDecorator(hero);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 获取英雄信息</span>
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;不通过装饰器: &#34;</span> <span style=color:#f92672>+</span> hero.<span style=color:#a6e22e>getMessage</span>());
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;通过装饰器: &#34;</span> <span style=color:#f92672>+</span> skinDecorator.<span style=color:#a6e22e>getMessage</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep05-组合设计模式>EP05. 组合设计模式</h2><blockquote><p>心法: 组合设计模式 <code>Composite Pattern</code>，也叫部分整体模式</p></blockquote><ul><li>组合设计模式使用树形结构来表示 <code>部分 - 整体</code> 的层次结构。</li><li>组合设计模式的可扩展性高，适用于文件夹目录遍历，搭建下拉菜单等场景。</li></ul><blockquote><p>武技: 测试组合设计模式</p></blockquote><ol><li>开发实体类 <code>Emp</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> composite.entity;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Data</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Emp</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String empName;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Set<span style=color:#f92672>&lt;</span>Emp<span style=color:#f92672>&gt;</span> subEmps;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Emp</span>(String empName) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>empName</span> <span style=color:#f92672>=</span> empName;
</span></span><span style=display:flex><span>        subEmps <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashSet<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 添加下属 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>add</span>(Emp subEmp) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>subEmps</span>.<span style=color:#a6e22e>add</span>(subEmp);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 删除下属 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>del</span>(Emp subEmp) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>subEmps</span>.<span style=color:#a6e22e>remove</span>(subEmp);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 查看下属 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Set<span style=color:#f92672>&lt;</span>Emp<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>list</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> subEmps;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>开发测试类 <code>CompositeTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> composite;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CompositeTest</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testComposite</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 构建赵四家族企业树形结构</span>
</span></span><span style=display:flex><span>        Emp zhaosi <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Emp(<span style=color:#e6db74>&#34;赵四&#34;</span>);
</span></span><span style=display:flex><span>        Emp yutian <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Emp(<span style=color:#e6db74>&#34;赵玉田&#34;</span>);
</span></span><span style=display:flex><span>        Emp liuying <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Emp(<span style=color:#e6db74>&#34;刘英&#34;</span>);
</span></span><span style=display:flex><span>        liuying.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> Emp(<span style=color:#e6db74>&#34;赵兰妮&#34;</span>));
</span></span><span style=display:flex><span>        liuying.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> Emp(<span style=color:#e6db74>&#34;赵兰娜&#34;</span>));
</span></span><span style=display:flex><span>        zhaosi.<span style=color:#a6e22e>add</span>(yutian);
</span></span><span style=display:flex><span>        zhaosi.<span style=color:#a6e22e>add</span>(liuying);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 构建谢广坤家族企业树形结构</span>
</span></span><span style=display:flex><span>        Emp guangkun <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Emp(<span style=color:#e6db74>&#34;谢广坤&#34;</span>);
</span></span><span style=display:flex><span>        Emp yongqiang <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Emp(<span style=color:#e6db74>&#34;谢永强&#34;</span>);
</span></span><span style=display:flex><span>        Emp xiaomeng <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Emp(<span style=color:#e6db74>&#34;王小蒙&#34;</span>);
</span></span><span style=display:flex><span>        xiaomeng.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> Emp(<span style=color:#e6db74>&#34;谢成龙&#34;</span>));
</span></span><span style=display:flex><span>        xiaomeng.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> Emp(<span style=color:#e6db74>&#34;谢成凤&#34;</span>));
</span></span><span style=display:flex><span>        yongqiang.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> Emp(<span style=color:#e6db74>&#34;谢飞机&#34;</span>));
</span></span><span style=display:flex><span>        guangkun.<span style=color:#a6e22e>add</span>(yongqiang);
</span></span><span style=display:flex><span>        guangkun.<span style=color:#a6e22e>add</span>(xiaomeng);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 查看</span>
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(zhaosi.<span style=color:#a6e22e>getEmpName</span>() <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;家族如下: &#34;</span>);
</span></span><span style=display:flex><span>        zhaosi.<span style=color:#a6e22e>list</span>().<span style=color:#a6e22e>forEach</span>(System.<span style=color:#a6e22e>out</span>::println);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(guangkun.<span style=color:#a6e22e>getEmpName</span>() <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;家族如下: &#34;</span>);
</span></span><span style=display:flex><span>        guangkun.<span style=color:#a6e22e>list</span>().<span style=color:#a6e22e>forEach</span>(System.<span style=color:#a6e22e>out</span>::println);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep06-外观设计模式>EP06. 外观设计模式</h2><blockquote><p>心法: 外观设计模式 <code>Facade Pattern</code></p></blockquote><ul><li>外观模式用于隐藏系统的复杂性，向客户端提供一个可以访问系统的接口:<ul><li>核心就是在客户端和复杂系统之间再加一层，该层提前将调用顺序和依赖关系等处理完毕。</li></ul></li><li>外观模式的优点是提高系统灵活性和安全性，减少系统相互之间的依赖。</li><li>外观模式的缺点是不符合开闭原则，若需要进行修改，则非常麻烦。</li></ul><blockquote><p>武技: 测试外观设计模式</p></blockquote><ol><li>开发图形接口类 <code>Shape</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> facade;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>Shape</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 绘制图形 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>draw</span>();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>开发图形接口实现类 <code>CircleShape</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> facade;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CircleShape</span> <span style=color:#66d9ef>implements</span> Shape {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;模拟绘制一个圆圈&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>开发图形接口实现类 <code>HeartShape</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> facade;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HeartShape</span> <span style=color:#66d9ef>implements</span> Shape {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;模拟绘制一个爱心&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=4><li>开发外观类 <code>ShapeMaker</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> facade;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ShapeMaker</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Shape circleShape;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Shape heartShape;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>ShapeMaker</span>() {
</span></span><span style=display:flex><span>        circleShape <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CircleShape();
</span></span><span style=display:flex><span>        heartShape <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HeartShape();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>drawCircle</span>() {
</span></span><span style=display:flex><span>        circleShape.<span style=color:#a6e22e>draw</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>drawHeart</span>() {
</span></span><span style=display:flex><span>        heartShape.<span style=color:#a6e22e>draw</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=5><li>开发测试类 <code>FacadeTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> facade;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FacadeTest</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testFacade</span>() {
</span></span><span style=display:flex><span>        ShapeMaker shapeMaker <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ShapeMaker();
</span></span><span style=display:flex><span>        shapeMaker.<span style=color:#a6e22e>drawCircle</span>();
</span></span><span style=display:flex><span>        shapeMaker.<span style=color:#a6e22e>drawHeart</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep07-享元设计模式>EP07. 享元设计模式</h2><blockquote><p>心法: 享元设计模式 <code>Flyweight Pattern</code></p></blockquote><ul><li>享元设计模式主要用于减少重复对象的创建过程，减少内存占用，提高性能。</li><li>享元设计模式使用流程:<ol><li>创建一个工厂类，并在内部维护一个 <code>HashMap&lt;标识, 对象></code> 属性，用于缓存实例。</li><li>客户端通过工厂类来获取实例，并不使用new的方式进行实例创建。</li><li>若此时HashMap中已经缓存了相同的实例，则直接获取并返回，不用实例化。</li><li>若此时HashMap中并未缓存相同的实例，才进行实例化并返回。</li></ol></li></ul><blockquote><p>武技: 测试享元设计模式</p></blockquote><ol><li>开发实体类 <code>Car</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> flyweight.entity;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Data</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Car</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 汽车品牌 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String brand;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Car</span>(String brand) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>brand</span> <span style=color:#f92672>=</span> brand;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>开发工厂类 <code>CarFactory</code>:<ul><li>这里虽然使用了Factory，但它并非是工厂模式。</li></ul></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> flyweight;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CarFactory</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 维护一个用于缓存Car实例的Map */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> Map<span style=color:#f92672>&lt;</span>String, Car<span style=color:#f92672>&gt;</span> carMap <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashMap<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 根据品牌信息获取Car实例 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> Car <span style=color:#a6e22e>getCar</span>(String brand) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 尝试从carMap中获取指定品牌的汽车</span>
</span></span><span style=display:flex><span>        Car car <span style=color:#f92672>=</span> carMap.<span style=color:#a6e22e>get</span>(brand);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 若carMap中不存在该品牌的汽车，则创建实例并共享到carMap中</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (car <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>            car <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Car(brand);
</span></span><span style=display:flex><span>            carMap.<span style=color:#a6e22e>put</span>(brand, car);
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(car <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; 被实例化&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 若carMap中存在该品牌的汽车，则直接返回</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> car;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>开发测试类 <code>FlyWeightTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> flyweight;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FlyWeightTest</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testFlyWeight</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 重复创建5次宝马汽车，但实例化过程仅执行一次</span>
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(CarFactory.<span style=color:#a6e22e>getCar</span>(<span style=color:#e6db74>&#34;宝马&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(CarFactory.<span style=color:#a6e22e>getCar</span>(<span style=color:#e6db74>&#34;宝马&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(CarFactory.<span style=color:#a6e22e>getCar</span>(<span style=color:#e6db74>&#34;宝马&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(CarFactory.<span style=color:#a6e22e>getCar</span>(<span style=color:#e6db74>&#34;宝马&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(CarFactory.<span style=color:#a6e22e>getCar</span>(<span style=color:#e6db74>&#34;宝马&#34;</span>));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep08-代理设计模式>EP08. 代理设计模式</h2><blockquote><p>心法: JDK动态代理</p></blockquote><ul><li>JDK动态代理的客户，即聘请代理的对象必须是某接口的实现类。</li></ul><blockquote><p>武技: 测试JDK动态代理</p></blockquote><ol><li>开发客户接口 <code>UserService</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> proxy;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>UserService</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 客户的添加方法 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>create</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 客户的查询方法 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>select</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 客户的修改方法 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>update</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 客户的删除方法 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>delete</span>();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>开发客户实现类 <code>UserServiceImpl</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> proxy;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>UserServiceImpl</span> <span style=color:#66d9ef>implements</span> UserService {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>create</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;执行添加方法&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>select</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;执行查询方法&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>update</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;执行修改方法&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>delete</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;执行删除方法&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>开发JDK代理公司类 <code>JdkProxyCompany</code>:<ul><li>重写 <code>InvocationHandler -> invoke()</code> 工作清单方法。</li></ul></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> proxy;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>JdkProxyCompany</span> <span style=color:#66d9ef>implements</span> InvocationHandler {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Object customer;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * 代理工作清单
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param proxy  代理对象
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param method 代理方法的Method对象
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param args   代理方法的形参
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @return 代理方法的返回值，若是void，就返回null
</span></span></span><span style=display:flex><span><span style=color:#75715e>     */</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@SneakyThrows</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Object <span style=color:#a6e22e>invoke</span>(Object proxy, Method method, Object<span style=color:#f92672>[]</span> args) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;调用鉴权方法..&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 反射方法: 返回值 = 方法对象.invoke(客户对象, 方法形参)</span>
</span></span><span style=display:flex><span>        Object methodReturn <span style=color:#f92672>=</span> method.<span style=color:#a6e22e>invoke</span>(customer, args);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;记录日志..&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> methodReturn;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/***
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * 聘用一个代理，聘用代理时必须告诉我客户是谁
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param customer 客户实体
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @return 代理对象
</span></span></span><span style=display:flex><span><span style=color:#75715e>     */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Object <span style=color:#a6e22e>hireProxy</span>(Object customer) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>customer</span> <span style=color:#f92672>=</span> customer;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建代理时，需要获取客户的类加载器，客户的所有接口和任务清单所在类</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> Proxy.<span style=color:#a6e22e>newProxyInstance</span>(
</span></span><span style=display:flex><span>                customer.<span style=color:#a6e22e>getClass</span>().<span style=color:#a6e22e>getClassLoader</span>(),
</span></span><span style=display:flex><span>                customer.<span style=color:#a6e22e>getClass</span>().<span style=color:#a6e22e>getInterfaces</span>(), <span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=4><li>开发测试类 <code>JdkProxyTest</code></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> proxy;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>JdkProxyTest</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testJdkProxy</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建JDK代理公司实例</span>
</span></span><span style=display:flex><span>        JdkProxyCompany jdkProxyCompany <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> JdkProxyCompany();
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建客户类</span>
</span></span><span style=display:flex><span>        UserService userService <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> UserServiceImpl();
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 为指定客户类聘用代理: 需要将代理强转为客户接口类型，否则无法调用业务方法</span>
</span></span><span style=display:flex><span>        UserService userServiceProxy <span style=color:#f92672>=</span> (UserService) jdkProxyCompany.<span style=color:#a6e22e>hireProxy</span>(userService);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 使用代理调用完成客户类的功能</span>
</span></span><span style=display:flex><span>        userServiceProxy.<span style=color:#a6e22e>create</span>();
</span></span><span style=display:flex><span>        userServiceProxy.<span style=color:#a6e22e>select</span>();
</span></span><span style=display:flex><span>        userServiceProxy.<span style=color:#a6e22e>update</span>();
</span></span><span style=display:flex><span>        userServiceProxy.<span style=color:#a6e22e>delete</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=ch06-行为型设计模式>CH06. 行为型设计模式</h1><h2 id=ep01-策略设计模式>EP01. 策略设计模式</h2><blockquote><p>心法: 策略设计模式 <code>Strategy Pattern</code></p></blockquote><ul><li>策略设计模式主要用于将多种处理方式设置为实现类，并交给用户在运行时来决定具体使哪一种实现。</li><li>比如在电商系统中，支持银行卡，微信或支付宝等多种支付方式，每种方式都需要调用不同的第三方接口:<ul><li>此时若仍在服务类中使用IF-ELSE来判断用户具体选择的支付方式，则扩展性差且不符合开闭原则。</li><li>建议使用策略模式，将三种付款方式设置为三种实现，具体使用哪种方式由用户来选择和决定。</li></ul></li><li>JDK中，<code>Collections.sort(List list, Comparator c)</code> 使用的就是策略模式:<ul><li>用户在运行时可以传入一个比较器的实现，然后该方法中根据不同的实现，按照不同的方式进行排序。</li></ul></li></ul><blockquote><p>武技: 测试策略模式</p></blockquote><ol><li>开发策略接口 <code>PayStrategy</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> strategy;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>PayStrategy</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>/**支付方法*/</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>pay</span>();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>开发策略实现类 <code>WeChatStrategy</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> strategy;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WeChatStrategy</span> <span style=color:#66d9ef>implements</span> PayStrategy {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>pay</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;使用微信支付&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>开发策略实现类 <code>AliPayStrategy</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> strategy;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AliPayStrategy</span> <span style=color:#66d9ef>implements</span> PayStrategy {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>pay</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;使用支付宝支付&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=4><li>开发业务类 <code>PayService</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> strategy;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PayService</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 将支付策略作为参数传递给支付服务 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>pay</span>(PayStrategy strategy) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 按照运行时用户指定的策略进行支付</span>
</span></span><span style=display:flex><span>        strategy.<span style=color:#a6e22e>pay</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=5><li>开发测试类 <code>StrategyTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> strategy;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>StrategyTest</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testStrategy</span>() {
</span></span><span style=display:flex><span>        PayService payService <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PayService();
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 使用微信支付</span>
</span></span><span style=display:flex><span>        payService.<span style=color:#a6e22e>pay</span>(<span style=color:#66d9ef>new</span> WeChatStrategy());
</span></span><span style=display:flex><span>        <span style=color:#75715e>//使用支付宝支付</span>
</span></span><span style=display:flex><span>        payService.<span style=color:#a6e22e>pay</span>(<span style=color:#66d9ef>new</span> AliPayStrategy());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep02-模板设计模式>EP02. 模板设计模式</h2><blockquote><p>心法: 模板设计模式 <code>Template Pattern</code></p></blockquote><ul><li>模板设计模式用于定义一个操作中算法的骨架，而将一些步骤延迟到子类中:<ul><li>模板方法使得子类可以不改变算法的结构，只是重定义该算法的某些特定步骤。</li></ul></li><li>模板设计模式优点:<ul><li>封装不变部分，扩展可变部分，将公共代码提取出来，更便于系统的维护。</li></ul></li><li>模板设计模式缺点:<ul><li>每一个不同的实现都需要一个子类来实现，导致类的个数增加，使得系统更加庞大。</li></ul></li><li>Java中常用的 <code>JdbcTemplate/RedisTemplate/RestTemplate</code> 等使用的都是模板模式。</li></ul><blockquote><p>武技: 测试模板设计模式</p></blockquote><ol><li>开发模板接口 <code>GameTemplate</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> template;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>GameTemplate</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 游戏初始化时执行的方法 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>init</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 游戏中执行的方法 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>gaming</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 游戏结束方法 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>over</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 在模板接口中对外暴露一个方法，用于控制整体流程 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>play</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 游戏执行第1步</span>
</span></span><span style=display:flex><span>        init();
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 游戏执行第2步</span>
</span></span><span style=display:flex><span>        gaming();
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 游戏执行第3步</span>
</span></span><span style=display:flex><span>        over();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>开发模板接口实现类 <code>BasketballGame</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> template;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BasketballGame</span> <span style=color:#66d9ef>implements</span> GameTemplate {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>init</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;篮球游戏初始化&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>gaming</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;篮球游戏进行中&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>over</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;篮球游戏结束&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>开发模板接口实现类 <code>FootballGame</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> template;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FootballGame</span> <span style=color:#66d9ef>implements</span> GameTemplate {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>init</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;足球游戏初始化&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>gaming</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;足球游戏进行中&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>over</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;足球游戏结束&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=4><li>开发测试类 <code>TemplateTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> template;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TemplateTest</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testTemplate</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 构建足球游戏模板类</span>
</span></span><span style=display:flex><span>        GameTemplate footballGameTemplate <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> FootballGame();
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 调用足球游戏模板类中的 play() 方法</span>
</span></span><span style=display:flex><span>        footballGameTemplate.<span style=color:#a6e22e>play</span>();
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 构建篮球游戏模板类</span>
</span></span><span style=display:flex><span>        GameTemplate basketballGameTemplate <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> BasketballGame();
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 调用篮球游戏模板类中的 play() 方法</span>
</span></span><span style=display:flex><span>        basketballGameTemplate.<span style=color:#a6e22e>play</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep03-空对象设计模式>EP03. 空对象设计模式</h2><blockquote><p>心法: 空对象设计模式 <code>Null Object Pattern</code></p></blockquote><ul><li>空对象设计模式的核心是设计一个空对象，以避免程序抛出NullPointerException异常:<ul><li>目的是让调用方可以直接使用对象，而无需关心对象是否为null。</li><li>空对象设计模式不属于GOF23种设计模式，但不影响它也是一种常用设计模式。</li></ul></li><li>空对象模式的优点:<ul><li>当代码更加简洁: 调用方省不再需要对null值的判断和检查。</li><li>让系统更加稳定: 避免程序抛出NullPointerException异常。</li></ul></li><li>空对象模式的缺点: 因为增加了更多的类，从而使系统变得比之前复杂。</li><li>JDK8中的Optional对象使用的就是空对象模式，避免空指针的异常，同时又能写出优雅而简洁的Java代码。</li></ul><blockquote><p>武技: 测试空对象设计模式</p></blockquote><ol><li>开发具体对象实体类 <code>Goods</code>:<ul><li>开发对应该对象实体类的空对象内部类。</li></ul></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> nullobject.entity;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@AllArgsConstructor</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@NoArgsConstructor</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Data</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Goods</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 商品主键 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> Integer goodsId;
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 商品名称 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> String goodsName;
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 商品价格 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> Double goodsPrice;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 展示商品 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>show</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;%d号商品是%s，价格为%.2f元\n&#34;</span>, goodsId, goodsName, goodsPrice);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 开发对应该对象实体类的空对象内部类 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>NullGoods</span> <span style=color:#66d9ef>extends</span> Goods {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>show</span>() {
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;暂无该商品信息&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>开发业务接口 <code>GoodsService</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> nullobject;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>GoodsService</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * 按商品主键查询商品记录
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param goodsId 商品主键
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @return 一条上皮记录
</span></span></span><span style=display:flex><span><span style=color:#75715e>     */</span>
</span></span><span style=display:flex><span>    Goods <span style=color:#a6e22e>selectByGoodsId</span>(Integer goodsId);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>开发业务实现类 <code>GoodsServiceImpl</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> nullobject;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>GoodsServiceImpl</span> <span style=color:#66d9ef>implements</span> GoodsService {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Goods <span style=color:#a6e22e>selectByGoodsId</span>(Integer goodsId) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 模拟数据库中的数据</span>
</span></span><span style=display:flex><span>        List<span style=color:#f92672>&lt;</span>Goods<span style=color:#f92672>&gt;</span> mockGoods <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>        mockGoods.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> Goods(1, <span style=color:#e6db74>&#34;花生&#34;</span>, 10.<span style=color:#a6e22e>0</span>));
</span></span><span style=display:flex><span>        mockGoods.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> Goods(2, <span style=color:#e6db74>&#34;牛奶&#34;</span>, 20.<span style=color:#a6e22e>0</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 如果查询到了对应数据，则返回该Goods实体</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (Goods mockGoodsItem : mockGoods) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (Objects.<span style=color:#a6e22e>equals</span>(mockGoodsItem.<span style=color:#a6e22e>getGoodsId</span>(), goodsId)) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> mockGoodsItem;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 否则返回一个对应Goods的空对象</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> Goods.<span style=color:#a6e22e>NullGoods</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=4><li>开发测试类 <code>NullObjectTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> nullobject;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>NullObjectTest</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testNullObject</span>() {
</span></span><span style=display:flex><span>        GoodsService goodsService <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> GoodsServiceImpl();
</span></span><span style=display:flex><span>        goodsService.<span style=color:#a6e22e>selectByGoodsId</span>(1).<span style=color:#a6e22e>show</span>();
</span></span><span style=display:flex><span>        goodsService.<span style=color:#a6e22e>selectByGoodsId</span>(2).<span style=color:#a6e22e>show</span>();
</span></span><span style=display:flex><span>        goodsService.<span style=color:#a6e22e>selectByGoodsId</span>(3).<span style=color:#a6e22e>show</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ep04-命令设计模式>EP04. 命令设计模式</h2><blockquote><p>心法: 命令设计模式 <code>Command Pattern</code></p></blockquote><ul><li>命令设计模式: 对命令调用者Invoker和命令接收者Receiver进行解耦:<ul><li>接收者: 负责开发命令对应的具体业务方法，任何类都可以当接收者。</li><li>命令接口: 负责对外暴露 <code>execute()/revoke()</code> 等操作命令的相关方法。</li><li>命令实现类: 负责绑定Receiver并调用Receiver中的具体业务方法。</li><li>调用者: 负责调用命令接口中的 <code>execute()/revoke()</code> 等方法。</li><li>客户端: 负责向Invoker发送执行某条命令的请求。</li></ul></li><li>命令设计模式优点:<ul><li>降低了调用者和接收者之间的耦合度，且很容易扩展新的命令。</li></ul></li><li>命令设计模式缺点:<ul><li>可能导致系统中有过多的命令实现类。</li></ul></li></ul><blockquote><p>武技: 测试命令设计模式</p></blockquote><ol><li>开发命令接收者类 <code>TVReceiver</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> commond;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TVReceiver</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 打开电视 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>turnOn</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;执行结果: 电视机已打开，请观察设配状态&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 关闭电视 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>turnOff</span>() {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;执行结果: 电视机已关闭，请观察设配状态&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 播放指定电视或电影 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>play</span>(String movieName) {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;执行结果: 正在播放 《&#34;</span> <span style=color:#f92672>+</span> movieName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;》&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>开发命令接口 <code>Command</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> commond;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>Command</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 该方法用于执行命令 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>execute</span>();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>开发命令实现类 <code>TVOnCommand</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> commond;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TVOnCommand</span> <span style=color:#66d9ef>implements</span> Command {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 命令接收者 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> TVReceiver tvReceiver;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 创建命令的同时，需要绑定命令的接收者 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>TVOnCommand</span>(TVReceiver tvReceiver) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>tvReceiver</span> <span style=color:#f92672>=</span> tvReceiver;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>execute</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 执行接收者的对应方法: 打开电视</span>
</span></span><span style=display:flex><span>        tvReceiver.<span style=color:#a6e22e>turnOn</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=4><li>开发命令实现类 <code>TVOffCommand</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> commond;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TVOffCommand</span> <span style=color:#66d9ef>implements</span> Command {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 命令接收者 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> TVReceiver tvReceiver;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 创建命令的同时，需要绑定命令的接收者 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>TVOffCommand</span>(TVReceiver tvReceiver) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>tvReceiver</span> <span style=color:#f92672>=</span> tvReceiver;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>execute</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 执行接收者的对应方法: 关闭电视</span>
</span></span><span style=display:flex><span>        tvReceiver.<span style=color:#a6e22e>turnOff</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=5><li>开发命令实现类 <code>TVPlayCommand</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> commond;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TVPlayCommand</span> <span style=color:#66d9ef>implements</span> Command {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 命令接收者 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> TVReceiver tvReceiver;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 电影名称 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> String movieName;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/** 创建命令的同时，需要绑定命令的接收者以及相关参数 */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>TVPlayCommand</span>(TVReceiver tvReceiver, String movieName) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>tvReceiver</span> <span style=color:#f92672>=</span> tvReceiver;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>movieName</span> <span style=color:#f92672>=</span> movieName;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>execute</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 执行接收者的对应方法: 播放指定电影</span>
</span></span><span style=display:flex><span>        tvReceiver.<span style=color:#a6e22e>play</span>(movieName);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=6><li>开发调用者类 <code>XiaoAiInvoker</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> commond;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Data</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>XiaoAiInvoker</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Command tvOffCommand;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Command tvOnCommand;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Command tvPlayCommand;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>turnOn</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 调用命令: 打开电视</span>
</span></span><span style=display:flex><span>        tvOnCommand.<span style=color:#a6e22e>execute</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>turnOff</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 调用命令: 关闭电视</span>
</span></span><span style=display:flex><span>        tvOffCommand.<span style=color:#a6e22e>execute</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>play</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 调用命令: 播放指定电影</span>
</span></span><span style=display:flex><span>        tvPlayCommand.<span style=color:#a6e22e>execute</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=7><li>开发测试类 <code>CommandTest</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> commond;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** @author lsx */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CommandTest</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testCommand</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Invoker调用者: 实例化小爱音箱</span>
</span></span><span style=display:flex><span>        XiaoAiInvoker xiaoAi <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> XiaoAiInvoker();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Receiver接收者: 实例化电视</span>
</span></span><span style=display:flex><span>        TVReceiver tv <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> TVReceiver();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Command命令: 将打开电视，关闭电视和播放指定电影这3条命令设置给小爱音箱</span>
</span></span><span style=display:flex><span>        xiaoAi.<span style=color:#a6e22e>setTvOnCommand</span>(<span style=color:#66d9ef>new</span> TVOnCommand(tv));
</span></span><span style=display:flex><span>        xiaoAi.<span style=color:#a6e22e>setTvOffCommand</span>(<span style=color:#66d9ef>new</span> TVOffCommand(tv));
</span></span><span style=display:flex><span>        xiaoAi.<span style=color:#a6e22e>setTvPlayCommand</span>(<span style=color:#66d9ef>new</span> TVPlayCommand(tv, <span style=color:#e6db74>&#34;甄嬛传&#34;</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 测试: 通过小爱音箱发送3条命令</span>
</span></span><span style=display:flex><span>        xiaoAi.<span style=color:#a6e22e>turnOn</span>();
</span></span><span style=display:flex><span>        xiaoAi.<span style=color:#a6e22e>turnOff</span>();
</span></span><span style=display:flex><span>        xiaoAi.<span style=color:#a6e22e>play</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div></main><footer class=footer><span>&copy; 2024 The Marauders</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>