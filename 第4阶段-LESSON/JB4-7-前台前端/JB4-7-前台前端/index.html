<!doctype html><html lang=en><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>JB4-7-前台前端</title>
<meta name=description content="[!NOTE] Java道经第4卷 - 第7阶 - 前台前端 lesson-server-miniapp
S01. 项目实战准备 E01. 创建微信项目 1. 安装开发者工具 下载 微信开发者工具，傻瓜式安装即可： wechat_devtools_xxxx_win32_x64.exe 启动微信开发者工具，登录自己的微 …"><meta name=keywords content='blog,lsx2216,hugo'><meta property="og:url" content="https://lsx2216.netlify.app/%E7%AC%AC4%E9%98%B6%E6%AE%B5-LESSON/JB4-7-%E5%89%8D%E5%8F%B0%E5%89%8D%E7%AB%AF/JB4-7-%E5%89%8D%E5%8F%B0%E5%89%8D%E7%AB%AF/"><meta property="og:type" content="website"><meta property="og:title" content="JB4-7-前台前端"><meta property="og:description" content="[!NOTE] Java道经第4卷 - 第7阶 - 前台前端 lesson-server-miniapp
S01. 项目实战准备 E01. 创建微信项目 1. 安装开发者工具 下载 微信开发者工具，傻瓜式安装即可： wechat_devtools_xxxx_win32_x64.exe 启动微信开发者工具，登录自己的微 …"><meta property="og:image" content="https://lsx2216.netlify.app/assets/images/user.jpg"><meta property="og:image:secure_url" content="https://lsx2216.netlify.app/assets/images/user.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="JB4-7-前台前端"><meta name=twitter:description content="[!NOTE] Java道经第4卷 - 第7阶 - 前台前端 lesson-server-miniapp
S01. 项目实战准备 E01. 创建微信项目 1. 安装开发者工具 下载 微信开发者工具，傻瓜式安装即可： wechat_devtools_xxxx_win32_x64.exe 启动微信开发者工具，登录自己的微 …"><meta property="twitter:domain" content="https://lsx2216.netlify.app/%E7%AC%AC4%E9%98%B6%E6%AE%B5-LESSON/JB4-7-%E5%89%8D%E5%8F%B0%E5%89%8D%E7%AB%AF/JB4-7-%E5%89%8D%E5%8F%B0%E5%89%8D%E7%AB%AF/"><meta property="twitter:url" content="https://lsx2216.netlify.app/%E7%AC%AC4%E9%98%B6%E6%AE%B5-LESSON/JB4-7-%E5%89%8D%E5%8F%B0%E5%89%8D%E7%AB%AF/JB4-7-%E5%89%8D%E5%8F%B0%E5%89%8D%E7%AB%AF/"><meta name=twitter:image content="https://lsx2216.netlify.app/assets/images/user.jpg"><link rel=canonical href=https://lsx2216.netlify.app/%E7%AC%AC4%E9%98%B6%E6%AE%B5-LESSON/JB4-7-%E5%89%8D%E5%8F%B0%E5%89%8D%E7%AB%AF/JB4-7-%E5%89%8D%E5%8F%B0%E5%89%8D%E7%AB%AF/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.3eb19cb61dde9e37b9522867f3e024aeb68e26ab8e03252e46e365abcb19acf7.js integrity="sha256-PrGcth3enje5Uihn8+AkrraOJquOAyUuRuNlq8sZrPc="></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css integrity=sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js integrity=sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})})</script>    <link rel="shortcut icon" href="/assets/images/user.jpg" type="image/x-icon">
</head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://lsx2216.netlify.app/><img src=/assets/images/user.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://lsx2216.netlify.app/>lsx2216</a></div><div class=nav-links><div class=nav-link><a href=https://lsx2216.netlify.app/ aria-label><span data-feather=home></span> Home</a></div><div class=nav-link><a href=https://lsx2216.netlify.app/projects/ aria-label><span data-feather=code></span> Projects</a></div><div class=nav-link><a href=https://github.com aria-label=github><span data-feather=github></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://lsx2216.netlify.app/><span data-feather=home></span> Home</a></li><li class=nav-item><a href=https://lsx2216.netlify.app/projects/><span data-feather=code></span> Projects</a></li><li class=nav-item><a href=https://github.com><span data-feather=github></span></a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>JB4-7-前台前端</h1></div><div class=post-content><blockquote><p>[!NOTE] Java道经第4卷 - 第7阶 - 前台前端
lesson-server-miniapp</p></blockquote><h1 id=s01-项目实战准备>S01. 项目实战准备</h1><h2 id=e01-创建微信项目>E01. 创建微信项目</h2><h3 id=1-安装开发者工具>1. 安装开发者工具</h3><ol><li>下载 <a href=https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html>微信开发者工具</a>，傻瓜式安装即可：<ul><li><code>wechat_devtools_xxxx_win32_x64.exe</code></li></ul></li><li>启动微信开发者工具，登录自己的微信。</li></ol><h3 id=2-创建小程序项目>2. 创建小程序项目</h3><ol><li>创建微信小程序项目 <code>lesson-server-miniapp</code>：</li></ol><p><img src=/%E7%AC%AC4%E9%98%B6%E6%AE%B5-LESSON/JB4-7-%E5%89%8D%E5%8F%B0%E5%89%8D%E7%AB%AF/image/%E5%88%9B%E5%BB%BA%E5%B0%8F%E7%A8%8B%E5%BA%8F%E9%A1%B9%E7%9B%AE.png alt></p><h3 id=3-调整模拟器布局>3. 调整模拟器布局</h3><ol><li>点击模拟器左上角，选择机型为 <code>iPhone 15 Pro Max 100%</code>。</li><li>点击模拟器左上角，选择显示比例为 <code>自适应</code>。</li></ol><h3 id=4-调整内存限制数>4. 调整内存限制数</h3><ol><li>左上角依次点击 <code>设置 -> 通用设置 [ctrl + ,] -> 通用</code>: 修改内存限制为2048M:</li></ol><p><img src=/%E7%AC%AC4%E9%98%B6%E6%AE%B5-LESSON/JB4-7-%E5%89%8D%E5%8F%B0%E5%89%8D%E7%AB%AF/image/%E8%B0%83%E6%95%B4%E5%86%85%E5%AD%98%E9%99%90%E5%88%B6.png alt></p><h3 id=5-调整基础库版本>5. 调整基础库版本</h3><ol><li>右上角依次点击 <code>详情 -> 本地设置</code>: 调整 <code>调试基础库</code> 为当时百分比最高的版本：</li></ol><p><img src=/%E7%AC%AC4%E9%98%B6%E6%AE%B5-LESSON/JB4-7-%E5%89%8D%E5%8F%B0%E5%89%8D%E7%AB%AF/image/%E8%B0%83%E6%95%B4%E5%9F%BA%E7%A1%80%E5%BA%93%E7%89%88%E6%9C%AC.png alt></p><h3 id=6-不校验合法域名>6. 不校验合法域名</h3><ol><li>右上角依次点击 <code>详情 -> 本地设置</code>。</li><li>勾选 <code>不校验合法域名、web-view（业务域名）、TLS版本以及HTTPS证书</code> 项。</li></ol><p><img src=/%E7%AC%AC4%E9%98%B6%E6%AE%B5-LESSON/JB4-7-%E5%89%8D%E5%8F%B0%E5%89%8D%E7%AB%AF/image/%E4%B8%8D%E6%A0%A1%E9%AA%8C%E5%90%88%E6%B3%95%E5%9F%9F%E5%90%8D.png alt></p><h3 id=7-使用idea开发>7. 使用IDEA开发</h3><blockquote><p>武技: 使用IDEA打开微信小程序项目</p></blockquote><ol><li>需要 <code>Wechat mini program support</code> 插件，ZXY版本。</li><li>需要 <code>WeChat weapp Support</code> 插件。</li><li>尽量不要将小程序项目作为其他项目的子模块打开，否则某些提示可能会失效，影响开发体验。</li></ol><h2 id=e02-搭建项目环境>E02. 搭建项目环境</h2><h3 id=1-添加scss支持>1. 添加SCSS支持</h3><blockquote><p>心法: SCSS（Sassy CSS）预处理器</p></blockquote><ul><li>SCSS是一种CSS预处理器，是CSS的超集，支持全部CSS语法的同时，扩展了CSS的语法和功能：<ul><li>SCSS需要通过编译器转换为CSS才能在浏览器中使用。</li></ul></li><li>若创建项目时选择的JS基础模板时，默认不支持SCSS，若有需要，则需要先在项目中添加SCSS支持，然后手动将 <code>.wxss</code> 文件修改为 <code>.scss</code> 文件即可。</li></ul><table><thead><tr><th>对比项</th><th>SCSS</th><th>CSS</th></tr></thead><tbody><tr><td>自定义变量</td><td>在样式表外部使用 <code>$red: #252a34;</code> 定义变量在样式表内部使用 <code>{ color: $red }</code> 引入变量</td><td>不支持</td></tr><tr><td>引用其他样式表</td><td>在样式表上方使用 <code>@import "xxx"</code> 引入其他样式表</td><td>不支持</td></tr><tr><td>样式嵌套</td><td><code>a{ b{} }</code></td><td><code>a b{}</code></td></tr><tr><td>样式表注释</td><td>支持单行注释 <code>//</code> 和多行注释 <code>/* */</code>两种注释在编译为CSS时，均会完全移除以保证效率</td><td>仅支持多行注释 <code>/* */</code>注释始终保留</td></tr></tbody></table><blockquote><p>武技: 在项目中添加SCSS支持</p></blockquote><ol><li>使用 <code>"useCompilerPlugins": ["sass"]</code> 代码添加SCSS支持：</li></ol><p><code>project.config.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>...</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;setting&#34;</span>: {
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>...</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;useCompilerPlugins&#34;</span>: [<span style=color:#e6db74>&#34;sass&#34;</span>]
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-优化初始代码>2. 优化初始代码</h3><ol><li>删除 <code>/pages/index/index.wxml</code> 中的全部内容。</li><li>优化 <code>/pages/index/index.js</code> 文件为 <code>Page({ data: {} })</code> 代码。</li><li>删除 <code>/pages/log</code> 目录。</li><li>优化 <code>/utils/util.js</code> 文件为 <code>module.exports = { }</code> 代码。</li><li>优化 <code>/app.js</code> 文件为 <code>App({ globalData: {} })</code> 代码。</li><li>优化 <code>/app.json</code> 文件如下：</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;pages&#34;</span>: [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;pages/index/index&#34;</span>
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;window&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;navigationBarTextStyle&#34;</span>: <span style=color:#e6db74>&#34;black&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;navigationBarTitleText&#34;</span>: <span style=color:#e6db74>&#34;李氏云课堂小程序&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;navigationBarBackgroundColor&#34;</span>: <span style=color:#e6db74>&#34;#ffffff&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;style&#34;</span>: <span style=color:#e6db74>&#34;v2&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;componentFramework&#34;</span>: <span style=color:#e6db74>&#34;glass-easel&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;sitemapLocation&#34;</span>: <span style=color:#e6db74>&#34;sitemap.json&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;lazyCodeLoading&#34;</span>: <span style=color:#e6db74>&#34;requiredComponents&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=3-整合vantweapp>3. 整合VantWeapp</h3><blockquote><p>心法: <a href=https://vant-contrib.gitee.io/vant-weapp/#/quickstart>Vant Weapp</a></p></blockquote><ol><li>安装Weapp依赖:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>npm i @vant/weapp@1.11.4 -S --production
</span></span></code></pre></div><ol start=2><li>将 <code>app.json</code> 中的 <code>"style": "v2"</code> 去除，规避部分组件样式混乱。</li><li>开启NPM支持：<ol><li>使用 <code>packNpmManually</code> 代码开启NPM支持。</li><li>使用 <code>packNpmRelationList -> packageJsonPath</code> 指定NPM依赖文件的位置。</li><li>使用 <code>packNpmRelationList -> miniprogramNpmDistDir</code> 指定NPM在哪个目录中打包。</li></ol></li></ol><p><code>project.config.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>...</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;setting&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>...</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;packNpmManually&#34;</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;packNpmRelationList&#34;</span>: [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;packageJsonPath&#34;</span>: <span style=color:#e6db74>&#34;./package.json&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;miniprogramNpmDistDir&#34;</span>: <span style=color:#e6db74>&#34;./&#34;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=4><li>构建NPM：<ol><li>右上角依次点击 <code>工具 -> 构建 npm</code>。</li><li>勾选 <code>使用 npm 模块</code> 选项，构建完成后，即可引入组件。</li></ol></li></ol><h2 id=e03-封装全局工具>E03. 封装全局工具</h2><h3 id=1-开发全局样式>1. 开发全局样式</h3><p><code>app.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span><span style=color:#75715e>/* 自定义颜色变量 */</span>
</span></span><span style=display:flex><span><span style=color:#f92672>$</span><span style=color:#f92672>bg-gray</span><span style=color:#f92672>:</span> #252a34<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>$</span><span style=color:#f92672>black</span><span style=color:#f92672>:</span> #000000<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>$</span><span style=color:#f92672>yellow</span><span style=color:#f92672>:</span> #f9ed69<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>$</span><span style=color:#f92672>orange</span><span style=color:#f92672>:</span> #f08a5d<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>$</span><span style=color:#f92672>white</span><span style=color:#f92672>:</span> #eaeaea<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>$</span><span style=color:#f92672>gray</span><span style=color:#f92672>:</span> #757171<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>$</span><span style=color:#f92672>subBlack</span><span style=color:#f92672>:</span> #232121<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/* 全局样式 */</span>
</span></span><span style=display:flex><span><span style=color:#f92672>page</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span>bg-gray;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>35</span>rpx;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>center</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>font-family</span>: <span style=color:#960050;background-color:#1e0010>思源黑体</span>, <span style=color:#960050;background-color:#1e0010>微软雅黑</span>, Consolas, <span style=color:#66d9ef>sans-serif</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/* 取消滚动条 */</span>
</span></span><span style=display:flex><span>::<span style=color:#a6e22e>-webkit-scrollbar</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>display</span>: <span style=color:#66d9ef>none</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>color</span>: <span style=color:#66d9ef>transparent</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/** vant分割线 */</span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>van-divider</span> {  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>20</span>rpx;  
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-开发全局工具>2. 开发全局工具</h3><blockquote><p>心法: 全局常量与全局方法</p></blockquote><table><thead><tr><th>对外暴露的API</th><th>功能描述</th><th>参数描述</th></tr></thead><tbody><tr><td><code>dateFormat(dateStr)</code></td><td>返回友好格式的日期字符串</td><td><code>dateStr</code> 日期字符串</td></tr><tr><td><code>confirm(content, callback)</code></td><td>带取消按钮的弹窗</td><td><code>content</code> 弹框内容<code>callback</code> 当点击确定按钮时触发的回调函数</td></tr><tr><td><code>tab(url, onload = true)</code></td><td>切换tab标签</td><td><code>url</code> 标签地址，<code>onload</code> 是否重新加载目标页面</td></tr><tr><td><code>page(url, onload = true)</code></td><td>切换page页面</td><td><code>url</code> 页面地址，<code>onload</code> 是否重新加载目标页面</td></tr><tr><td><code>isLogin(token)</code></td><td>判断用户是否登录</td><td></td></tr><tr><td><code>success(title)</code></td><td>成功弹窗</td><td><code>title</code> 弹窗内容，最多7个字符</td></tr><tr><td><code>error(title, err)</code></td><td>失败弹窗</td><td><code>title</code> 弹窗内容，最多7个字符<code>err</code> 异常信息文字</td></tr><tr><td><code>tip(title)</code></td><td>提示弹窗</td><td><code>title</code> 弹窗内容，字符数量无限制</td></tr><tr><td><code>getRandomColor()</code></td><td>获取随机颜色值</td><td></td></tr></tbody></table><blockquote><p>武技: 开发全局工具</p></blockquote><ol><li>开发全局常量：</li></ol><p><code>/utils/util.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>/* ========== 全局通用常量 ========== */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 环境IP地址: Windows环境测试时需要将 localhost 换成物理机真实IP地址
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>DEV_IP</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;localhost&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>PROD_IP</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;192.168.40.77&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>LESSON_SERVER</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`http://</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>DEV_IP</span><span style=color:#e6db74>}</span><span style=color:#e6db74>:5277`</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>WEBSOCKET_SERVER</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`ws://</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>DEV_IP</span><span style=color:#e6db74>}</span><span style=color:#e6db74>:5055`</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>ES_SERVER</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`http://</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>DEV_IP</span><span style=color:#e6db74>}</span><span style=color:#e6db74>:5003`</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// MINIO地址：Windows环境测试时需要将 host 换成 http://物理机真实IP地址:19001
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>MINIO</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`http://</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>PROD_IP</span><span style=color:#e6db74>}</span><span style=color:#e6db74>:9001/lesson-bucket/`</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 常用请求状态码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>STATUS</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;SUCCESS&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1000</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;FAILED&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1001</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;VALIDATE_FAILED&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1002</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;TOKEN_FAILED&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1003</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;TOKEN_EXPIRING_SOON&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1004</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;FORBIDDEN&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1005</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 常用表单规则
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>RULE</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;USERNAME&#39;</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>pattern</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/^[_a-zA-Z0-9]{4,20}$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;账号须由4到20个字母，数字或下划线组成&#39;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;PASSWORD&#39;</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>pattern</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/^[_a-zA-Z0-9]{4,20}$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;密码须由4到20个字母，数字或下划线组成&#39;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;NICKNAME&#39;</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>pattern</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/^[\u4e00-\u9fa5_a-zA-Z0-9]{4,20}$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;昵称须由4到20个中文，字母，数字或下划线组成&#39;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;REALNAME&#39;</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>pattern</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/^[\u4e00-\u9fa5]{2,10}$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;姓名须由2到10个中文组成&#39;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;PHONE&#39;</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>pattern</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/^1(3[0-9]|4[01456879]|5[0-35-9]|6[2567]|7[0-8]|8[0-9]|9[0-35-9])\d{8}$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;手机号码格式有误&#39;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;IDCARD&#39;</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>pattern</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/^[1-9]\d{5}(19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;身份证号格式有误&#39;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;EMAIL&#39;</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>pattern</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;电子邮箱格式有误&#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 项目大标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>PROJECT_TITLE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;李氏云课堂 - 在线课堂&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>// 项目小标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>PROJECT_SUB_TITLE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Welcome To Lesson Project&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>// 项目公告
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>PROJECT_NOTICE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;无论我们能活多久，我们能够享受的只有无法分割的此刻，此外别无其他。&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>// 项目公告列表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>NEWS</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;【公告】热烈庆祝三班Java课程正式开班！&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`我们邀请资深讲师，采用前沿教材，注重实践操作，助力学员轻松掌握Java编程技能。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               无论你是初学者还是进阶者，这里都将是你成长的摇篮。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               赶快加入我们，一起开启Java编程之旅吧！名额有限，报名从速！`</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;【公告】好消息！Java教材现已正式出版！&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`这本教材由资深Java专家精心撰写，内容深入浅出，既适合初学者入门，也适合进阶者提升。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               书中包含大量实战案例和练习题，助你轻松掌握Java编程的核心知识和技能。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               无论你是学生还是职场人士，这本教材都将是你学习Java的绝佳伴侣。赶快行动，抢购一本吧！`</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;【科普】Java究竟是一门怎样的语言？&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`Java是一种广泛应用的编程语言，以其简洁、面向对象和跨平台特性而著称。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               它支持多线程编程，拥有丰富的API和强大的社区支持。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               Java广泛应用于Web开发、移动应用、游戏开发等领域，是IT行业的重要基石之一。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               掌握Java，将为你打开编程世界的大门。`</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;【科普】计算机语言发展历史简述。&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`计算机语言发展史可追溯到20世纪40年代，最初是机器语言，直接以二进制代码操作计算机。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               随后诞生了汇编语言，以英文标签简化编程。到了20世纪50年代，高级语言如Fortran和Algol出现，更接近自然语言。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               之后，C、C++、Java、Python等语言相继涌现，面向对象编程成为主流。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               计算机语言的发展推动了计算机技术的飞速进步。`</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;【急聘】诚邀有志之士加入我们的教育团队！&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`现招聘Java讲师及助教若干名。Java讲师需具备丰富的教学经验和扎实的编程功底，能够引导学生深入学习Java技术；
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               助教则需协助讲师完成教学任务，解答学生疑问。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               我们提供优厚的待遇和良好的发展空间，期待你的加入，共同培养更多Java人才！`</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>];
</span></span></code></pre></div><ol start=2><li>开发全局方法：</li></ol><p><code>/utils/util.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>/* ========== 全局通用方法 ========== */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 返回友好格式的日期字符串
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param dateStr 日期字符串如 &#39;2024-01-01T00:00:00&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @returns {string} 一个格式友好的日期字符串如 &#39;2024年01月01日 00:00:00&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>dateFormat</span>(<span style=color:#a6e22e>dateStr</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 用于将六大元素处理为两位数格式（年除外）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>toDouble</span>(<span style=color:#a6e22e>e</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>e</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;0&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>e</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>e</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 将日期字符串转为日期格式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>date</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Date(<span style=color:#a6e22e>dateStr</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 获取日期中的六大元素: 年，月，日，时，分，秒
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>toDouble</span>(<span style=color:#a6e22e>date</span>.<span style=color:#a6e22e>getFullYear</span>());
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mm</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>toDouble</span>(<span style=color:#a6e22e>date</span>.<span style=color:#a6e22e>getMonth</span>() <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>dd</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>toDouble</span>(<span style=color:#a6e22e>date</span>.<span style=color:#a6e22e>getDate</span>());
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>hh</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>toDouble</span>(<span style=color:#a6e22e>date</span>.<span style=color:#a6e22e>getHours</span>());
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mi</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>toDouble</span>(<span style=color:#a6e22e>date</span>.<span style=color:#a6e22e>getMinutes</span>());
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ss</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>toDouble</span>(<span style=color:#a6e22e>date</span>.<span style=color:#a6e22e>getSeconds</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 返回美化后的日期字符串
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>yy</span><span style=color:#e6db74>}</span><span style=color:#e6db74>年</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>mm</span><span style=color:#e6db74>}</span><span style=color:#e6db74>月</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>dd</span><span style=color:#e6db74>}</span><span style=color:#e6db74>日 </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>hh</span><span style=color:#e6db74>}</span><span style=color:#e6db74>:</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>mi</span><span style=color:#e6db74>}</span><span style=color:#e6db74>:</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>ss</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 带按钮的确认弹框
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param content 弹框内容
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param onConfirm 确认时的回调函数
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param onCancel 取消时的回调函数
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>confirm</span>(<span style=color:#a6e22e>content</span>, <span style=color:#a6e22e>onConfirm</span>, <span style=color:#a6e22e>onCancel</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>showModal</span>({
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;提示&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>content</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>content</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>success</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>sm</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>sm</span>.<span style=color:#a6e22e>confirm</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>onConfirm</span>) <span style=color:#a6e22e>onConfirm</span>();
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>sm</span>.<span style=color:#a6e22e>cancel</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>onCancel</span>) <span style=color:#a6e22e>onCancel</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 跳转到另一个标签页或普通页
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param type 切换类型，可选标签页面 tab 或 普通页面 page
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param url 目标页面地址
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param reload 是否重新加载目标页面，默认true
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>to</span>(<span style=color:#a6e22e>type</span>, <span style=color:#a6e22e>url</span>, <span style=color:#a6e22e>reload</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 执行目标页面的 onload() 方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>reloadTarget</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>reload</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>page</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>getCurrentPages</span>().<span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>page</span>) <span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>onLoad</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#e6db74>&#39;tab&#39;</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>type</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>switchTab</span>({<span style=color:#a6e22e>url</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>url</span>, <span style=color:#a6e22e>success</span><span style=color:#f92672>:</span> () =&gt; <span style=color:#a6e22e>reloadTarget</span>()});
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#e6db74>&#39;page&#39;</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>type</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>navigateTo</span>({<span style=color:#a6e22e>url</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>url</span>, <span style=color:#a6e22e>success</span><span style=color:#f92672>:</span> () =&gt; <span style=color:#a6e22e>reloadTarget</span>()});
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;跳页类型有误&#39;</span>, <span style=color:#e6db74>&#39;type: &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>type</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 微信提示框
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param title 提示文字，不能超过7个字，普通类型除外
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param icon 提示图标
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param duration 提示文字持续的时间
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param err 异常信息
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>wxToast</span>(<span style=color:#a6e22e>title</span>, <span style=color:#a6e22e>icon</span>, <span style=color:#a6e22e>duration</span>, <span style=color:#a6e22e>err</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>err</span>) <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>showToast</span>({<span style=color:#a6e22e>title</span>, <span style=color:#a6e22e>icon</span>, <span style=color:#a6e22e>duration</span>});
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 微信模态框
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param title 提示文字
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param content 提示内容
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param success 用户点击确定后的回调函数
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param cancel 用户点击取消后的回调函数
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>wxModal</span>(<span style=color:#a6e22e>title</span>, <span style=color:#a6e22e>content</span>, <span style=color:#a6e22e>success</span>, <span style=color:#a6e22e>cancel</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>showModal</span>({
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>title</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>content</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>content</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>success</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>res</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>confirm</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>success</span>) <span style=color:#a6e22e>success</span>();
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>cancel</span>) <span style=color:#a6e22e>cancel</span>();
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 判断用户是否登录
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @returns {boolean} false未登录，true已登录
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>isLogin</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>getStorageSync</span>(<span style=color:#e6db74>&#39;token&#39;</span>)) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;请先登录&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>setTimeout</span>(() =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>page</span>(<span style=color:#e6db74>&#39;/pages/member/login-by-account/login-by-account&#39;</span>);
</span></span><span style=display:flex><span>        }, <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 随机生成一个十六进制的颜色值
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @returns {string} 十六进制的颜色值如 &#39;#000000&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getRandomColor</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>rgb</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>3</span>; <span style=color:#f92672>++</span><span style=color:#a6e22e>i</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#ae81ff>256</span>).<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;0&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>color</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>color</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>rgb</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>color</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;#&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>rgb</span>.<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>导出全局常量和方法：</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 导出模块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>LESSON_SERVER</span>, <span style=color:#a6e22e>WEBSOCKET_SERVER</span>, <span style=color:#a6e22e>ES_SERVER</span>, <span style=color:#a6e22e>MINIO</span>, <span style=color:#a6e22e>STATUS</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>RULE</span>, <span style=color:#a6e22e>PROJECT_TITLE</span>, <span style=color:#a6e22e>PROJECT_SUB_TITLE</span>, <span style=color:#a6e22e>PROJECT_NOTICE</span>, <span style=color:#a6e22e>NEWS</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dateFormat</span>, <span style=color:#a6e22e>confirm</span>, <span style=color:#a6e22e>isLogin</span>, <span style=color:#a6e22e>getRandomColor</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>tab</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>url</span>, <span style=color:#a6e22e>reload</span>) =&gt; <span style=color:#a6e22e>to</span>(<span style=color:#e6db74>&#39;tab&#39;</span>, <span style=color:#a6e22e>url</span>, <span style=color:#a6e22e>reload</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>page</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>url</span>, <span style=color:#a6e22e>reload</span>) =&gt; <span style=color:#a6e22e>to</span>(<span style=color:#e6db74>&#39;page&#39;</span>, <span style=color:#a6e22e>url</span>, <span style=color:#a6e22e>reload</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>success</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>title</span>) =&gt; <span style=color:#a6e22e>wxToast</span>(<span style=color:#a6e22e>title</span>, <span style=color:#e6db74>&#39;success&#39;</span>, <span style=color:#ae81ff>2000</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>error</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>title</span>, <span style=color:#a6e22e>err</span>) =&gt; <span style=color:#a6e22e>wxToast</span>(<span style=color:#a6e22e>title</span>, <span style=color:#e6db74>&#39;error&#39;</span>, <span style=color:#ae81ff>2000</span>, <span style=color:#a6e22e>err</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>tip</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>title</span>) =&gt; <span style=color:#a6e22e>wxToast</span>(<span style=color:#a6e22e>title</span>, <span style=color:#e6db74>&#39;none&#39;</span>, <span style=color:#ae81ff>2000</span>),
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>modal</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>title</span>, <span style=color:#a6e22e>content</span>, <span style=color:#a6e22e>success</span>, <span style=color:#a6e22e>cancel</span>) =&gt; <span style=color:#a6e22e>wxModal</span>(<span style=color:#a6e22e>title</span>, <span style=color:#a6e22e>content</span>, <span style=color:#a6e22e>success</span>, <span style=color:#a6e22e>cancel</span>),
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=3-封装请求工具>3. 封装请求工具</h3><table><thead><tr><th>对外暴露的API</th><th>功能描述</th><th>参数描述</th></tr></thead><tbody><tr><td><code>get(url, data, header)</code></td><td>发送GET请求</td><td><code>url</code> 请求地址，自动拼接后台前缀 <code>后台地址/api/v1</code><code>data</code> 请求参数，默认 <code>{}</code><code>header</code> 请求头，默认 <code>{'Content-Type': 'application/json'}</code></td></tr><tr><td><code>post(url, data, header)</code></td><td>发送POST请求</td><td><code>url</code> 请求地址，自动拼接后台前缀 <code>后台地址/api/v1</code><code>data</code> 请求参数，默认 <code>{}</code><code>header</code> 请求头，默认 <code>{'Content-Type': 'application/json'}</code></td></tr><tr><td><code>search(url, data, header)</code></td><td>发送搜索请求</td><td>参数同上，只不过服务器地址改为了ES地址</td></tr></tbody></table><p><code>/util/api.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;./util&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 请求方法
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param url 请求地址
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param method 请求方式，如 GET, POST 等
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param data 请求参数
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param header 请求头
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param server 服务器地址，默认是 util.LESSON_SERVER
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>request</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>url</span>, <span style=color:#a6e22e>method</span>, <span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>header</span>, <span style=color:#a6e22e>server</span>) =&gt; {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>server</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>server</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>LESSON_SERVER</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 请求拦截器：拼接请求前缀
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>server</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;/api/v1/&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>url</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 设置默认值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>method</span>) <span style=color:#a6e22e>method</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;GET&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>data</span>) <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> {};
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>header</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>header</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;Content-Type&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;application/json&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;token&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>getStorageSync</span>(<span style=color:#e6db74>&#39;token&#39;</span>) <span style=color:#f92672>||</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;请求拦截器：&#39;</span>, {<span style=color:#a6e22e>url</span>, <span style=color:#a6e22e>method</span>, <span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>header</span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 发送请求
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> Promise((<span style=color:#a6e22e>resolve</span>, <span style=color:#a6e22e>reject</span>) =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>request</span>({
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;url&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>url</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;method&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>method</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;data&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>data</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;header&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>header</span>,
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 请求成功时执行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>success</span>(<span style=color:#a6e22e>res</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 响应拦截器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;响应拦截器：&#39;</span>, <span style=color:#a6e22e>res</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 若存在2层data，则直接拆除第1层data
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#a6e22e>res</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;data&#39;</span>][<span style=color:#e6db74>&#39;data&#39;</span>] <span style=color:#f92672>!==</span> <span style=color:#66d9ef>undefined</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;data&#39;</span>] <span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>code</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;code&#39;</span>];
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;data&#39;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 请求成功时返回数据或true
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>code</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>STATUS</span>.<span style=color:#a6e22e>SUCCESS</span>) {
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>data</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>                } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>code</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>STATUS</span>.<span style=color:#a6e22e>FAILED</span>) <span style=color:#a6e22e>reject</span>(<span style=color:#e6db74>&#39;请求失败: &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>data</span>);
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>code</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>STATUS</span>.<span style=color:#a6e22e>VALIDATE_FAILED</span>) <span style=color:#a6e22e>reject</span>(<span style=color:#e6db74>&#39;参数异常: &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>data</span>);
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>code</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>STATUS</span>.<span style=color:#a6e22e>TOKEN_FAILED</span>) <span style=color:#a6e22e>reject</span>(<span style=color:#e6db74>&#39;Token异常！&#39;</span>);
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>code</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>STATUS</span>.<span style=color:#a6e22e>FORBIDDEN</span>) <span style=color:#a6e22e>reject</span>(<span style=color:#e6db74>&#39;权限不足！&#39;</span>);
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 请求失败时执行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>fail</span>(<span style=color:#a6e22e>err</span>) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>reject</span>(<span style=color:#e6db74>&#39;请求异常: &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>err</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 导出封装的request方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>get</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>url</span>, <span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>header</span>) =&gt; <span style=color:#a6e22e>request</span>(<span style=color:#a6e22e>url</span>, <span style=color:#e6db74>&#39;GET&#39;</span>, <span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>header</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>post</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>url</span>, <span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>header</span>) =&gt; <span style=color:#a6e22e>request</span>(<span style=color:#a6e22e>url</span>, <span style=color:#e6db74>&#39;POST&#39;</span>, <span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>header</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>search</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>url</span>, <span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>header</span>) =&gt; <span style=color:#a6e22e>request</span>(<span style=color:#a6e22e>url</span>, <span style=color:#e6db74>&#39;GET&#39;</span>, <span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>header</span>, <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>ES_SERVER</span>),
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h1 id=s02-通用组件开发>S02. 通用组件开发</h1><h2 id=e01-通用选项卡栏>E01. 通用选项卡栏</h2><blockquote><p>武技：开发项目的通用选项卡栏</p></blockquote><h3 id=1-开发三个页面>1. 开发三个页面</h3><ol><li>开发 <code>/pages/index/index</code> 页面。</li><li>开发 <code>/pages/order/order</code> 页面。</li><li>开发 <code>/pages/member/member</code> 页面。</li></ol><h3 id=2-开发选项卡栏>2. 开发选项卡栏</h3><blockquote><p>武技: 开发 <code>/custom-tab-bar/index</code> 组件，目录及组件名称，位置均固定。</p></blockquote><p><code>/custom-tab-bar/index.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;component&#34;</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-tabbar&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/tabbar/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-tabbar-item&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/tabbar-item/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>/custom-tab-bar/index.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;tab-bar&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-tabbar</span> <span style=color:#a6e22e>active</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{activeTab}}&#34;</span> <span style=color:#a6e22e>bind:change</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;changeTab&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-tabbar-item</span> <span style=color:#a6e22e>wx:for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ tabs }}&#34;</span> <span style=color:#a6e22e>wx:key</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;index&#34;</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{item[&#39;icon&#39;]}}&#34;</span>&gt;
</span></span><span style=display:flex><span>            {{ item[&#39;text&#39;] }}
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>van-tabbar-item</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-tabbar</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span></code></pre></div><p><code>/custom-tab-bar/index.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span><span style=color:#75715e>/**无*/</span>
</span></span></code></pre></div><p><code>/custom-tab-bar/index.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../utils/util&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Component</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>activeTab</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>tabs</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>            {<span style=color:#a6e22e>pagePath</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;/pages/index/index&#34;</span>, <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;首页&#34;</span>, <span style=color:#a6e22e>icon</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;home-o&#39;</span>},
</span></span><span style=display:flex><span>            {<span style=color:#a6e22e>pagePath</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;/pages/order/order&#34;</span>, <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;订单&#34;</span>, <span style=color:#a6e22e>icon</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;orders-o&#39;</span>},
</span></span><span style=display:flex><span>            {<span style=color:#a6e22e>pagePath</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;/pages/member/member&#34;</span>, <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;我的&#34;</span>, <span style=color:#a6e22e>icon</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;user-o&#39;</span>}
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>methods</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 切换Tab
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>changeTab</span>(<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tab</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>tabs</span>[<span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>][<span style=color:#e6db74>&#39;pagePath&#39;</span>]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=3-配置选项卡栏>3. 配置选项卡栏</h3><p><code>/app.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;pages&#34;</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;pages/index/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;pages/order/order&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;pages/member/member&#34;</span>
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;tabBar&#34;</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;custom&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;list&#34;</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>      {<span style=color:#e6db74>&#34;pagePath&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;pages/index/index&#34;</span>},
</span></span><span style=display:flex><span>      {<span style=color:#e6db74>&#34;pagePath&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;pages/order/order&#34;</span>},
</span></span><span style=display:flex><span>      {<span style=color:#e6db74>&#34;pagePath&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;pages/member/member&#34;</span>}
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=4-配置切换效果>4. 配置切换效果</h3><blockquote><p>武技: 分别在3个页面的 onLoad 函数中修改 activeTab 变量</p></blockquote><p><code>/pages/index/index.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getTabBar</span>().<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#34;activeTab&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>});
</span></span></code></pre></div><p><code>/pages/order/order.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getTabBar</span>().<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#34;activeTab&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>});
</span></span></code></pre></div><p><code>/pages/member/member.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getTabBar</span>().<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#34;activeTab&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>});
</span></span></code></pre></div><h1 id=s03-首页模块开发>S03. 首页模块开发</h1><blockquote><p>心法: 首页模块路线图</p></blockquote><pre tabindex=0><code class=language-mermaid data-lang=mermaid>flowchart LR

n1[&#34;首页&#34;]
n11[&#34;课程列表&#34;]
n111[&#34;课程详情&#34;]
n112[&#34;购物车&#34;]
n12[&#34;购物车列表&#34;]
n13[&#34;收藏列表&#34;]
n14[&#34;登录&#34;]

n1 --&gt; n11 &amp; n12 &amp; n13 &amp; n14
n11 --点击某个课程--&gt; n111 
	n111 --点击加入购物车--&gt; n112
	n111 --点击购物车列表--&gt; n12 
</code></pre><h2 id=e01-首页模块>E01. 首页模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发首页模块</p></blockquote><h3 id=1-indexjson>1. index.json</h3><p><code>/pages/index/index.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-sticky&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/sticky/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-notice-bar&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/notice-bar/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-image&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/image/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-grid&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/grid/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-grid-item&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/grid-item/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-divider&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/divider/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-collapse&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/collapse/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-collapse-item&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/collapse-item/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-indexwxml>2. index.wxml</h3><p><code>/pages/index/index.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>van-sticky</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;notice-bar&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-notice-bar</span> <span style=color:#a6e22e>left-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;volume-o&#34;</span> <span style=color:#a6e22e>text</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{PROJECT_NOTICE}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>van-sticky</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;project-title&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;title&#34;</span>&gt;{{PROJECT_TITLE}}&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sub-title&#34;</span>&gt;{{PROJECT_SUB_TITLE}}&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;banner-list&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>swiper</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{banners}}&#34;</span> <span style=color:#a6e22e>autoplay</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;3000&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>swiper-item</span> <span style=color:#a6e22e>wx:for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{banners}}&#34;</span> <span style=color:#a6e22e>wx:key</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-image</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;100%&#34;</span> <span style=color:#a6e22e>height</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;150px&#34;</span> <span style=color:#a6e22e>fit</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;fill&#34;</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{MINIO}}/banner/{{item[&#39;url&#39;]}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>swiper-item</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>swiper</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>wx:else</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;no-banner-tip&#34;</span>&gt;暂无轮播图片&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;operation-btn&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-grid</span> <span style=color:#a6e22e>gutter</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;20rpx&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-grid-item</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;video&#34;</span> <span style=color:#a6e22e>text</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;课程列表&#34;</span> <span style=color:#a6e22e>link-type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navigateTo&#34;</span>
</span></span><span style=display:flex><span>                       <span style=color:#a6e22e>url</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/pages/course/course&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-grid-item</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;cart&#34;</span> <span style=color:#a6e22e>text</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;购物车&#34;</span> <span style=color:#a6e22e>link-type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navigateTo&#34;</span>
</span></span><span style=display:flex><span>                       <span style=color:#a6e22e>url</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/pages/cart/cart&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-grid-item</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;star&#34;</span> <span style=color:#a6e22e>text</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;收藏列表&#34;</span> <span style=color:#a6e22e>link-type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navigateTo&#34;</span>
</span></span><span style=display:flex><span>                       <span style=color:#a6e22e>url</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/pages/follow/follow&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-grid-item</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;user&#34;</span> <span style=color:#a6e22e>text</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;登录&#34;</span> <span style=color:#a6e22e>link-type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navigateTo&#34;</span>
</span></span><span style=display:flex><span>                       <span style=color:#a6e22e>url</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/pages/member/login-by-account/login-by-account&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-grid</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;news&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-divider</span> <span style=color:#a6e22e>contentPosition</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;center&#34;</span> <span style=color:#a6e22e>dashed</span>&gt;公告列表&lt;/<span style=color:#f92672>van-divider</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-collapse</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;news-collapse&#34;</span> <span style=color:#a6e22e>accordion</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ activeNewsName }}&#34;</span> <span style=color:#a6e22e>bind:change</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;changeNews&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-collapse-item</span> <span style=color:#a6e22e>wx:for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{NEWS}}&#34;</span> <span style=color:#a6e22e>wx:key</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;name&#34;</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;fire-o&#34;</span>
</span></span><span style=display:flex><span>                           <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{item[&#39;title&#39;]}}&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{item[&#39;name&#39;]}}&#34;</span>&gt;
</span></span><span style=display:flex><span>            {{item[&#39;text&#39;]}}
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>van-collapse-item</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-collapse</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span></code></pre></div><h3 id=3-indexjs>3. index.js</h3><p><code>/pages/index/index.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../../utils/util&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../../utils/api&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PROJECT_TITLE</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>PROJECT_TITLE</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PROJECT_SUB_TITLE</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>PROJECT_SUB_TITLE</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PROJECT_NOTICE</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>PROJECT_NOTICE</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>MINIO</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>MINIO</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>NEWS</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>NEWS</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>banners</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>activeNewsName</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 查询5条轮播图记录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>top5</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/banner/top5&#39;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#a6e22e>banners</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>}))
</span></span><span style=display:flex><span>            .<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;查询失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 切换新闻
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>changeNews</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;activeNewsName&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>top5</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getTabBar</span>().<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#34;activeTab&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-indexcss>4. index.css</h3><p><code>/pages/index/index.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>project-title</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>letter-spacing</span>: <span style=color:#ae81ff>5</span>rpx;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>line-height</span>: <span style=color:#ae81ff>80</span>rpx;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.title</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>45</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>sub-title</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>40</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>orange</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>banner-list</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>400</span>rpx;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>swiper,</span> <span style=color:#960050;background-color:#1e0010>image</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>400</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>no-banner-tip</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>gray</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border</span>: <span style=color:#ae81ff>1</span><span style=color:#66d9ef>px</span> <span style=color:#66d9ef>solid</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>gray</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>400</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>line-height</span>: <span style=color:#ae81ff>400</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>box-sizing</span>: <span style=color:#66d9ef>border-box</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>operation-btn</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>40</span>rpx <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.van-grid-item__content</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border</span>: <span style=color:#ae81ff>1</span>rpx <span style=color:#66d9ef>solid</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>yellow</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>box-sizing</span>: <span style=color:#66d9ef>border-box</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>yellow</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>5</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>van-grid-item__text</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>25</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>news</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>padding-bottom</span>: <span style=color:#ae81ff>200</span>rpx;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.van-cell</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>yellow</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-weight</span>: <span style=color:#66d9ef>bold</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>letter-spacing</span>: <span style=color:#ae81ff>5</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>news-collapse</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>van-collapse-item__content</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>25</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h2 id=e02-课程列表模块>E02. 课程列表模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发课程列表模块</p></blockquote><h3 id=1-coursejson>1. course.json</h3><p><code>/pages/course/course.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-sticky&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/sticky/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-search&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/search/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-divider&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/divider/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-grid&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/grid/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-grid-item&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/grid-item/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-image&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/image/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-icon&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/icon/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-rate&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/rate/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-coursewxml>2. course.wxml</h3><p><code>/pages/course/course.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>van-sticky</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;search-ipt&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-search</span> <span style=color:#a6e22e>background</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#252a34&#34;</span> <span style=color:#a6e22e>shape</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;round&#34;</span> <span style=color:#a6e22e>clear-trigger</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;always&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入课程标题进行搜索&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>input-align</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;center&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{courseTitle}}&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>bind:search</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;searchByTitle&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>bind:clear</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;cancelSearch&#34;</span>/&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>van-sticky</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>scroll-view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;course-list&#34;</span> <span style=color:#a6e22e>scroll-y</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;true&#34;</span> <span style=color:#a6e22e>bindscrolltolower</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;onListEnd&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-divider</span> <span style=color:#a6e22e>contentPosition</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;center&#34;</span> <span style=color:#a6e22e>dashed</span>&gt;课程列表&lt;/<span style=color:#f92672>van-divider</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-grid</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;course-list-grid&#34;</span> <span style=color:#a6e22e>column-num</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;2&#34;</span> <span style=color:#a6e22e>gutter</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;20rpx&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-grid-item</span> <span style=color:#a6e22e>content-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;course-item&#34;</span> <span style=color:#a6e22e>use-slot</span>
</span></span><span style=display:flex><span>                       <span style=color:#a6e22e>wx:for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{courses}}&#34;</span> <span style=color:#a6e22e>wx:key</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id&#34;</span>
</span></span><span style=display:flex><span>                       <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;showDetail&#34;</span> <span style=color:#a6e22e>data-course-id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{item[&#39;id&#39;]}}&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-image</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;300rpx&#34;</span> <span style=color:#a6e22e>height</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;200rpx&#34;</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{MINIO}}/cover/{{item[&#39;cover&#39;]}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;title&#34;</span>&gt;{{ item[&#39;title&#39;] }}&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                    &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;user-o&#34;</span>/&gt;
</span></span><span style=display:flex><span>                    作者： {{item[&#39;nickname&#39;]}}
</span></span><span style=display:flex><span>                &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                    &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;gold-coin-o&#34;</span>/&gt;
</span></span><span style=display:flex><span>                    价格： {{item[&#39;price&#39;]}} 元
</span></span><span style=display:flex><span>                &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                    &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;star-o&#34;</span>/&gt;
</span></span><span style=display:flex><span>                    评分：
</span></span><span style=display:flex><span>                    &lt;<span style=color:#f92672>van-rate</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ item[&#39;star&#39;] }}&#34;</span> <span style=color:#a6e22e>size</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;12px&#34;</span>/&gt;
</span></span><span style=display:flex><span>                &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>van-grid-item</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-grid</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-divider</span> <span style=color:#a6e22e>contentPosition</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;center&#34;</span> <span style=color:#a6e22e>dashed</span>&gt;没有更多课程了&lt;/<span style=color:#f92672>van-divider</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>scroll-view</span>&gt;
</span></span></code></pre></div><h3 id=3-coursejs>3. course.js</h3><p><code>/pages/course/course.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../../utils/util&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../utils/api&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>MINIO</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>MINIO</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>pageInfo</span><span style=color:#f92672>:</span> {<span style=color:#a6e22e>pageNumber</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>pageSize</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>6</span>, <span style=color:#a6e22e>totalPage</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>totalRow</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>},
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>courses</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>courseTitle</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 分页搜索课程记录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>page</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>courseTitle</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>courseTitle</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;pageNumber&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pageSize</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;pageSize&#39;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 请求数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>search</span>(<span style=color:#e6db74>&#39;/course/searchByTitle&#39;</span>, {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;pageNumber&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pageNumber</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;pageSize&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pageSize</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;title&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>courseTitle</span>.<span style=color:#a6e22e>trim</span>()
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;courses&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;records&#39;</span>] <span style=color:#f92672>:</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>courses</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;records&#39;</span>]),
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;pageInfo.pageNumber&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;pageNumber&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;pageInfo.pageSize&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;pageSize&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;pageInfo.totalPage&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;totalPage&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;pageInfo.totalRow&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;totalRow&#39;</span>],
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;课程查询失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 列表触底时
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onListEnd</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;pageNumber&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>totalPage</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;totalPage&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>totalPage</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;pageInfo.pageNumber&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>});
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>page</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 按课程标题搜索课程
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>searchByTitle</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;courseTitle&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;pageInfo.pageNumber&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>page</span>();
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 取消搜索
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>cancelSearch</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;courseTitle&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;JB&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;pageInfo.pageNumber&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>page</span>();
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 查看课程详情
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>showDetail</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>courseId</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>currentTarget</span>.<span style=color:#a6e22e>dataset</span>[<span style=color:#e6db74>&#39;courseId&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>page</span>(<span style=color:#e6db74>&#39;/pages/course/detail/detail?courseId=&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>courseId</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>page</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-coursescss>4. course.scss</h3><p><code>/pages/course/course.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>course-list</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>90</span><span style=color:#66d9ef>vh</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.course-item</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>.title</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>font-weight</span>: <span style=color:#66d9ef>bold</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>white-space</span>: <span style=color:#66d9ef>nowrap</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>overflow</span>: <span style=color:#66d9ef>hidden</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>text-overflow</span>: <span style=color:#66d9ef>ellipsis</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>yellow</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>margin-top</span>: <span style=color:#ae81ff>10</span>rpx;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>margin-left</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>margin-bottom</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>100</span><span style=color:#66d9ef>%</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>info</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>small</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>line-height</span>: <span style=color:#ae81ff>40</span>rpx;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>100</span><span style=color:#66d9ef>%</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>margin-left</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h2 id=e03-课程详情模块>E03. 课程详情模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发课程详情模块</p></blockquote><h3 id=1-detailjson>1. detail.json</h3><p><code>/pages/course/detail/detail.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-sticky&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/sticky/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-divider&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/divider/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-cell-group&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/cell-group/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-cell&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/cell/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-tabs&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/tabs/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-tab&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/tab/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-rate&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/rate/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-image&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/image/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-goods-action&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/goods-action/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-goods-action-icon&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/goods-action-icon/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-goods-action-button&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/goods-action-button/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-detailwxml>2. detail.wxml</h3><p><code>/pages/course/detail/detail.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>van-sticky</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;free-video&#34;</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{videoSrc &amp;&amp; videoPoster}}&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>video</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{videoSrc}}&#34;</span> <span style=color:#a6e22e>controls</span> <span style=color:#a6e22e>show-mute-btn</span> <span style=color:#a6e22e>enable-danmu</span> <span style=color:#a6e22e>danmu-btn</span>
</span></span><span style=display:flex><span>           <span style=color:#a6e22e>poster</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{videoPoster}}&#34;</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{videoTitle}}&#34;</span> <span style=color:#a6e22e>danmu-list</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{welcomeBarrage}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>van-sticky</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;course-info&#34;</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course}}&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-divider</span> <span style=color:#a6e22e>contentPosition</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;center&#34;</span> <span style=color:#a6e22e>dashed</span>&gt;课程详情&lt;/<span style=color:#f92672>van-divider</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-cell-group</span> <span style=color:#a6e22e>inset</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;notes-o&#34;</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;课程标题&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course[&#39;title&#39;]}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;star-o&#34;</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;课程评分&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-rate</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course[&#39;star&#39;]}}&#34;</span> <span style=color:#a6e22e>readonly</span>/&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>van-cell</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;user-o&#34;</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;课程作者&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course[&#39;member&#39;][&#39;nickname&#39;]}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;clock-o&#34;</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;创建日期&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course[&#39;created&#39;]}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;clock-o&#34;</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;更新日期&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course[&#39;updated&#39;]}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;cash-o&#34;</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;课程价格&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course[&#39;price&#39;] + &#39; 元&#39;}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;font-o&#34;</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;课程简介&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course[&#39;info&#39;]}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-cell-group</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;operation-tabs&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-tabs</span> <span style=color:#a6e22e>active</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{activeTab}}&#34;</span> <span style=color:#a6e22e>color</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;orange&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;card&#34;</span> <span style=color:#a6e22e>animated</span> <span style=color:#a6e22e>tab-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;tab&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-tab</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;课程摘要&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;摘要&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;summary&#34;</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course[&#39;summary&#39;]}}&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>van-image</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;100%&#34;</span> <span style=color:#a6e22e>fit</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;widthFix&#34;</span>
</span></span><span style=display:flex><span>                           <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{MINIO}}/summary/{{course[&#39;summary&#39;]}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>wx:else</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;no-summary-tip&#34;</span>&gt;暂无摘要图片&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-divider</span> <span style=color:#a6e22e>contentPosition</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;center&#34;</span> <span style=color:#a6e22e>dashed</span>&gt;没有更多内容了&lt;/<span style=color:#f92672>van-divider</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;height: 200rpx&#34;</span>&gt;&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>van-tab</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-tab</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;课程目录&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;目录&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;catalog&#34;</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course[&#39;seasons&#39;].length &gt; 0}}&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>wx:for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course[&#39;seasons&#39;]}}&#34;</span> <span style=color:#a6e22e>wx:key</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id&#34;</span> <span style=color:#a6e22e>wx:for-item</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;season&#34;</span> <span style=color:#a6e22e>wx:for-index</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;si&#34;</span>&gt;
</span></span><span style=display:flex><span>                    &lt;<span style=color:#f92672>van-cell-group</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{&#39;第&#39; + (si + 1) + &#39;季：&#39; + season[&#39;title&#39;]}}&#34;</span>&gt;
</span></span><span style=display:flex><span>                        &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{season[&#39;episodes&#39;].length &gt; 0}}&#34;</span>&gt;
</span></span><span style=display:flex><span>                            &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>wx:for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{season[&#39;episodes&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                                      <span style=color:#a6e22e>wx:key</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id&#34;</span> <span style=color:#a6e22e>wx:for-item</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;episode&#34;</span> <span style=color:#a6e22e>wx:for-index</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ei&#34;</span>
</span></span><span style=display:flex><span>                                      <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{&#39;第&#39; + (ei + 1) + &#39;集：&#39; + episode[&#39;title&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                                      <span style=color:#a6e22e>use-label-slot</span>&gt;
</span></span><span style=display:flex><span>                                &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>slot</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;label&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;van-multi-ellipsis--l2&#34;</span>&gt;
</span></span><span style=display:flex><span>                                    {{episode[&#39;info&#39;]}}
</span></span><span style=display:flex><span>                                &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                            &lt;/<span style=color:#f92672>van-cell</span>&gt;
</span></span><span style=display:flex><span>                        &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                    &lt;/<span style=color:#f92672>van-cell-group</span>&gt;
</span></span><span style=display:flex><span>                &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>van-divider</span> <span style=color:#a6e22e>contentPosition</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;center&#34;</span> <span style=color:#a6e22e>dashed</span>&gt;没有更多内容了&lt;/<span style=color:#f92672>van-divider</span>&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>wx:else</span>&gt;
</span></span><span style=display:flex><span>                该课程暂无章集信息，请联系运维人员
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>van-tab</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-tabs</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;detail-foot&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-goods-action</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-goods-action-icon</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;chat-o&#34;</span> <span style=color:#a6e22e>text</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;客服&#34;</span> <span style=color:#a6e22e>bind:click</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;chatMe&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-goods-action-icon</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;cart-o&#34;</span> <span style=color:#a6e22e>text</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;购物车&#34;</span> <span style=color:#a6e22e>bind:click</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;toCart&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-goods-action-button</span> <span style=color:#a6e22e>text</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;加入购物车&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;warning&#34;</span> <span style=color:#a6e22e>bind:click</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;addToCart&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-goods-action-button</span> <span style=color:#a6e22e>text</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;立即购买&#34;</span> <span style=color:#a6e22e>bind:click</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pay&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-goods-action</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span></code></pre></div><h3 id=3-detailjs>3. detail.js</h3><p><code>/pages/course/detail/detail.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../../../utils/api&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../../../utils/util&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>MINIO</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>MINIO</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>course</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>videoSrc</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>videoPoster</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>videoTitle</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>welcomeBarrage</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>            {<span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;一大波弹幕即将来袭&#39;</span>, <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#ff0000&#39;</span>, <span style=color:#a6e22e>time</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>}
</span></span><span style=display:flex><span>        ],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>activeTab</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;摘要&#39;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 查询视频详情
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>getCourseInfo</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>courseId</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/course/getInfo/&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>courseId</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>firstEpisode</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;seasons&#39;</span>][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#39;episodes&#39;</span>][<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;created&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>dateFormat</span>(<span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;created&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;updated&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>dateFormat</span>(<span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;updated&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;course&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;videoSrc&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>MINIO</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;/video/&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>firstEpisode</span>[<span style=color:#e6db74>&#39;video&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;videoPoster&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>MINIO</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;/videoCover/&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>firstEpisode</span>[<span style=color:#e6db74>&#39;cover&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;videoTitle&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>firstEpisode</span>[<span style=color:#e6db74>&#39;title&#39;</span>],
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;视频查询失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 跳转到购物车页面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>toCart</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>page</span>(<span style=color:#e6db74>&#39;/pages/cart/cart&#39;</span>);
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 添加购物车
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>addToCart</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;cart/save&#39;</span>, {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;fkCourseId&#34;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>course</span>[<span style=color:#e6db74>&#39;id&#39;</span>]
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>page</span>(<span style=color:#e6db74>&#39;/pages/cart/cart&#39;</span>);
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;无需重复添加&#39;</span>, <span style=color:#a6e22e>err</span>))
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 客服
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>chatMe</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;功能暂未开放&#39;</span>);
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 立即购买
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>pay</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;功能暂未开放&#39;</span>);
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 查询视频详情：获取路径传递过来的值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getCourseInfo</span>(<span style=color:#a6e22e>ev</span>[<span style=color:#e6db74>&#39;courseId&#39;</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-detailscss>4. detail.scss</h3><p><code>/pages/course/detail/detail.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>free-video</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>video</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>98</span><span style=color:#66d9ef>%</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>outline</span>: <span style=color:#ae81ff>10</span>rpx <span style=color:#66d9ef>solid</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>box-sizing</span>: <span style=color:#66d9ef>border-box</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>course-info</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.van-cell</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>yellow</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>.van-cell__title</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>van-cell__value</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>operation-tabs</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>80</span><span style=color:#66d9ef>vh</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>20</span>rpx <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.van-tab</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span> <span style=color:#75715e>!important</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-weight</span>: <span style=color:#66d9ef>bold</span> <span style=color:#75715e>!important</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>no-summary-tip</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>gray</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>800</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>line-height</span>: <span style=color:#ae81ff>800</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>summary</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>padding-top</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>catalog</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>padding-top</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>padding-bottom</span>: <span style=color:#ae81ff>150</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>.van-cell-group__title</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>font-weight</span>: <span style=color:#66d9ef>bold</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>background</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>yellow</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>padding-bottom</span>: <span style=color:#ae81ff>15</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>van-cell</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>background</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span> <span style=color:#75715e>!important</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h2 id=e04-购物车模块>E04. 购物车模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发购物车模块</p></blockquote><h3 id=1-cartjson>1. cart.json</h3><p><code>/pages/cart/cart.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-search&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/search/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-divider&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/divider/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-swipe-cell&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/swipe-cell/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-button&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/button/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-card&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/card/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-icon&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/icon/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-submit-bar&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/submit-bar/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-action-sheet&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/action-sheet/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-count-down&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/count-down/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-dialog&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/dialog/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-tag&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/tag/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-cell-group&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/cell-group/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-cell&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/cell/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-radio-group&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/radio-group/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-radio&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/radio/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-field&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/field/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-cartwxml>2. cart.wxml</h3><p><code>/pages/cart/cart.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>van-dialog</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;van-dialog&#34;</span>/&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;search-coupons&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-search</span> <span style=color:#a6e22e>background</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#252a34&#34;</span> <span style=color:#a6e22e>shape</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;round&#34;</span> <span style=color:#a6e22e>clear-trigger</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;always&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入口令兑换优惠卷&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>input-align</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;center&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{couponsCode}}&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>bind:search</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;getCoupons&#34;</span>/&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>scroll-view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;cart-list&#34;</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{carts &amp;&amp; carts.length &gt; 0}}&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#a6e22e>scroll-y</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;true&#34;</span> <span style=color:#a6e22e>bindscrolltolower</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pageMore&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-divider</span> <span style=color:#a6e22e>contentPosition</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;right&#34;</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;clearCart&#34;</span> <span style=color:#a6e22e>dashed</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;delete-o&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>text</span>&gt;清空购物车&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-divider</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-swipe-cell</span> <span style=color:#a6e22e>wx:for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{carts}}&#34;</span> <span style=color:#a6e22e>wx:key</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id&#34;</span> <span style=color:#a6e22e>right-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ 55 }}&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-card</span> <span style=color:#a6e22e>tag</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;热卖&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>price</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{item[&#39;course&#39;][&#39;price&#39;]}} 元&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>origin-price</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{item[&#39;course&#39;][&#39;price&#39;] / 0.8}} 元&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{item[&#39;course&#39;][&#39;title&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>desc</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{item[&#39;course&#39;][&#39;info&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>thumb</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{MINIO}}/cover/{{item[&#39;course&#39;][&#39;cover&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>thumb-mode</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;scaleToFill&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;showDetail&#34;</span> <span style=color:#a6e22e>data-course-id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{item[&#39;course&#39;][&#39;id&#39;]}}&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>van-card</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>slot</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;right&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;right_slot&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;danger&#34;</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;removeCart&#34;</span> <span style=color:#a6e22e>data-id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{item[&#39;id&#39;]}}&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>view</span>&gt;移&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>view</span>&gt;除&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-swipe-cell</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>scroll-view</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;cart-list&#34;</span> <span style=color:#a6e22e>wx:else</span>&gt;
</span></span><span style=display:flex><span>    暂无购物车记录
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit-bar&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-submit-bar</span> <span style=color:#a6e22e>price</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ payAmount * 100 }}&#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>button-text</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;提交订单&#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>bind:submit</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;openPayDialog&#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>tip</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ true }}&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-tag</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;warning&#34;</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;openCouponsSheet&#34;</span>&gt;优惠卷详情&lt;/<span style=color:#f92672>van-tag</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>slot</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;tip&#34;</span>&gt;课程属于虚拟产品，购买后不支持退换！&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-submit-bar</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>van-action-sheet</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;coupons-sheet&#34;</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;优惠卷详情&#34;</span> <span style=color:#a6e22e>show</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ couponsShow }}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>bind:close</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;closeCouponsSheet&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-cell-group</span> <span style=color:#a6e22e>inset</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{coupons[&#39;id&#39;]}}&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;gift-o&#34;</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;兑换口令&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{coupons[&#39;code&#39;]}}&#34;</span> <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;100rpx&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;notes-o&#34;</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;标题名称&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{coupons[&#39;name&#39;]}}&#34;</span> <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;100rpx&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;question-o&#34;</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;生效条件&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{coupons[&#39;condition&#39;]}}&#34;</span> <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;100rpx&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;coupon-o&#34;</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;满减信息&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{coupons[&#39;value&#39;] + coupons[&#39;unitDesc&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;100rpx&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;comment-o&#34;</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;详情描述&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{coupons[&#39;description&#39;]}}&#34;</span> <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;100rpx&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;clock-o&#34;</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;生效时间&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{coupons[&#39;startAt&#39;]}}&#34;</span> <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;100rpx&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;clock-o&#34;</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;过期时间&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{coupons[&#39;endAt&#39;]}}&#34;</span> <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;100rpx&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-cell-group</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>wx:else</span>&gt;暂未使用优惠卷&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>van-action-sheet</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>van-dialog</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pay-dialog&#34;</span> <span style=color:#a6e22e>use-slot</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;支付订单&#34;</span> <span style=color:#a6e22e>show</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ payDialogShow }}&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>show-cancel-button</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;400px&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>bind:confirm</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;confirmPay&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-divider</span> <span style=color:#a6e22e>dashed</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;countdown-time&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-count-down</span> <span style=color:#a6e22e>use-slot</span> <span style=color:#a6e22e>time</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ time }}&#34;</span> <span style=color:#a6e22e>bind:change</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;countDown&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>text</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;title&#34;</span>&gt;支付倒计时：&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>text</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;item&#34;</span>&gt;{{ timeData.hours }}&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>text</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;delimiter&#34;</span>&gt;时 &lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>text</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;item&#34;</span>&gt;{{ timeData.minutes }}&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>text</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;delimiter&#34;</span>&gt;分 &lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>text</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;item&#34;</span>&gt;{{ timeData.seconds }}&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>text</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;delimiter&#34;</span>&gt;秒 &lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>van-count-down</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-divider</span> <span style=color:#a6e22e>dashed</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pay-dialog-label&#34;</span>&gt;支付方式&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-radio-group</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ payType }}&#34;</span> <span style=color:#a6e22e>bind:change</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;changePayType&#34;</span> <span style=color:#a6e22e>direction</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;horizontal&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-radio</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{1}}&#34;</span>&gt;支付宝&lt;/<span style=color:#f92672>van-radio</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-radio</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{2}}&#34;</span>&gt;微信&lt;/<span style=color:#f92672>van-radio</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-radio</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{3}}&#34;</span>&gt;其他方式&lt;/<span style=color:#f92672>van-radio</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-radio-group</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pay-dialog-label&#34;</span>&gt;支付密码&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-cell-group</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ payPassword }}&#34;</span> <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入支付密码&#34;</span>
</span></span><span style=display:flex><span>                   <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;password&#34;</span>
</span></span><span style=display:flex><span>                   <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;question-o&#34;</span>
</span></span><span style=display:flex><span>                   <span style=color:#a6e22e>bind:change</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;changePayPassword&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-cell-group</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pay-dialog-label&#34;</span>&gt;订单备注&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-cell-group</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pay-info&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ payInfo }}&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;textarea&#34;</span>
</span></span><span style=display:flex><span>                   <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入订单备注&#34;</span> <span style=color:#a6e22e>autosize</span>
</span></span><span style=display:flex><span>                   <span style=color:#a6e22e>bind:change</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;changePayInfo&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-cell-group</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>van-dialog</span>&gt;
</span></span></code></pre></div><h3 id=3-cartjs>3. cart.js</h3><p><code>/pages/cart/cart.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../utils/util&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../utils/api&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>MINIO</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>MINIO</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>pageInfo</span><span style=color:#f92672>:</span> {<span style=color:#a6e22e>pageNumber</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>pageSize</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>8</span>, <span style=color:#a6e22e>totalPage</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>totalRow</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>},
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>carts</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>totalAmount</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.0</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>payAmount</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.0</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>coupons</span><span style=color:#f92672>:</span> {},
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>couponsCode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>couponsShow</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>payDialogShow</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>payType</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>payPassword</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;123456&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>payInfo</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>time</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>30</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>60</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1000</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>timeData</span><span style=color:#f92672>:</span> {},
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 分页查询购物车记录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>page</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;pageNumber&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pageSize</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;pageSize&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/cart/page&#39;</span>, {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;pageNumber&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pageNumber</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;pageSize&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pageSize</span>
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;carts&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;records&#39;</span>] <span style=color:#f92672>:</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>carts</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;records&#39;</span>]),
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;pageInfo.pageNumber&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;pageNumber&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;pageInfo.pageSize&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;pageSize&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;pageInfo.totalPage&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;totalPage&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;pageInfo.totalRow&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;totalRow&#39;</span>],
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;查询异常&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 计算总金额
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>getTotalAmount</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>`/cart/totalAmount`</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;totalAmount&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;payAmount&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;总金额查询失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 列表触底时追查下一页数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>pageMore</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;pageNumber&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>totalPage</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;totalPage&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>totalPage</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;pageInfo.pageNumber&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;pageNumber&#39;</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>});
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>page</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 兑换优惠卷
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>getCoupons</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>code</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>carts</span> <span style=color:#f92672>||</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>carts</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;购物车记录为空&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>code</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/coupons/getByCode/&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>code</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;endAt&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>dateFormat</span>(<span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;endAt&#39;</span>]);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;startAt&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>dateFormat</span>(<span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;startAt&#39;</span>]);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;created&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>dateFormat</span>(<span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;created&#39;</span>]);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;updated&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>dateFormat</span>(<span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;updated&#39;</span>]);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;couponsCode&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;coupons&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;payAmount&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>totalAmount</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;value&#39;</span>],
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;couponsShow&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>                });
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;优惠卷已生效&#39;</span>);
</span></span><span style=display:flex><span>            }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;优惠卷无效&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 打开优惠卷面板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>openCouponsSheet</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;couponsShow&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 关闭优惠卷面板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>closeCouponsSheet</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;couponsShow&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 删除购物车记录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>removeCart</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>id</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>currentTarget</span>.<span style=color:#a6e22e>dataset</span>[<span style=color:#e6db74>&#39;id&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>confirm</span>(<span style=color:#e6db74>&#39;选中的课程将被移出购物车，确定吗？&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>`/cart/remove/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>id</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;购物车删除成功&#39;</span>);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;carts&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>});
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>page</span>();
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getTotalAmount</span>();
</span></span><span style=display:flex><span>            }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;购物车删除失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 清空购物车记录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>clearCart</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>confirm</span>(<span style=color:#e6db74>&#39;清空购物车中的全部课程，确定吗？&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>`/cart/clear`</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;购物车清空成功&#39;</span>);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;carts&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;totalAmount&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;payAmount&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;coupons&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>                });
</span></span><span style=display:flex><span>            }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;购物车清空失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 打开支付对话框
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>openPayDialog</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>carts</span> <span style=color:#f92672>||</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>carts</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;购物车记录为空&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;payDialogShow&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 切换支付方式时触发
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>changePayType</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;payType&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>})
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 输入支付密码时触发
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>changePayPassword</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;payPassword&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>})
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 输入支付备注信息时触发
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>changePayInfo</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;payInfo&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>})
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 确认支付
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>confirmPay</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>carts</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>carts</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 若购物车为空，则不进行支付动作
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>carts</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>carts</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 课程ID数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>courseIds</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cartIds</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 赋值课程ID数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>carts</span>.<span style=color:#a6e22e>forEach</span>(<span style=color:#a6e22e>cart</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>courseIds</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>cart</span>[<span style=color:#e6db74>&#39;fkCourseId&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>cartIds</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>cart</span>[<span style=color:#e6db74>&#39;id&#39;</span>]);
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 判断支付密码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>payPassword</span> <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;123456&#39;</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;支付密码有误&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 添加订单
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/order/save&#39;</span>, {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;courseIds&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>courseIds</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;totalAmount&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>totalAmount</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;payAmount&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>payAmount</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;payType&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>payType</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;info&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>payInfo</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;暂无订单描述&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;fkCouponsId&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>coupons</span>[<span style=color:#e6db74>&#39;id&#39;</span>] <span style=color:#f92672>?</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>coupons</span>[<span style=color:#e6db74>&#39;id&#39;</span>] <span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 删除购物车记录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/cart/removeBatch?ids=&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>cartIds</span>.<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#39;,&#39;</span>)).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tab</span>(<span style=color:#e6db74>&#39;/pages/order/order&#39;</span>);
</span></span><span style=display:flex><span>            }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;购物车删除失败&#39;</span>, <span style=color:#a6e22e>err</span>))
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;订单添加失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 倒计时
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>countDown</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;timeData&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 查看课程详情
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>showDetail</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>courseId</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>currentTarget</span>.<span style=color:#a6e22e>dataset</span>[<span style=color:#e6db74>&#39;courseId&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>page</span>(<span style=color:#e6db74>&#39;/pages/course/detail/detail?courseId=&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>courseId</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>isLogin</span>()){
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>page</span>();
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getTotalAmount</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-cartscss>4. cart.scss</h3><p><code>/pages/cart/cart.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>cart-list</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>75</span><span style=color:#66d9ef>vh</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.van-swipe-cell</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>10</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>.van-card</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>yellow</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>background</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#960050;background-color:#1e0010>.van-card__thumb</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>230</span>rpx;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>van-card__content</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>padding-left</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>van-card__title</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>margin-bottom</span>: <span style=color:#ae81ff>10</span>rpx;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>van-card__price</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>orange</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>right_slot</span><span style=color:#f92672>,</span> .<span style=color:#a6e22e>van-button</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>100</span><span style=color:#66d9ef>%</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>line-height</span>: <span style=color:#ae81ff>50</span>rpx;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>pay-dialog</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.van-popup</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span> <span style=color:#75715e>!important</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border</span>: <span style=color:#ae81ff>10</span>rpx <span style=color:#66d9ef>solid</span> <span style=color:#960050;background-color:#1e0010>$</span>bg-gray <span style=color:#75715e>!important</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>van-radio__label</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span> <span style=color:#75715e>!important</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>countdown-time</span> {
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>.title,</span> <span style=color:#960050;background-color:#1e0010>.delimiter</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>yellow</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>item</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>display</span>: <span style=color:#66d9ef>inline-block</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>60</span>rpx;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>margin-right</span>: <span style=color:#ae81ff>5</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>font-weight</span>: <span style=color:#66d9ef>bold</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>center</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>yellow</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>5</span>rpx;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>pay-dialog-label</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>orange</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>40</span>rpx <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>pay-info</span> {
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>.van-field__control</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>100</span><span style=color:#66d9ef>px</span> <span style=color:#75715e>!important</span>;;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>van-dialog__button</span>:<span style=color:#a6e22e>first-child</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin-top</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin-right</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>van-dialog__button</span>:<span style=color:#a6e22e>last-child</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin-top</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin-left</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h2 id=e05-课程收藏模块>E05. 课程收藏模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发课程收藏模块</p></blockquote><h3 id=1-followjson>1. follow.json</h3><p><code>/pages/follow/follow.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-swipe-cell&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/swipe-cell/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-button&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/button/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-card&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/card/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-followwxml>2. follow.wxml</h3><p><code>/pages/follow/follow.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>scroll-view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;follow-list&#34;</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{follows &amp;&amp; follows.length &gt; 0}}&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#a6e22e>scroll-y</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;true&#34;</span> <span style=color:#a6e22e>bindscrolltolower</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pageMore&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-swipe-cell</span> <span style=color:#a6e22e>wx:for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{follows}}&#34;</span> <span style=color:#a6e22e>wx:key</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id&#34;</span> <span style=color:#a6e22e>right-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ 55 }}&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-card</span> <span style=color:#a6e22e>tag</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;热卖&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>price</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{item[&#39;price&#39;]}} 元&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>origin-price</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{item[&#39;price&#39;] / 0.8}} 元&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{item[&#39;title&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>desc</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{item[&#39;info&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>thumb</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{MINIO}}/cover/{{item[&#39;cover&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>thumb-mode</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;scaleToFill&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;showDetail&#34;</span> <span style=color:#a6e22e>data-course-id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{item[&#39;id&#39;]}}&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>van-card</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>slot</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;right&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;right_slot&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;danger&#34;</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;unfollow&#34;</span> <span style=color:#a6e22e>data-id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{item[&#39;id&#39;]}}&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>view</span>&gt;移&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>view</span>&gt;除&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-swipe-cell</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>scroll-view</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;follow-list&#34;</span> <span style=color:#a6e22e>wx:else</span>&gt;
</span></span><span style=display:flex><span>    暂无收藏记录
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span></code></pre></div><h3 id=3-followjs>3. follow.js</h3><p><code>/pages/follow/follow.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../utils/util&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../utils/api&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>MINIO</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>MINIO</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>pageInfo</span><span style=color:#f92672>:</span> {<span style=color:#a6e22e>pageNumber</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>pageSize</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>8</span>, <span style=color:#a6e22e>totalPage</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>totalRow</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>},
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>follows</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 分页查询收藏记录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>page</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;pageNumber&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pageSize</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;pageSize&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/member/pageFollowCourse&#39;</span>, {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;pageNumber&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pageNumber</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;pageSize&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pageSize</span>
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;follows&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;records&#39;</span>] <span style=color:#f92672>:</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>carts</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;records&#39;</span>]),
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;pageInfo.pageNumber&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;pageNumber&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;pageInfo.pageSize&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;pageSize&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;pageInfo.totalPage&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;totalPage&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;pageInfo.totalRow&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;totalRow&#39;</span>],
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;查询异常&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 列表触底时追查下一页数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>pageMore</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;pageNumber&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>totalPage</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;totalPage&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>totalPage</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;pageInfo.pageNumber&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;pageNumber&#39;</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>});
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>page</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 取消收藏课程
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>unfollow</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>id</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>currentTarget</span>.<span style=color:#a6e22e>dataset</span>[<span style=color:#e6db74>&#39;id&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>confirm</span>(<span style=color:#e6db74>&#39;选中的课程将被取消收藏，确定吗？&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>`/member/unfollowCourse/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>id</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;取消收藏成功&#39;</span>);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>page</span>();
</span></span><span style=display:flex><span>            }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;取消收藏失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 查看课程详情
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>showDetail</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>courseId</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>currentTarget</span>.<span style=color:#a6e22e>dataset</span>[<span style=color:#e6db74>&#39;courseId&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>page</span>(<span style=color:#e6db74>&#39;/pages/course/detail/detail?courseId=&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>courseId</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>isLogin</span>()){
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>page</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-followscss>4. follow.scss</h3><p><code>/pages/follow/follow.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>follow-list</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>75</span><span style=color:#66d9ef>vh</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.van-swipe-cell</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>10</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>.van-card</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>yellow</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>background</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#960050;background-color:#1e0010>.van-card__thumb</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>230</span>rpx;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>van-card__content</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>padding-left</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>van-card__title</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>margin-bottom</span>: <span style=color:#ae81ff>10</span>rpx;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>van-card__price</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>orange</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>right_slot</span><span style=color:#f92672>,</span> .<span style=color:#a6e22e>van-button</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>100</span><span style=color:#66d9ef>%</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>line-height</span>: <span style=color:#ae81ff>50</span>rpx;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h1 id=s04-订单模块开发>S04. 订单模块开发</h1><blockquote><p>心法: 订单模块路线图</p></blockquote><pre tabindex=0><code class=language-mermaid data-lang=mermaid>flowchart LR

n1[&#34;订单列表&#34;]
n11[&#34;学习课程&#34;]

n1 --立即学习--&gt; n11
</code></pre><h2 id=e01-订单模块>E01. 订单模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发订单模块</p></blockquote><h3 id=1-orderjson>1. order.json</h3><p><code>/pages/order/order.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-divider&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/divider/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-row&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/row/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-col&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/col/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-icon&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/icon/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-tag&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/tag/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-swipe-cell&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/swipe-cell/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-card&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/card/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-button&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/button/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-orderwxml>2. order.wxml</h3><p><code>/pages/order/order.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>scroll-view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;order-list&#34;</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{orders &amp;&amp; orders.length &gt; 0}}&#34;</span> <span style=color:#a6e22e>scroll-y</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;true&#34;</span> <span style=color:#a6e22e>bindscrolltolower</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pageMore&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;order-item&#34;</span> <span style=color:#a6e22e>wx:for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{orders}}&#34;</span> <span style=color:#a6e22e>wx:for-item</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;order&#34;</span> <span style=color:#a6e22e>wx:key</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-divider</span> <span style=color:#a6e22e>contentPosition</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;left&#34;</span> <span style=color:#a6e22e>dashed</span>&gt;订单号：{{order[&#39;sn&#39;]}}&lt;/<span style=color:#f92672>van-divider</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-row</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;title&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-col</span> <span style=color:#a6e22e>span</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;18&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;left&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;shop-collect-o&#34;</span>/&gt;
</span></span><span style=display:flex><span>                李氏云课堂官方商城
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>van-tag</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;danger&#34;</span>&gt;直播&lt;/<span style=color:#f92672>van-tag</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;arrow&#34;</span>/&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>van-col</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-col</span> <span style=color:#a6e22e>span</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;6&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;right&#34;</span>&gt;已支付&lt;/<span style=color:#f92672>van-col</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>van-row</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-swipe-cell</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;body&#34;</span> <span style=color:#a6e22e>wx:for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{order[&#39;courses&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>wx:for-item</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;course&#34;</span> <span style=color:#a6e22e>wx:key</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-card</span> <span style=color:#a6e22e>price</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course[&#39;price&#39;]}} 元&#34;</span>
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>origin-price</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course[&#39;price&#39;] / 0.8}} 元&#34;</span>
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course[&#39;title&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>desc</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course[&#39;info&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>thumb</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{MINIO}}/cover/{{course[&#39;cover&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>thumb-mode</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;scaleToFill&#34;</span>
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>num</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>van-card</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-row</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;foot&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pay-amount&#34;</span>&gt;实付款: ￥{{order[&#39;payAmount&#39;]}}&lt;<span style=color:#f92672>text</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;small&#34;</span>&gt;.00&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>                &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>van-col</span> <span style=color:#a6e22e>span</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;10&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;left&#34;</span>&gt;更多&lt;/<span style=color:#f92672>van-col</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>van-col</span> <span style=color:#a6e22e>span</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;7&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;right&#34;</span>&gt;
</span></span><span style=display:flex><span>                    &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span>
</span></span><span style=display:flex><span>                                <span style=color:#a6e22e>plain</span>
</span></span><span style=display:flex><span>                                <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;playVideo&#34;</span>
</span></span><span style=display:flex><span>                                <span style=color:#a6e22e>data-course-id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course[&#39;id&#39;]}}&#34;</span>&gt;
</span></span><span style=display:flex><span>                        立即学习
</span></span><span style=display:flex><span>                    &lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>                &lt;/<span style=color:#f92672>van-col</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>van-col</span> <span style=color:#a6e22e>span</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;7&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;right&#34;</span>&gt;
</span></span><span style=display:flex><span>                    &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;remove-order-btn&#34;</span> <span style=color:#a6e22e>plain</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;danger&#34;</span>
</span></span><span style=display:flex><span>                                <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;removeOrder&#34;</span> <span style=color:#a6e22e>data-id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{order[&#39;id&#39;]}}&#34;</span>&gt;
</span></span><span style=display:flex><span>                        删除订单
</span></span><span style=display:flex><span>                    &lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>                &lt;/<span style=color:#f92672>van-col</span>&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>van-row</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>van-swipe-cell</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-divider</span> <span style=color:#a6e22e>contentPosition</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;center&#34;</span> <span style=color:#a6e22e>dashed</span>&gt;没有更多内容了&lt;/<span style=color:#f92672>van-divider</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;height: 200rpx&#34;</span>&gt;&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>scroll-view</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;order-list&#34;</span> <span style=color:#a6e22e>wx:else</span>&gt;暂无订单记录&lt;/<span style=color:#f92672>view</span>&gt;
</span></span></code></pre></div><h3 id=3-orderjs>3. order.js</h3><p><code>/pages/order/order.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../utils/util&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../utils/api&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>MINIO</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>MINIO</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>pageInfo</span><span style=color:#f92672>:</span> {<span style=color:#a6e22e>pageNumber</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>pageSize</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>, <span style=color:#a6e22e>totalPage</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>totalRow</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>},
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>orders</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 分页查询订单记录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>page</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;pageNumber&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pageSize</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;pageSize&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/order/page&#39;</span>, {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;pageNumber&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pageNumber</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;pageSize&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pageSize</span>
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;orders&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;records&#39;</span>] <span style=color:#f92672>:</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>orders</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;records&#39;</span>]),
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;pageInfo.pageNumber&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;pageNumber&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;pageInfo.pageSize&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;pageSize&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;pageInfo.totalPage&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;totalPage&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;pageInfo.totalRow&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;totalRow&#39;</span>],
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;订单查询失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 列表触底时追查下一页记录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>pageMore</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;pageNumber&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>totalPage</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;totalPage&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>pageNumber</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>totalPage</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;pageInfo.pageNumber&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>pageInfo</span>[<span style=color:#e6db74>&#39;pageNumber&#39;</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>});
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>page</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 删除订单记录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>removeOrder</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>id</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>currentTarget</span>.<span style=color:#a6e22e>dataset</span>[<span style=color:#e6db74>&#39;id&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>confirm</span>(<span style=color:#e6db74>&#39;整单课程将全部被删除，确定吗？&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>`/order/remove/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>id</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;订单删除成功&#39;</span>);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;orders&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>});
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>page</span>();
</span></span><span style=display:flex><span>            }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;订单删除失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 播放视频
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>playVideo</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>courseId</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>currentTarget</span>.<span style=color:#a6e22e>dataset</span>[<span style=color:#e6db74>&#39;courseId&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>page</span>(<span style=color:#e6db74>&#39;/pages/order/player/player?courseId=&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>courseId</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>isLogin</span>()) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>page</span>();
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getTabBar</span>().<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#34;activeTab&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>});
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-orderscss>4. order.scss</h3><p><code>/pages/order/order.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>order-list</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>99</span><span style=color:#66d9ef>vh</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.order-item</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border</span>: <span style=color:#ae81ff>1</span>rpx <span style=color:#66d9ef>solid</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>box-sizing</span>: <span style=color:#66d9ef>border-box</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>.title</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>padding-bottom</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>small</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#960050;background-color:#1e0010>.left</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>orange</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>right</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>gray</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>right</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>body</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#960050;background-color:#1e0010>.van-card</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>background</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>van-card__content</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>padding-left</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>van-card__title</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>margin-bottom</span>: <span style=color:#ae81ff>10</span>rpx;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>yellow</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>van-card__price</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>orange</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>van-card__thumb</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>220</span>rpx;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>foot</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>30</span>rpx <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>30</span>rpx <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>margin-bottom</span>: <span style=color:#ae81ff>60</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#960050;background-color:#1e0010>.pay-amount</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>margin-bottom</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>right</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>.small</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>small</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>left</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>line-height</span>: <span style=color:#ae81ff>80</span>rpx;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>gray</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>right</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>right</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>.van-button</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>background-color</span>: <span style=color:#66d9ef>transparent</span>;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>line-height</span>: <span style=color:#ae81ff>50</span>rpx;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h2 id=e02-学习模块>E02. 学习模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发学习模块</p></blockquote><h3 id=1-playerjson>1. player.json</h3><p><code>/pages/order/player/player.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-row&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/row/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-col&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/col/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-tab&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/tab/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-tabs&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/tabs/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-icon&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/icon/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-divider&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/divider/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-share-sheet&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/share-sheet/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-cell-group&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/cell-group/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-field&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/field/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-button&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/button/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-collapse&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/collapse/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-collapse-item&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/collapse-item/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-grid&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/grid/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-grid-item&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/grid-item/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-card&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/card/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-action-sheet&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/action-sheet/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-tag&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/tag/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-playerwxml>2. player.wxml</h3><p><code>/pages/order/player/player.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;video-title&#34;</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{episode[&#39;title&#39;]}}&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>text</span>&gt;《{{ episode[&#39;title&#39;] }}》&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;video-body&#34;</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{episode[&#39;src&#39;] &amp;&amp; episode[&#39;cover&#39;]}}&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>video</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;myVideo&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#a6e22e>controls</span>
</span></span><span style=display:flex><span>           <span style=color:#a6e22e>show-mute-btn</span>
</span></span><span style=display:flex><span>           <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{episode[&#39;src&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#a6e22e>enable-danmu</span> <span style=color:#a6e22e>danmu-btn</span> <span style=color:#a6e22e>danmu-list</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{barrages}}&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#a6e22e>poster</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{episode[&#39;cover&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{episode[&#39;title&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#a6e22e>bindplay</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;onVideoPlay&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#a6e22e>bindpause</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;onVideoPause&#34;</span>/&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;video-foot&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;buttons&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;col&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{like}}&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;like&#34;</span>/&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>wx:else</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;like-o&#34;</span>/&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>text</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;toggleLike&#34;</span>&gt; 点赞&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;col&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{follow}}&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;star&#34;</span>/&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>wx:else</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;star-o&#34;</span>/&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>text</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;toggleFollow&#34;</span>&gt; 收藏&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;col&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;warn-o&#34;</span>/&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>text</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;openReportSheet&#34;</span>&gt; 举报&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;col&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;share-o&#34;</span>/&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>text</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;openShareSheet&#34;</span>&gt; 分享&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;col&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;comment-o&#34;</span>/&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>text</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;openCommentSheet&#34;</span>&gt; 评论&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;col left&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;vip-card&#34;</span> <span style=color:#a6e22e>color</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;gold&#34;</span>/&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;hot-sale&#34;</span> <span style=color:#a6e22e>color</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;skyblue&#34;</span>/&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;fire&#34;</span> <span style=color:#a6e22e>color</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;orange&#34;</span>/&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>text</span>&gt;773&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;col center&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>text</span>&gt;教学课程 · {{course[&#39;category&#39;][&#39;title&#39;]}}&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;col right&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>text</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;openBarrageSheet&#34;</span>&gt;讨论 &gt;&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>van-divider</span> <span style=color:#a6e22e>dashed</span>/&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>van-tabs</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;operation-tabs&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>active</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{curTab}}&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;card&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>animated</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>bind:change</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;changeTab&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-tab</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;播放列表&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;catalog&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-collapse</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;season-collapse&#34;</span>
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>accordion</span>
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ curCollapse }}&#34;</span>
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>bind:change</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;changeCollapse&#34;</span>&gt;
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!--遍历集次--&gt;</span>
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-collapse-item</span> <span style=color:#a6e22e>wx:for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{course[&#39;seasons&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                               <span style=color:#a6e22e>wx:key</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id&#34;</span>
</span></span><span style=display:flex><span>                               <span style=color:#a6e22e>wx:for-item</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;s&#34;</span>
</span></span><span style=display:flex><span>                               <span style=color:#a6e22e>wx:for-index</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;si&#34;</span>
</span></span><span style=display:flex><span>                               <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;第{{si+1}}季：{{s[&#39;title&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                               <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{si}}&#34;</span>
</span></span><span style=display:flex><span>                               <span style=color:#a6e22e>icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;label-o&#34;</span>
</span></span><span style=display:flex><span>                               <span style=color:#a6e22e>content-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;collapse-item&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>van-grid</span> <span style=color:#a6e22e>column-num</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;6&#34;</span> <span style=color:#a6e22e>gutter</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{5}}&#34;</span>&gt;
</span></span><span style=display:flex><span>                    <span style=color:#75715e>&lt;!--遍历集次--&gt;</span>
</span></span><span style=display:flex><span>                    &lt;<span style=color:#f92672>van-grid-item</span> <span style=color:#a6e22e>wx:for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{s[&#39;episodes&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                                   <span style=color:#a6e22e>wx:key</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id&#34;</span>
</span></span><span style=display:flex><span>                                   <span style=color:#a6e22e>wx:for-item</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;e&#34;</span>
</span></span><span style=display:flex><span>                                   <span style=color:#a6e22e>wx:for-index</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ei&#34;</span>
</span></span><span style=display:flex><span>                                   <span style=color:#a6e22e>data-src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{e[&#39;video&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                                   <span style=color:#a6e22e>data-title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{e[&#39;title&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                                   <span style=color:#a6e22e>data-cover</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{e[&#39;cover&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                                   <span style=color:#a6e22e>data-episode-id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{e[&#39;id&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                                   <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;toggleEpisode&#34;</span>&gt;
</span></span><span style=display:flex><span>                        &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>slot</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;icon&#34;</span>&gt;
</span></span><span style=display:flex><span>                            &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{episode[&#39;id&#39;] === e[&#39;id&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                                      <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;play-circle&#34;</span>
</span></span><span style=display:flex><span>                                      <span style=color:#a6e22e>color</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#f9ed69&#34;</span>/&gt;
</span></span><span style=display:flex><span>                            &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>wx:else</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;play-circle&#34;</span>/&gt;
</span></span><span style=display:flex><span>                        &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                        &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>slot</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text&#34;</span>&gt;
</span></span><span style=display:flex><span>                            &lt;<span style=color:#f92672>text</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{episode[&#39;id&#39;] === e[&#39;id&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                                  <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;current-episode&#34;</span>&gt;{{ei + 1}}集&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>                            &lt;<span style=color:#f92672>text</span> <span style=color:#a6e22e>wx:else</span>&gt;{{ei + 1}}集&lt;/<span style=color:#f92672>text</span>&gt;
</span></span><span style=display:flex><span>                        &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                    &lt;/<span style=color:#f92672>van-grid-item</span>&gt;
</span></span><span style=display:flex><span>                &lt;/<span style=color:#f92672>van-grid</span>&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>van-collapse-item</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>van-collapse</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-tab</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-tab</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;评论列表&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;comment&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;comment-list&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-card</span> <span style=color:#a6e22e>wx:for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{comments}}&#34;</span>
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>wx:for-item</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;comment&#34;</span>
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>wx:key</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id&#34;</span>
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{comment[&#39;member&#39;][&#39;nickname&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>thumb</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{MINIO}}/avatar/{{comment[&#39;member&#39;][&#39;avatar&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>thumb-mode</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;scaleToFill&#34;</span>
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>tag</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;V&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>slot</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;desc&#34;</span>&gt;
</span></span><span style=display:flex><span>                    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span>&gt;{{comment[&#39;updated&#39;]}} IP属地: {{comment[&#39;member&#39;][&#39;province&#39;]}}&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;content&#34;</span>&gt;{{comment[&#39;content&#39;]}}&lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;buttons&#34;</span>&gt;
</span></span><span style=display:flex><span>                        &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;icon good-icon&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;good-job-o&#34;</span> <span style=color:#a6e22e>size</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;20px&#34;</span>/&gt;
</span></span><span style=display:flex><span>                        &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;icon bad-icon&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;good-job-o&#34;</span> <span style=color:#a6e22e>size</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;20px&#34;</span>/&gt;
</span></span><span style=display:flex><span>                        &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;icon comment-icon&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;comment-o&#34;</span> <span style=color:#a6e22e>size</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;20px&#34;</span>
</span></span><span style=display:flex><span>                                  <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;openReplySheet&#34;</span>
</span></span><span style=display:flex><span>                                  <span style=color:#a6e22e>data-comment-id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{comment[&#39;id&#39;]}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>                        &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;icon warn-icon&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;warn-o&#34;</span> <span style=color:#a6e22e>size</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;20px&#34;</span>/&gt;
</span></span><span style=display:flex><span>                    &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>slot</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;footer&#34;</span>&gt;
</span></span><span style=display:flex><span>                    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;subComments&#34;</span>
</span></span><span style=display:flex><span>                          <span style=color:#a6e22e>wx:for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{comment[&#39;subComments&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                          <span style=color:#a6e22e>wx:for-item</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;subComment&#34;</span>
</span></span><span style=display:flex><span>                          <span style=color:#a6e22e>wx:key</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id&#34;</span>&gt;
</span></span><span style=display:flex><span>                        {{subComment[&#39;member&#39;][&#39;nickname&#39;]}}
</span></span><span style=display:flex><span>                        &lt;<span style=color:#f92672>van-tag</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;primary&#34;</span>&gt;VIP&lt;/<span style=color:#f92672>van-tag</span>&gt;
</span></span><span style=display:flex><span>                        : {{subComment[&#39;content&#39;]}}
</span></span><span style=display:flex><span>                    &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>                &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>van-card</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-tab</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>van-tabs</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>van-action-sheet</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sheet report-sheet&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>show</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ reportSheetShow }}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;举报该课程&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>bind:close</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;closeReportSheet&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ reportText }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;textarea&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>maxlength</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{500}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>show-word-limit</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>autosize</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{false}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入你的举报理由&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>bindinput</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;changeReportText&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span> <span style=color:#a6e22e>block</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sendReportText&#34;</span>&gt;提交&lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>van-action-sheet</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>van-action-sheet</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sheet comment-sheet&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>show</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ commentSheetShow }}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;评论该课程&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>bind:close</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;closeCommentSheet&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ commentText }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;textarea&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>maxlength</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{500}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>show-word-limit</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>autosize</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{false}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入你的评论内容&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>bindinput</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;changeCommentText&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span> <span style=color:#a6e22e>block</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sendCommentText&#34;</span>&gt;提交&lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>van-action-sheet</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>van-action-sheet</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sheet reply-sheet&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>show</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ replySheetShow }}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;回复该评论&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>bind:close</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;closeReplySheet&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ replyText }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;textarea&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>maxlength</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{500}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>show-word-limit</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>autosize</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{false}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入你的回复内容&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>bindinput</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;changeReplyText&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span> <span style=color:#a6e22e>block</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sendReplyText&#34;</span>&gt;提交&lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>van-action-sheet</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>van-share-sheet</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sheet share-sheet&#34;</span>
</span></span><span style=display:flex><span>                 <span style=color:#a6e22e>show</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ shareSheetShow }}&#34;</span>
</span></span><span style=display:flex><span>                 <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;立即分享给好友&#34;</span>
</span></span><span style=display:flex><span>                 <span style=color:#a6e22e>options</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ shareSheetOptions }}&#34;</span>
</span></span><span style=display:flex><span>                 <span style=color:#a6e22e>bind:close</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;closeShareSheet&#34;</span>/&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>van-action-sheet</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sheet barrage-sheet&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>show</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ barrageSheetShow }}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;发送弹幕参与讨论&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>bind:close</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;closeBarrageSheet&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ barrageText }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;textarea&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>maxlength</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{500}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>show-word-limit</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>autosize</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{false}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入你的弹幕内容&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>bindinput</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;changeBarrageText&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>block</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sendBarrageText&#34;</span>&gt;
</span></span><span style=display:flex><span>        提交
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>van-action-sheet</span>&gt;
</span></span></code></pre></div><h3 id=3-playerjs>3. player.js</h3><p><code>/pages/order/player/player.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../../../utils/api&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span>, {<span style=color:#a6e22e>WEBSOCKET_SERVER</span>} <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../../../utils/util&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>socket</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>, <span style=color:#75715e>// websocket对象
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>socketSuccess</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>, <span style=color:#75715e>// websocket是否连接成功
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>myVideo</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>, <span style=color:#75715e>// video对象
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>videoPlay</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>, <span style=color:#75715e>// 视频是否处于播放状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>MINIO</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>MINIO</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>episode</span><span style=color:#f92672>:</span> {<span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>, <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>, <span style=color:#a6e22e>src</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>, <span style=color:#a6e22e>cover</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>},
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>barrages</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>            {<span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;一大波弹幕即将来袭&#39;</span>, <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#ff0000&#39;</span>, <span style=color:#a6e22e>time</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>}
</span></span><span style=display:flex><span>        ],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>course</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>like</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>follow</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>reportText</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>reportSheetShow</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>commentText</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>commentSheetShow</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>replyText</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>replyTargetId</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>replySheetShow</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>shareSheetShow</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>shareSheetOptions</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>            {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;微信&#39;</span>, <span style=color:#a6e22e>icon</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;wechat&#39;</span>},
</span></span><span style=display:flex><span>            {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;微博&#39;</span>, <span style=color:#a6e22e>icon</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;weibo&#39;</span>},
</span></span><span style=display:flex><span>            {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;复制链接&#39;</span>, <span style=color:#a6e22e>icon</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;link&#39;</span>},
</span></span><span style=display:flex><span>            {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;分享海报&#39;</span>, <span style=color:#a6e22e>icon</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;poster&#39;</span>},
</span></span><span style=display:flex><span>            {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;二维码&#39;</span>, <span style=color:#a6e22e>icon</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;qrcode&#39;</span>},
</span></span><span style=display:flex><span>        ],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>barrageSheetShow</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>barrageText</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>curTab</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>curCollapse</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>comments</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* ==================== 查询课程 ==================== */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 查询课程详情
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>getCourseInfo</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>courseId</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/course/getInfo/&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>courseId</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>firstEpisode</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;seasons&#39;</span>][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#39;episodes&#39;</span>][<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;created&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>dateFormat</span>(<span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;created&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;updated&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>dateFormat</span>(<span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;updated&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;course&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;episode.src&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>MINIO</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;/video/&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>firstEpisode</span>[<span style=color:#e6db74>&#39;video&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;episode.cover&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>MINIO</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;/videoCover/&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>firstEpisode</span>[<span style=color:#e6db74>&#39;cover&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;episode.title&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>firstEpisode</span>[<span style=color:#e6db74>&#39;title&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;episode.id&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>firstEpisode</span>[<span style=color:#e6db74>&#39;id&#39;</span>],
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;视频查询失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* ==================== 点赞课程 ==================== */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 切换课程点赞
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>toggleLike</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;like&#39;</span><span style=color:#f92672>:</span> <span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>like</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* ==================== 收藏课程 ==================== */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 切换课程收藏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>toggleFollow</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;follow&#39;</span><span style=color:#f92672>:</span> <span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>follow</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* ==================== 举报课程 ==================== */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 打开举报Sheet
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>openReportSheet</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;reportSheetShow&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 关闭举报Sheet
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>closeReportSheet</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;reportSheetShow&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;reportText&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 当举报内容改变时触发
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>changeReportText</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;reportText&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 举报课程
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>sendReportText</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 举报文字
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>text</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>reportText</span>.<span style=color:#a6e22e>trim</span>();
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 空值保护
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>text</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;&#39;</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;举报内容为空&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 发送举报
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/report/save&#39;</span>, {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;type&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;fkCourseId&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>course</span>[<span style=color:#e6db74>&#39;id&#39;</span>],
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;reason&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>text</span>,
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;举报成功&#39;</span>);
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>closeReportSheet</span>();
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* ==================== 评论课程 ==================== */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 打开评论Sheet
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>openCommentSheet</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;commentSheetShow&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 关闭评论Sheet
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>closeCommentSheet</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;commentSheetShow&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 当评论内容改变时触发
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>changeCommentText</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;commentText&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 评论课程
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>sendCommentText</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/comment/save&#39;</span>, {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;type&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;fkEpisodeId&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>episode</span>[<span style=color:#e6db74>&#39;id&#39;</span>],
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;content&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>commentText</span>,
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;评论成功&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;commentText&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>});
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;评论异常&#39;</span>))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>closeCommentSheet</span>();
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* ==================== 分享课程 ==================== */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 打开分享Sheet
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>openShareSheet</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;shareSheetShow&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 关闭分享Sheet
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>closeShareSheet</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;shareSheetShow&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* ==================== 视频监听 ==================== */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 当视频播放时触发
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onVideoPlay</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;videoPlay&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 当视频暂停时触发
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onVideoPause</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;videoPlay&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* ==================== 视频弹幕 ==================== */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 打开弹幕Sheet
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>openBarrageSheet</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 当前视频未处于播放状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>videoPlay</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;视频未播放&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 暂停视频
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>myVideo</span>.<span style=color:#a6e22e>pause</span>();
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 打开Sheet
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;barrageSheetShow&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 当弹幕内容改变时触发
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>changeBarrageText</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;barrageText&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 关闭弹幕Sheet
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>closeBarrageSheet</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;barrageSheetShow&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;barrageText&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;videoPlay&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>myVideo</span>.<span style=color:#a6e22e>play</span>();
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 发送弹幕（弹幕颜色随机）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>sendBarrageText</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 弹幕文字
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>text</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>barrageText</span>.<span style=color:#a6e22e>trim</span>();
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 空值保护
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>text</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;&#39;</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;弹幕内容为空&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 发送弹幕文字到WebSocket服务端
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>socketSuccess</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>socket</span>.<span style=color:#a6e22e>send</span>({
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>text</span>
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 关闭弹幕Sheet，重置弹幕文字
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;barrageSheetShow&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;barrageText&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>myVideo</span>.<span style=color:#a6e22e>play</span>();
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* ==================== 切换Tab ==================== */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 切换Tab
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>changeTab</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>curTab</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>.<span style=color:#a6e22e>name</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 评论列表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>curTab</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>listEpisodeComments</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>episode</span>[<span style=color:#e6db74>&#39;id&#39;</span>]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;curTab&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>.<span style=color:#a6e22e>name</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* ==================== 播放列表 ==================== */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 切换Collapse
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>changeCollapse</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;curCollapse&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 切换视频
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>toggleEpisode</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>myVideo</span>.<span style=color:#a6e22e>pause</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;episode.src&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>MINIO</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;/video/&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>currentTarget</span>.<span style=color:#a6e22e>dataset</span>[<span style=color:#e6db74>&#39;src&#39;</span>],
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;episode.cover&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>MINIO</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;/videoCover/&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>currentTarget</span>.<span style=color:#a6e22e>dataset</span>[<span style=color:#e6db74>&#39;cover&#39;</span>],
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;episode.title&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>currentTarget</span>.<span style=color:#a6e22e>dataset</span>[<span style=color:#e6db74>&#39;title&#39;</span>],
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;episode.id&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>currentTarget</span>.<span style=color:#a6e22e>dataset</span>[<span style=color:#e6db74>&#39;episodeId&#39;</span>]
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* ==================== 评论列表 ==================== */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 获取该视频全部评论
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>listEpisodeComments</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>episodeId</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/comment/listEpisodeComments/&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>episodeId</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;updated&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>dateFormat</span>(<span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;updated&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;comments&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>})
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* ==================== 回复评论 ==================== */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 打开回复Sheet
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>openReplySheet</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;replySheetShow&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;replyTargetId&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>currentTarget</span>.<span style=color:#a6e22e>dataset</span>[<span style=color:#e6db74>&#39;commentId&#39;</span>],
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 关闭回复Sheet
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>closeReplySheet</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;replySheetShow&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 当回复内容改变时触发
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>changeReplyText</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;replyText&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 回复评论
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>sendReplyText</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/comment/save&#39;</span>, {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;type&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;fkCommentId&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>replyTargetId</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;content&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>replyText</span>,
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;回复成功&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;replyText&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>});
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>listEpisodeComments</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>episode</span>[<span style=color:#e6db74>&#39;id&#39;</span>]);
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;回复异常&#39;</span>))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>closeReplySheet</span>();
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* ==================== 周期函数 ==================== */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>isLogin</span>()) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>memberId</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>getStorageSync</span>(<span style=color:#e6db74>&#39;member&#39;</span>)[<span style=color:#e6db74>&#39;id&#39;</span>];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>myVideo</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>createVideoContext</span>(<span style=color:#e6db74>&#39;myVideo&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getCourseInfo</span>(<span style=color:#a6e22e>options</span>[<span style=color:#e6db74>&#39;courseId&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 连接WebSocket
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;socket&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>connectSocket</span>({
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;url&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>WEBSOCKET_SERVER</span><span style=color:#e6db74>}</span><span style=color:#e6db74>/barrage/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>memberId</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>                })
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 当成功连接到WebSocket时触发
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>socket</span>.<span style=color:#a6e22e>onOpen</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;socketSuccess&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>                });
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 当接收到WebSocket消息时触发
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>socket</span>.<span style=color:#a6e22e>onMessage</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>myVideo</span>.<span style=color:#a6e22e>sendDanmu</span>({
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;text&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;data&#39;</span>],
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;color&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>getRandomColor</span>()
</span></span><span style=display:flex><span>                });
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 卸载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onUnload</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>socketSuccess</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;socketSuccess&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 断连WebSocket
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>socket</span>.<span style=color:#a6e22e>close</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-playerscss>4. player.scss</h3><p><code>/pages/order/player/player.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>video-title</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>margin-top</span>: <span style=color:#ae81ff>50</span>rpx;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>margin-left</span>: <span style=color:#ae81ff>10</span>rpx;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>margin-bottom</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>center</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>font-weight</span>: <span style=color:#66d9ef>bolder</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>larger</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>video-body</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>margin-bottom</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>video</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>98</span><span style=color:#66d9ef>%</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>outline</span>: <span style=color:#ae81ff>10</span>rpx <span style=color:#66d9ef>solid</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>box-sizing</span>: <span style=color:#66d9ef>border-box</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>video-foot</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.buttons</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>35</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>.col</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>display</span>: <span style=color:#66d9ef>inline-block</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>25</span>rpx;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>info</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>padding-top</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>gray</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>.col</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>display</span>: <span style=color:#66d9ef>inline-block</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>left</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>25</span><span style=color:#66d9ef>%</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>padding-left</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>box-sizing</span>: <span style=color:#66d9ef>border-box</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>center</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>55</span><span style=color:#66d9ef>%</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>right</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>padding-right</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>box-sizing</span>: <span style=color:#66d9ef>border-box</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>right</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>orange</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>20</span><span style=color:#66d9ef>%</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>operation-tabs</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>margin-top</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.catalog</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>20</span><span style=color:#66d9ef>px</span> <span style=color:#ae81ff>15</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>320</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>overflow-y</span>: <span style=color:#66d9ef>scroll</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>box-sizing</span>: <span style=color:#66d9ef>border-box</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>.van-cell</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>yellow</span> <span style=color:#75715e>!important</span>;;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>letter-spacing</span>: <span style=color:#ae81ff>10</span>rpx <span style=color:#75715e>!important</span>;;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>background</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span> <span style=color:#75715e>!important</span>;;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span> <span style=color:#75715e>!important</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>season-collapse</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#960050;background-color:#1e0010>.collapse-item</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span>bg-gray <span style=color:#75715e>!important</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>van-grid-item__content</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>current-episode</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>yellow</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>font-weight</span>: <span style=color:#66d9ef>bold</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>comment</span> {
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>.comment-list</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>20</span><span style=color:#66d9ef>px</span> <span style=color:#ae81ff>15</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>320</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>overflow-y</span>: <span style=color:#66d9ef>scroll</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>box-sizing</span>: <span style=color:#66d9ef>border-box</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#960050;background-color:#1e0010>.van-card</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>background</span>: <span style=color:#960050;background-color:#1e0010>$</span>bg-gray;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>van-card__content</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>padding-left</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>van-card__title</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>orange</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>van-card__thumb</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>70</span>rpx;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>70</span>rpx;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>info</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>margin-top</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>gray</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>content</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>margin-top</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>icon</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>gray</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>20</span>rpx <span style=color:#ae81ff>30</span>rpx <span style=color:#ae81ff>20</span>rpx <span style=color:#ae81ff>-8</span>rpx;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>bad-icon</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>transform</span>: rotate(<span style=color:#ae81ff>180</span><span style=color:#66d9ef>deg</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>subComments</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span>subBlack;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>margin-top</span>: <span style=color:#ae81ff>10</span>rpx;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>margin-left</span>: <span style=color:#ae81ff>100</span>rpx;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>sheet</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>20</span><span style=color:#66d9ef>px</span> <span style=color:#ae81ff>15</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.van-cell</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span>bg-gray <span style=color:#75715e>!important</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>van-field__control</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span> <span style=color:#75715e>!important</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>100</span><span style=color:#66d9ef>px</span> <span style=color:#75715e>!important</span>;;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h1 id=s05-会员模块开发>S05. 会员模块开发</h1><h2 id=e01-会员注册模块>E01. 会员注册模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发会员注册模块</p></blockquote><h3 id=1-registerjson>1. register.json</h3><p><code>/pages/member/register/register.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-field&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/field/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-button&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/button/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-row&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/row/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-col&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/col/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-registerwxml>2. register.wxml</h3><p><code>/pages/member/register/register.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;register-board&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;登录账号&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>right-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;user-o&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>clearable</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ username }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入登录账号&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;登录密码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>right-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;eye-o&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;password&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>clearable</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ password }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入登录密码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;确认密码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>right-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;eye-o&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;password&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>clearable</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ rePassword }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请确认登录密码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;真实姓名&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>right-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;contact-o&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>clearable</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ realname }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入真实姓名&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;手机号码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>right-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;phone-o&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>clearable</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ phone }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入手机号码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;身份证号&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>right-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;user-circle-o&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>clearable</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ idcard }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入身份证号&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;电子邮箱&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>right-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;envelop-o&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>clearable</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ email }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入电子邮箱&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;register-btn&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>block</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;register&#34;</span>&gt;
</span></span><span style=display:flex><span>        注册
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-row</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;link&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-col</span> <span style=color:#a6e22e>span</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;12&#34;</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;toLoginByAccount&#34;</span>&gt;账号密码登录&lt;/<span style=color:#f92672>van-col</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-col</span> <span style=color:#a6e22e>span</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;12&#34;</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;toLoginByPhone&#34;</span>&gt;手机号码登录&lt;/<span style=color:#f92672>van-col</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-row</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span></code></pre></div><h3 id=3-registerjs>3. register.js</h3><p><code>/pages/member/register/register.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/util&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/api&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>username</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>password</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>rePassword</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>realname</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>phone</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>idcard</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>email</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 注册账号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>register</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>username</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>username</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>password</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>password</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rePassword</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>rePassword</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>realname</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>realname</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>phone</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>phone</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>idcard</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>idcard</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>email</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>email</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 检验两次密码是否一致
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>password</span> <span style=color:#f92672>!==</span> <span style=color:#a6e22e>rePassword</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#e6db74>&#39;两次密码不一致&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 检验登录账号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>USERNAME</span>[<span style=color:#e6db74>&#39;pattern&#39;</span>].<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>username</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>USERNAME</span>[<span style=color:#e6db74>&#39;message&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 校验登录密码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>PASSWORD</span>[<span style=color:#e6db74>&#39;pattern&#39;</span>].<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>password</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>PASSWORD</span>[<span style=color:#e6db74>&#39;message&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 校验真实姓名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>REALNAME</span>[<span style=color:#e6db74>&#39;pattern&#39;</span>].<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>realname</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>REALNAME</span>[<span style=color:#e6db74>&#39;message&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 校验电话号码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>PHONE</span>[<span style=color:#e6db74>&#39;pattern&#39;</span>].<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>phone</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>PHONE</span>[<span style=color:#e6db74>&#39;message&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 校验身份证号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>IDCARD</span>[<span style=color:#e6db74>&#39;pattern&#39;</span>].<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>idcard</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>IDCARD</span>[<span style=color:#e6db74>&#39;message&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 校验电子邮箱
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>EMAIL</span>[<span style=color:#e6db74>&#39;pattern&#39;</span>].<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>email</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>EMAIL</span>[<span style=color:#e6db74>&#39;message&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 发送登录请求
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/member/register&#39;</span>, {
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;username&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>username</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;password&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>password</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;realname&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>realname</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;phone&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>phone</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;idcard&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>idcard</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;email&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>email</span>,
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        ).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;注册成功&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 1秒后切换到登录页面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>setTimeout</span>(() =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>page</span>(<span style=color:#e6db74>&#39;/pages/member/login-by-account/login-by-account&#39;</span>), <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 跳转到账号登录页面  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>toLoginByAccount</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (){  
</span></span><span style=display:flex><span>	    <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>page</span>(<span style=color:#e6db74>&#39;/pages/member/login-by-account/login-by-account&#39;</span>, <span style=color:#66d9ef>false</span>);  
</span></span><span style=display:flex><span>	},
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 跳转到手机登录页面  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>toLoginByPhone</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (){  
</span></span><span style=display:flex><span>	    <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>page</span>(<span style=color:#e6db74>&#39;/pages/member/login-by-phone/login-by-phone&#39;</span>, <span style=color:#66d9ef>false</span>);  
</span></span><span style=display:flex><span>	},
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-registerscss>4. register.scss</h3><p><code>/pages/member/register/register.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>register-board</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.field</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>20</span>rpx <span style=color:#66d9ef>auto</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>van-field__control</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>register-btn</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>link</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>gray</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h2 id=e02-账号登录模块>E02. 账号登录模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发账号登录模块</p></blockquote><h3 id=1-login-by-accountjson>1. login-by-account.json</h3><p><code>/pages/member/login-by-account/login-by-account.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-field&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/field/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-button&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/button/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-row&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/row/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-col&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/col/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-login-by-accountwxml>2. login-by-account.wxml</h3><p><code>/pages/member/login-by-account/login-by-account.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;login-by-account-board&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;登录账号&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>right-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;user-o&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>clearable</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ username }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入账号&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;登录密码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>right-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;eye-o&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;password&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>clearable</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ password }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入密码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;login-btn&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>block</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;loginByAccount&#34;</span>&gt;
</span></span><span style=display:flex><span>        登录
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-row</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;link&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-col</span> <span style=color:#a6e22e>span</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;12&#34;</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;toRegister&#34;</span>&gt;注册新账号&lt;/<span style=color:#f92672>van-col</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-col</span> <span style=color:#a6e22e>span</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;12&#34;</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;toLoginByPhone&#34;</span>&gt;手机号码登录&lt;/<span style=color:#f92672>van-col</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-row</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span></code></pre></div><h3 id=3-login-by-accountjs>3. login-by-account.js</h3><p><code>/pages/member/login-by-account/login-by-account.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/util&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/api&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>username</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;123456789&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>password</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;123456789&#39;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 登录方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>loginByAccount</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>username</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>username</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>password</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>password</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 检验登录账号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>USERNAME</span>[<span style=color:#e6db74>&#39;pattern&#39;</span>].<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>username</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>USERNAME</span>[<span style=color:#e6db74>&#39;message&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 校验登录密码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>PASSWORD</span>[<span style=color:#e6db74>&#39;pattern&#39;</span>].<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>password</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>PASSWORD</span>[<span style=color:#e6db74>&#39;message&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 发送登录请求
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/member/loginByAccount&#39;</span>, {
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;username&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>username</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;password&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>password</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        ).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 将会员信息以及对应的Token令牌存储起来
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>setStorageSync</span>(<span style=color:#e6db74>&#39;token&#39;</span>, <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;token&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>setStorageSync</span>(<span style=color:#e6db74>&#39;member&#39;</span>, <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;member&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;登录成功&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 1秒后切换到 &#34;我的&#34; 选项卡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>setTimeout</span>(() =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tab</span>(<span style=color:#e6db74>&#39;/pages/member/member&#39;</span>), <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;账号密码错误&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 跳转到注册页面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>toRegister</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>page</span>(<span style=color:#e6db74>&#39;/pages/member/register/register&#39;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 跳转到手机登录页面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>toLoginByPhone</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>page</span>(<span style=color:#e6db74>&#39;/pages/member/login-by-phone/login-by-phone&#39;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-login-by-accountscss>4. login-by-account.scss</h3><p><code>/pages/member/login-by-account/login-by-account.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>login-by-account-board</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.field</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>20</span>rpx <span style=color:#66d9ef>auto</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>van-field__control</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>login-btn</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>link</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>gray</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h2 id=e03-手机登录模块>E03. 手机登录模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发手机登录模块</p></blockquote><h3 id=1-login-by-phonejson>1. login-by-phone.json</h3><p><code>/pages/member/login-by-phone/login-by-phone.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-field&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/field/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-button&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/button/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-row&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/row/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-col&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/col/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-login-by-phonewxml>2. login-by-phone.wxml</h3><p><code>/pages/member/login-by-phone/login-by-phone.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;login-by-phone-board&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;手机号码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>right-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;user-o&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>clearable</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ phone }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入手机号码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>center</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>clearable</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;短信验证码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入短信验证码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>use-button-slot</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ vcode }}&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>slot</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;button&#34;</span> <span style=color:#a6e22e>size</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;small&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;primary&#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;getVcode&#34;</span>&gt;
</span></span><span style=display:flex><span>            发送验证码
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-field</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;login-btn&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>block</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;loginByPhone&#34;</span>&gt;
</span></span><span style=display:flex><span>        登录
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-row</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;link&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-col</span> <span style=color:#a6e22e>span</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;12&#34;</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;toRegister&#34;</span>&gt;注册新账号&lt;/<span style=color:#f92672>van-col</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-col</span> <span style=color:#a6e22e>span</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;12&#34;</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;toLoginByAccount&#34;</span>&gt;账号密码登录&lt;/<span style=color:#f92672>van-col</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-row</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span></code></pre></div><h3 id=3-login-by-phonejs>3. login-by-phone.js</h3><p><code>/pages/member/login-by-phone/login-by-phone.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/util&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/api&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>phone</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;18210210122&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>vcode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 获取短信验证码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>getVcode</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>phone</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>phone</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 检验手机号码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>PHONE</span>[<span style=color:#e6db74>&#39;pattern&#39;</span>].<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>phone</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>PHONE</span>[<span style=color:#e6db74>&#39;message&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 发送请求：根据手机号码获取短信验证码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/member/getVcode/&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>phone</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;验证码获取成功&#39;</span>);
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#a6e22e>vcode</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>});
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            ).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;验证码获取失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 登录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>loginByPhone</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>phone</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>phone</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>vcode</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>vcode</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 检验手机号码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>PHONE</span>[<span style=color:#e6db74>&#39;pattern&#39;</span>].<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>phone</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>PHONE</span>[<span style=color:#e6db74>&#39;message&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 校验验证码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>vcode</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;&#39;</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#e6db74>&#39;验证码为空&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 发送登录请求
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/member/loginByPhone&#39;</span>, {
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;phone&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>phone</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;vcode&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>vcode</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        ).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 将会员信息以及对应的Token令牌存储起来
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>setStorageSync</span>(<span style=color:#e6db74>&#39;token&#39;</span>, <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;token&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>setStorageSync</span>(<span style=color:#e6db74>&#39;member&#39;</span>, <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;member&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;登录成功&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 1秒后切换到 &#34;我的&#34; 选项卡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>setTimeout</span>(() =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tab</span>(<span style=color:#e6db74>&#39;/pages/member/member&#39;</span>), <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;登录失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 跳转到注册页面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>toRegister</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>page</span>(<span style=color:#e6db74>&#39;/pages/member/register/register&#39;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 跳转到账号登录页面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>toLoginByAccount</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>page</span>(<span style=color:#e6db74>&#39;/pages/member/login-by-account/login-by-account&#39;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-login-by-phonescss>4. login-by-phone.scss</h3><p><code>/pages/member/login-by-phone/login-by-phone.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>login-by-phone-board</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.field</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>20</span>rpx <span style=color:#66d9ef>auto</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>van-field__control</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>login-btn</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>link</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>gray</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h2 id=e04-会员信息模块>E04. 会员信息模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发会员信息模块</p></blockquote><h3 id=1-memberjson>1. member.json</h3><p><code>/pages/member/member.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-divider&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/divider/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-cell-group&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/cell-group/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-cell&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/cell/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-image&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/image/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-button&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/button/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-memberwxml>2. member.wxml</h3><p><code>/pages/member/member.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;member-body&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-cell-group</span> <span style=color:#a6e22e>inset</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;会员头像&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;70px&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>center</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>is-link</span> <span style=color:#a6e22e>link-type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navigateTo&#34;</span> <span style=color:#a6e22e>url</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/pages/member/update-avatar/update-avatar&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-image</span> <span style=color:#a6e22e>wx:if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{member[&#39;avatar&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                       <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;50px&#34;</span>
</span></span><span style=display:flex><span>                       <span style=color:#a6e22e>height</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;50px&#34;</span>
</span></span><span style=display:flex><span>                       <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{MINIO}}/avatar/{{member[&#39;avatar&#39;]}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>van-cell</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;会员昵称&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{member[&#39;nickname&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;70px&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>is-link</span> <span style=color:#a6e22e>link-type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navigateTo&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>url</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ &#39;/pages/member/update-nickname/update-nickname?nickname=&#39; + member[&#39;nickname&#39;]}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;会员性别&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{member[&#39;gender&#39;] === 2 ? &#39;保密&#39;: member[&#39;gender&#39;] === 1 ? &#39;男&#39;: &#39;女&#39;}}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;70px&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>is-link</span> <span style=color:#a6e22e>link-type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navigateTo&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>url</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ &#39;/pages/member/update-gender/update-gender?gender=&#39; + member[&#39;gender&#39;]}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;会员年龄&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{member[&#39;age&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;70px&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>is-link</span> <span style=color:#a6e22e>link-type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navigateTo&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>url</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ &#39;/pages/member/update-age/update-age?age=&#39; + member[&#39;age&#39;]}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;手机号码&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{member[&#39;phone&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;70px&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>is-link</span> <span style=color:#a6e22e>link-type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navigateTo&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>url</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ &#39;/pages/member/update-phone/update-phone?phone=&#39; + member[&#39;phone&#39;]}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;会员描述&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{member[&#39;info&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;70px&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>is-link</span> <span style=color:#a6e22e>link-type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navigateTo&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>url</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ &#39;/pages/member/update-info/update-info?info=&#39; + member[&#39;info&#39;]}}&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;会员账号&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{member[&#39;username&#39;]}}&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;70px&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;会员密码&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;*******&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;70px&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>is-link</span> <span style=color:#a6e22e>link-type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navigateTo&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>url</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/pages/member/update-password/update-password&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;创建时间&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{member[&#39;created&#39;]}}&#34;</span> <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;70px&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;修改时间&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{member[&#39;updated&#39;]}}&#34;</span> <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;70px&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;真实姓名&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{member[&#39;realname&#39;]}}&#34;</span> <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;70px&#34;</span>/&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;身份证号&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{member[&#39;idcard&#39;]}}&#34;</span> <span style=color:#a6e22e>title-width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;70px&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-cell-group</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;buttons&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>block</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;danger&#34;</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;fakeDelete&#34;</span>&gt;注销账号&lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>block</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;warning&#34;</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;logout&#34;</span>&gt;退出登录&lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>view</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span></code></pre></div><h3 id=3-memberjs>3. member.js</h3><p><code>/pages/member/member.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../../utils/api&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../../utils/util&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>MINIO</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>MINIO</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>member</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 获取个人信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>getInfo</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>that</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/member/getInfo&#39;</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;updated&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>dateFormat</span>(<span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;updated&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;created&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>dateFormat</span>(<span style=color:#a6e22e>res</span>[<span style=color:#e6db74>&#39;created&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>that</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;member&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>});
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;会员查询失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 退出登录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>logout</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>confirm</span>(<span style=color:#e6db74>&#39;即将退出登录，确认吗？&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>removeStorageSync</span>(<span style=color:#e6db74>&#39;token&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>removeStorageSync</span>(<span style=color:#e6db74>&#39;member&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>page</span>(<span style=color:#e6db74>&#39;/pages/member/login-by-account/login-by-account&#39;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 注销账号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>fakeDelete</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>confirm</span>(<span style=color:#e6db74>&#39;即将注销账号，确认吗？&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/member/fakeDelete&#39;</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;注销成功&#39;</span>);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>removeStorageSync</span>(<span style=color:#e6db74>&#39;token&#39;</span>);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>removeStorageSync</span>(<span style=color:#e6db74>&#39;member&#39;</span>);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>page</span>(<span style=color:#e6db74>&#39;/pages/member/login-by-account/login-by-account&#39;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>            }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;注销失败&#39;</span>));
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>isLogin</span>()) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getInfo</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getTabBar</span>().<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#34;activeTab&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-memberscss>4. member.scss</h3><p><code>/pages/member/member.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>member-body</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>margin-top</span>: <span style=color:#ae81ff>50</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.van-cell</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span>bg-gray;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>.van-cell__title</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>letter-spacing</span>: <span style=color:#ae81ff>5</span>rpx;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>van-cell__value</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>yellow</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>buttons</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>.van-button</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>margin-top</span>: <span style=color:#ae81ff>30</span>rpx;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h2 id=e05-修改头像模块>E05. 修改头像模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发修改头像模块</p></blockquote><h3 id=1-update-avatarjson>1. update-avatar.json</h3><p><code>/pages/member/update-avatar/update-avatar.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-uploader&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/uploader/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-icon&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/icon/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-divider&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/divider/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-update-avatarwxml>2. update-avatar.wxml</h3><p><code>/pages/member/update-avatar/update-avatar.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>van-divider</span> <span style=color:#a6e22e>contentPosition</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;center&#34;</span> <span style=color:#a6e22e>dashed</span>&gt;点击图片上传你的新头像&lt;/<span style=color:#f92672>van-divider</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>van-uploader</span> <span style=color:#a6e22e>file-list</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{avatarFile}}&#34;</span> 
</span></span><span style=display:flex><span>			  <span style=color:#a6e22e>max-count</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1&#34;</span> 
</span></span><span style=display:flex><span>			  <span style=color:#a6e22e>accept</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;image&#34;</span> 
</span></span><span style=display:flex><span>			  <span style=color:#a6e22e>deletable</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>bind:after-read</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;uploadAvatar&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-icon</span> <span style=color:#a6e22e>size</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;200&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;photo&#34;</span>/&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>van-uploader</span>&gt;
</span></span></code></pre></div><h3 id=3-update-avatarjs>3. update-avatar.js</h3><p><code>/pages/member/update-avatar/update-avatar.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/util&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/api&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>avatarFile</span><span style=color:#f92672>:</span> []
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>uploadAvatar</span>(<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> {<span style=color:#a6e22e>file</span>} <span style=color:#f92672>=</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 检查文件类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;image&#39;</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;图片格式有误&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 检查文件大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>size</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>500</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1024</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;图片过大&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 上传文件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>uploadFile</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>url</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>LESSON_SERVER</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;/api/v1/member/uploadAvatar&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>filePath</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>url</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;avatarFile&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>header</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;Content-Type&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;multipart/form-data&#39;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;token&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>wx</span>.<span style=color:#a6e22e>getStorageSync</span>(<span style=color:#e6db74>&#39;token&#39;</span>)
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>success</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>res</span>) =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#a6e22e>avatarFile</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>res</span>});
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;上传成功&#39;</span>);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>setTimeout</span>(() =&gt; {
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tab</span>(<span style=color:#e6db74>&#39;/pages/member/member&#39;</span>);
</span></span><span style=display:flex><span>                }, <span style=color:#ae81ff>1000</span>)
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>fail</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>err</span>) =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;上传失败&#39;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-update-avatarscss>4. update-avatar.scss</h3><p><code>/pages/member/update-avatar/update-avatar.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span><span style=color:#75715e>/**暂无*/</span>
</span></span></code></pre></div><h2 id=e06-修改昵称模块>E06. 修改昵称模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发修改昵称模块</p></blockquote><h3 id=1-update-nicknamejson>1. update-nickname.json</h3><p><code>/pages/member/update-nickname/update-nickname.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-field&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/field/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-button&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/button/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-update-nicknamewxml>2. update-nickname.wxml</h3><p><code>/pages/member/update-nickname/update-nickname.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;update-nickname-board&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;用户昵称&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>right-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;eye-o&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ nickname }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入昵称&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit-btn&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span> <span style=color:#a6e22e>block</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;updateNickname&#34;</span>&gt;
</span></span><span style=display:flex><span>        确认修改
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span></code></pre></div><h3 id=3-update-nicknamejs>3. update-nickname.js</h3><p><code>/pages/member/update-nickname/update-nickname.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/api&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/util&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>nickname</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 修改昵称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>updateNickname</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>nickname</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>nickname</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 检验昵称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>NICKNAME</span>[<span style=color:#e6db74>&#39;pattern&#39;</span>].<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>nickname</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>NICKNAME</span>[<span style=color:#e6db74>&#39;message&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 发送请求修改昵称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/member/update&#39;</span>, {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;nickname&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>nickname</span>
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;修改成功&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 1秒后切换到 &#34;我的&#34; 选项卡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>setTimeout</span>(() =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tab</span>(<span style=color:#e6db74>&#39;/pages/member/member&#39;</span>), <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;修改失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;nickname&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>options</span>[<span style=color:#e6db74>&#39;nickname&#39;</span>]});
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-update-nicknamescss>4. update-nickname.scss</h3><p><code>/pages/member/update-nickname/update-nickname.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>update-nickname-board</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.field</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>20</span>rpx <span style=color:#66d9ef>auto</span> ;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span> ;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span> ;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>van-field__control</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span> ;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>submit-btn</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h2 id=e07-修改性别模块>E07. 修改性别模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发修改性别模块</p></blockquote><h3 id=1-update-genderjson>1. update-gender.json</h3><p><code>/pages/member/update-gender/update-gender.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-radio&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/radio/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-radio-group&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/radio-group/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-cell-group&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/cell-group/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-cell&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/cell/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-button&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/button/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-update-genderwxml>2. update-gender.wxml</h3><p><code>/pages/member/update-gender/update-gender.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;update-gender-board&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-radio-group</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ gender }}&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>van-cell-group</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;我是女的&#34;</span> <span style=color:#a6e22e>clickable</span> <span style=color:#a6e22e>data-gender</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#a6e22e>bind:click</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;onClick&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>van-radio</span> <span style=color:#a6e22e>slot</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;right-icon&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0&#34;</span>/&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>van-cell</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;我是男的&#34;</span> <span style=color:#a6e22e>clickable</span> <span style=color:#a6e22e>data-gender</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1&#34;</span> <span style=color:#a6e22e>bind:click</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;onClick&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>van-radio</span> <span style=color:#a6e22e>slot</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;right-icon&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1&#34;</span>/&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>van-cell</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>van-cell</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;对外保密&#34;</span> <span style=color:#a6e22e>clickable</span> <span style=color:#a6e22e>data-gender</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;2&#34;</span> <span style=color:#a6e22e>bind:click</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;onClick&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>van-radio</span> <span style=color:#a6e22e>slot</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;right-icon&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;2&#34;</span>/&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>van-cell</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>van-cell-group</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-radio-group</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit-btn&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span> <span style=color:#a6e22e>block</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;updateGender&#34;</span>&gt;
</span></span><span style=display:flex><span>        确认修改
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span></code></pre></div><h3 id=3-update-genderjs>3. update-gender.js</h3><p><code>/pages/member/update-gender/update-gender.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/api&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/util&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>gender</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 点击选项时触发
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onClick</span>(<span style=color:#a6e22e>event</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;gender&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>currentTarget</span>.<span style=color:#a6e22e>dataset</span>[<span style=color:#e6db74>&#39;gender&#39;</span>]});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 修改性别
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>updateGender</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>gender</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>gender</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 发送请求修改性别
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/member/update&#39;</span>, {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;gender&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>gender</span>
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;修改成功&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 1秒后切换到 &#34;我的&#34; 选项卡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>setTimeout</span>(() =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tab</span>(<span style=color:#e6db74>&#39;/pages/member/member&#39;</span>), <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;修改失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;gender&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>options</span>[<span style=color:#e6db74>&#39;gender&#39;</span>]});
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-update-genderscss>4. update-gender.scss</h3><p><code>/pages/member/update-gender/update-gender.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>update-gender-board</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.van-cell</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>submit-btn</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin-top</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h2 id=e08-修改年龄模块>E08. 修改年龄模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发修改年龄模块</p></blockquote><h3 id=1-update-agejson>1. update-age.json</h3><p><code>/pages/member/update-age/update-age.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-field&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/field/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-button&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/button/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-update-agewxml>2. update-age.wxml</h3><p><code>/pages/member/update-age/update-age.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;update-age-board&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;用户年龄&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;number&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>right-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;eye-o&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ age }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入年龄&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit-btn&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span> <span style=color:#a6e22e>block</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;updateAge&#34;</span>&gt;
</span></span><span style=display:flex><span>        确认修改
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span></code></pre></div><h3 id=3-update-agejs>3. update-age.js</h3><p><code>/pages/member/update-age/update-age.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/api&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/util&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>age</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 修改年龄
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>updateAge</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>age</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>age</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 检验年龄
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>age</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>18</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>age</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>80</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#e6db74>&#39;年龄必须在18~80之间&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 发送请求修改年龄
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/member/update&#39;</span>, {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;age&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>age</span>
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;修改成功&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 1秒后切换到 &#34;我的&#34; 选项卡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>setTimeout</span>(() =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tab</span>(<span style=color:#e6db74>&#39;/pages/member/member&#39;</span>), <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;修改失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;age&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>options</span>[<span style=color:#e6db74>&#39;age&#39;</span>]});
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-update-agescss>4. update-age.scss</h3><p><code>/pages/member/update-age/update-age.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>update-age-board</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.field</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>20</span>rpx <span style=color:#66d9ef>auto</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>van-field__control</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>submit-btn</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h2 id=e09-修改手机模块>E09. 修改手机模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发修改手机模块</p></blockquote><h3 id=1-update-phonejson>1. update-phone.json</h3><p><code>/pages/member/update-phone/update-phone.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-field&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/field/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-button&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/button/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-update-phonewxml>2. update-phone.wxml</h3><p><code>/pages/member/update-phone/update-phone.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;update-phone-board&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;手机号码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>right-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;eye-o&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ phone }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入手机号码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit-btn&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span> <span style=color:#a6e22e>block</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;updatePhone&#34;</span>&gt;
</span></span><span style=display:flex><span>        确认修改
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span></code></pre></div><h3 id=3-update-phonejs>3. update-phone.js</h3><p><code>/pages/member/update-phone/update-phone.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/api&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/util&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>phone</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 修改手机号码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>updatePhone</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>phone</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>phone</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 检验手机号码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>PHONE</span>[<span style=color:#e6db74>&#39;pattern&#39;</span>].<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>phone</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>PHONE</span>[<span style=color:#e6db74>&#39;message&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 发送请求修改手机号码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/member/update&#39;</span>, {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;phone&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>phone</span>
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;修改成功&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 1秒后切换到 &#34;我的&#34; 选项卡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>setTimeout</span>(() =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tab</span>(<span style=color:#e6db74>&#39;/pages/member/member&#39;</span>), <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;修改失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-update-phonescss>4. update-phone.scss</h3><p><code>/pages/member/update-phone/update-phone.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>update-phone-board</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.field</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>20</span>rpx <span style=color:#66d9ef>auto</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>van-field__control</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>submit-btn</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h2 id=e10-修改描述模块>E10. 修改描述模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发修改描述模块</p></blockquote><h3 id=1-update-infojson>1. update-info.json</h3><p><code>/pages/member/update-info/update-info.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-field&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/field/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-button&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/button/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-update-infowxml>2. update-info.wxml</h3><p><code>/pages/member/update-info/update-info.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;update-info-board&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;textarea&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>maxlength</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{500}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>show-word-limit</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{true}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>autosize</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{false}}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ info }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入描述信息&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>bindinput</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;changeInfo&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit-btn&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span> <span style=color:#a6e22e>block</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;updateInfo&#34;</span>&gt;
</span></span><span style=display:flex><span>        确认修改
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span></code></pre></div><h3 id=3-update-infojs>3. update-info.js</h3><p><code>/pages/member/update-info/update-info.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/api&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/util&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>info</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 当信息内容改变时触发
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>changeInfo</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>ev</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;info&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>detail</span>});
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 修改描述信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>updateInfo</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>info</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>info</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 发送请求修改描述信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/member/update&#39;</span>, {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;info&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>info</span>
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;修改成功&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 1秒后切换到 &#34;我的&#34; 选项卡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>setTimeout</span>(() =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tab</span>(<span style=color:#e6db74>&#39;/pages/member/member&#39;</span>), <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;修改失败&#39;</span>, <span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setData</span>({<span style=color:#e6db74>&#39;info&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>options</span>[<span style=color:#e6db74>&#39;info&#39;</span>]});
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-update-infoscss>4. update-info.scss</h3><p><code>/pages/member/update-info/update-info.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>update-info-board</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.field</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>20</span>rpx <span style=color:#66d9ef>auto</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>van-field__control</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>150</span><span style=color:#66d9ef>px</span> <span style=color:#75715e>!important</span>;;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>submit-btn</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h2 id=e11-修改密码模块>E11. 修改密码模块</h2><blockquote><p>武技: 在 <code>lesson-server-miniapp</code> 项目中开发修改密码模块</p></blockquote><h3 id=1-update-passwordjson>1. update-password.json</h3><p><code>/pages/member/update-password/update-password.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;usingComponents&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-field&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/field/index&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;van-button&#34;</span>: <span style=color:#e6db74>&#34;@vant/weapp/button/index&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-update-passwordwxml>2. update-password.wxml</h3><p><code>/pages/member/update-password/update-password.wxml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>view</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;update-password-board&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;旧的密码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>right-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;eye-o&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ oldPassword }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入旧的登录密码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;新的密码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>right-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;eye-o&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ newPassword }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入新的登录密码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-field</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;field&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;确认密码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>right-icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;eye-o&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>model:value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ rePassword }}&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请再次输入新的登录密码&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ false }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>van-button</span> <span style=color:#a6e22e>custom-class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit-btn&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;info&#34;</span> <span style=color:#a6e22e>block</span> <span style=color:#a6e22e>bind:tap</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;updatePassword&#34;</span>&gt;
</span></span><span style=display:flex><span>        确认修改
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>van-button</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>view</span>&gt;
</span></span></code></pre></div><h3 id=3-update-passwordjs>3. update-password.js</h3><p><code>/pages/member/update-password/update-password.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>api</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/api&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>util</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;../../../utils/util&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>oldPassword</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>newPassword</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>rePassword</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 修改密码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>updatePassword</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>oldPassword</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>oldPassword</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>newPassword</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>newPassword</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rePassword</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>rePassword</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 新密码和原密码不能一致
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>newPassword</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>oldPassword</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#e6db74>&#39;新密码和原密码不能一致&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 检验两次密码是否一致
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>newPassword</span> <span style=color:#f92672>!==</span> <span style=color:#a6e22e>rePassword</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#e6db74>&#39;两次密码不一致&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 检验新密码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>PASSWORD</span>[<span style=color:#e6db74>&#39;pattern&#39;</span>].<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>newPassword</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>RULE</span>.<span style=color:#a6e22e>PASSWORD</span>[<span style=color:#e6db74>&#39;message&#39;</span>]);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 发送请求修改密码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/member/updatePassword&#39;</span>, {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;oldPassword&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>oldPassword</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;newPassword&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>newPassword</span>,
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>success</span>(<span style=color:#e6db74>&#39;修改成功&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 1秒后切换到 &#34;我的&#34; 选项卡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>setTimeout</span>(() =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tab</span>(<span style=color:#e6db74>&#39;/pages/member/member&#39;</span>), <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>        }).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; <span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>tip</span>(<span style=color:#a6e22e>err</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 加载函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=4-update-passwordscss>4. update-password.scss</h3><p><code>/pages/member/update-password/update-password.scss</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;app&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>update-password-board</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>20</span>rpx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>.field</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>20</span>rpx <span style=color:#66d9ef>auto</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>background-color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>black</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>van-field__control</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>color</span>: <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>submit-btn</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font-size</span>: <span style=color:#66d9ef>large</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>15</span>rpx;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div></main><footer class=footer><span>&copy; 2024 The Marauders</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>