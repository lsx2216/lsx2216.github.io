<!doctype html><html lang=en><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>JB2-5-Tomcat</title>
<meta name=description content="Java道经第2卷 - 第5阶 - v2-5-web-tomcat(WAR) - Tomcat
CH01. 互联网通信模型 心法: Web通信模型 Web Communication Model
Web通信就是基于HTTP协议，客户端向服务端发送HTTP请求，然后服务端返回给客户端HTTP响应的过程: 关键点 中文 描 …"><meta name=keywords content='blog,lsx2216,hugo'><meta property="og:url" content="https://lsx2216.netlify.app/%E7%AC%AC2%E9%98%B6%E6%AE%B5-WEB/JB2-5-Tomcat/JB2-5-Tomcat/"><meta property="og:type" content="website"><meta property="og:title" content="JB2-5-Tomcat"><meta property="og:description" content="Java道经第2卷 - 第5阶 - v2-5-web-tomcat(WAR) - Tomcat
CH01. 互联网通信模型 心法: Web通信模型 Web Communication Model
Web通信就是基于HTTP协议，客户端向服务端发送HTTP请求，然后服务端返回给客户端HTTP响应的过程: 关键点 中文 描 …"><meta property="og:image" content="https://lsx2216.netlify.app/assets/images/user.jpg"><meta property="og:image:secure_url" content="https://lsx2216.netlify.app/assets/images/user.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="JB2-5-Tomcat"><meta name=twitter:description content="Java道经第2卷 - 第5阶 - v2-5-web-tomcat(WAR) - Tomcat
CH01. 互联网通信模型 心法: Web通信模型 Web Communication Model
Web通信就是基于HTTP协议，客户端向服务端发送HTTP请求，然后服务端返回给客户端HTTP响应的过程: 关键点 中文 描 …"><meta property="twitter:domain" content="https://lsx2216.netlify.app/%E7%AC%AC2%E9%98%B6%E6%AE%B5-WEB/JB2-5-Tomcat/JB2-5-Tomcat/"><meta property="twitter:url" content="https://lsx2216.netlify.app/%E7%AC%AC2%E9%98%B6%E6%AE%B5-WEB/JB2-5-Tomcat/JB2-5-Tomcat/"><meta name=twitter:image content="https://lsx2216.netlify.app/assets/images/user.jpg"><link rel=canonical href=https://lsx2216.netlify.app/%E7%AC%AC2%E9%98%B6%E6%AE%B5-WEB/JB2-5-Tomcat/JB2-5-Tomcat/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.3eb19cb61dde9e37b9522867f3e024aeb68e26ab8e03252e46e365abcb19acf7.js integrity="sha256-PrGcth3enje5Uihn8+AkrraOJquOAyUuRuNlq8sZrPc="></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css integrity=sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js integrity=sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})})</script>    <link rel="shortcut icon" href="/assets/images/user.jpg" type="image/x-icon">
</head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://lsx2216.netlify.app/><img src=/assets/images/user.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://lsx2216.netlify.app/>lsx2216</a></div><div class=nav-links><div class=nav-link><a href=https://lsx2216.netlify.app/ aria-label><span data-feather=home></span> Home</a></div><div class=nav-link><a href=https://lsx2216.netlify.app/projects/ aria-label><span data-feather=code></span> Projects</a></div><div class=nav-link><a href=https://github.com aria-label=github><span data-feather=github></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://lsx2216.netlify.app/><span data-feather=home></span> Home</a></li><li class=nav-item><a href=https://lsx2216.netlify.app/projects/><span data-feather=code></span> Projects</a></li><li class=nav-item><a href=https://github.com><span data-feather=github></span></a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>JB2-5-Tomcat</h1></div><div class=post-content><blockquote><p>Java道经第2卷 - 第5阶 - v2-5-web-tomcat(WAR) - Tomcat</p></blockquote><h1 id=ch01-互联网通信模型>CH01. 互联网通信模型</h1><blockquote><p>心法: Web通信模型 <code>Web Communication Model</code></p></blockquote><ul><li>Web通信就是基于HTTP协议，客户端向服务端发送HTTP请求，然后服务端返回给客户端HTTP响应的过程:</li></ul><table><thead><tr><th>关键点</th><th>中文</th><th>描述</th></tr></thead><tbody><tr><td><code>HTTP Protocol</code></td><td>HTTP协议</td><td>请求必须以 <code>http://</code> 或 <code>https://</code> 为前缀，HTTP协议的底层是TCP/IP协议</td></tr><tr><td><code>TCP Protocol</code></td><td>TCP协议</td><td>TCP协议负责将数据完整的送到目的地，尽管路途中可能会将数据拆成若干小块TCP协议采用拥塞机制来控制网络传输，因此当网络拥堵时，会抑制传输速率</td></tr><tr><td><code>IP Protocol</code></td><td>IP协议</td><td>IP协议负责把数据准确地送到目的地</td></tr><tr><td><code>Client</code></td><td>客户端</td><td>客户端可以统一指代浏览器，客户端或一个人类用户BS架构: 从浏览器到服务端，使用方便，无需跟服务端同步更新CS架构: 从客户端到服务端，需要跟服务端同步更新</td></tr><tr><td><code>Server</code></td><td>服务端</td><td>服务端指物理主机硬件或WEB服务器应用软件，如Tomcat等</td></tr></tbody></table><h2 id=e01-通信基础概念>E01. 通信基础概念</h2><h3 id=1-https对比http>1. HTTPS对比HTTP</h3><blockquote><p>心法: HTTP 协议和 HTTPS 协议的区别</p></blockquote><table><thead><tr><th>区别点</th><th>HTTP</th><th>HTTPS</th></tr></thead><tbody><tr><td>安全性</td><td>安全性低，使用明文传输数据，数据不经过加密，容易被窃听和篡改</td><td>安全性高，通过SSL/TLS协议对数据进行加密传输，并提供服务器身份验证，有效防止窃听和篡改</td></tr><tr><td>通信端口</td><td>默认使用端口80进行通信</td><td>默认使用端口443进行加密通信</td></tr><tr><td>信任度</td><td>缺乏对网站真实性的验证，容易受到仿冒网站的攻击</td><td>使用数字证书对网站进行身份验证，提高了用户对网站的信任度</td></tr></tbody></table><h3 id=2-https安全措施>2. HTTPS安全措施</h3><blockquote><p>心法：HTTPS 安全保障措施</p></blockquote><table><thead><tr><th>安全保障方式</th><th>描述</th></tr></thead><tbody><tr><td>数据加密</td><td>HTTPS使用SSL/TLS协议对传输的数据进行加密，这意味着即使在数据传输过程中被截获，也很难解密和窃取其中的信息。</td></tr><tr><td>身份验证</td><td>SSL/TLS协议还允许服务器和客户端进行身份验证，确保数据发送到正确的目标，并防止中间人攻击。</td></tr><tr><td>数据完整性</td><td>HTTPS使用加密哈希算法来验证数据完整性，确保数据在传输过程中不被篡改。</td></tr><tr><td>信任和认证</td><td>HTTPS使用数字证书来验证服务器的身份和真实性，这些证书由可信任的第三方机构颁发，确保通信双方的真实性。</td></tr><tr><td>对抗窥探和劫持</td><td>HTTPS可以有效防止网络窥探和劫持，确保用户的隐私和数据安全。</td></tr></tbody></table><h2 id=ep01-客户端发送请求>EP01. 客户端发送请求</h2><blockquote><p>心法: 请求 <code>HttpRequest</code>: 客户端对服务器说我想要一个xxx资源</p></blockquote><ul><li>请求格式: <code>通信协议://服务器IP或名称:服务器端口/资源所在目录/资源?查询串</code>:</li></ul><table><thead><tr><th>请求类型</th><th>描述</th></tr></thead><tbody><tr><td><code>GET</code></td><td>常用于查询资源，只有请求头，没有请求体，速度更快，但不安全，且数据携带量小</td></tr><tr><td><code>POST</code></td><td>常用于添加资源，使用请求体携带额外数据，牺牲了速度，但安全，且数据携带量更大</td></tr><tr><td><code>PUT</code></td><td>常用于修改资源，类似POST请求，大部分浏览器不支持PUT请求，可用POST请求代替</td></tr><tr><td><code>DELETE</code></td><td>常用于删除资源，类似POST请求，大部分浏览器不支持DELETE请求，可用POST请求代替</td></tr><tr><td><code>OPTIONS</code></td><td>部分跨域请求都会提前发送一个预检请求来检查服务器是通行</td></tr></tbody></table><blockquote><p>武技: 使用浏览器向百度服务器发送并观察一次GET请求</p></blockquote><ul><li>打开浏览器，右键开发者模式，切换到 <code>网络</code> 选项卡。</li><li>地址栏键入 <code>http://www.baidu.com?name=lsx</code> 后回车以发送一次GET请求。</li><li>点击 <code>网络</code> 中出现的本次GET请求路径，观察标头Headers和负载Response中的数据项。</li></ul><p><img src=/%E7%AC%AC2%E9%98%B6%E6%AE%B5-WEB/JB2-5-Tomcat/image/8f33b90f19ebec2e75dc840703074456.png alt></p><blockquote><p>武技: 使用HTML表单向百度服务器发送并观察一次POST请求</p></blockquote><ol><li>在任意位置开发一个 <code>index.html</code> 文档并编写一个简单的HTML表单:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!--表单--&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://www.baidu.com&#34;</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;POST&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;real-name&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;lsx&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>button</span>&gt;发送POST请求&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>form</span>&gt;
</span></span></code></pre></div><ol start=2><li>使用浏览器打开 <code>index.html</code> 文档:<ul><li>右键开发者模式，切换到 <code>网络</code> 选项卡。</li><li>并点击发送按钮以发送一个POST请求到百度服务器，服务器报错也没事。</li></ul></li><li>点击 <code>网络</code> 中出现的本次POST请求路径，观察标头Headers和负载Response中的数据项。</li></ol><p><img src=/%E7%AC%AC2%E9%98%B6%E6%AE%B5-WEB/JB2-5-Tomcat/image/6b875331a29b742c8e02854baa1cca12.png alt></p><h2 id=ep02-服务端回执响应>EP02. 服务端回执响应</h2><blockquote><p>心法: 响应 <code>HttpResponse</code>: 服务端找到了xxx资源，并对客户端返回的过程</p></blockquote><table><thead><tr><th>响应码</th><th>描述</th></tr></thead><tbody><tr><td><code>200</code></td><td>本次请求成功</td></tr><tr><td><code>201</code></td><td>本次请求成功且创建了新的资源</td></tr><tr><td><code>400</code></td><td>请求的语法有误，本次请求失败</td></tr><tr><td><code>401</code></td><td>请求的语法没有问题，但客户端的访问权限不够，本次请求失败</td></tr><tr><td><code>403</code></td><td>请求的语法没有问题，但请求方式不被服务端允许，本次请求失败</td></tr><tr><td><code>404</code></td><td>请求的资源未找到，本次请求失败</td></tr><tr><td><code>500</code></td><td>服务端代码出现了问题，本次请求失败</td></tr></tbody></table><h1 id=ch02-汤姆猫服务容器>CH02. 汤姆猫服务容器</h1><blockquote><p>心法: 汤姆猫服务器 <code>Tomcat Server</code></p></blockquote><ul><li>Tomcat是Apache软件基金会的Jakarta项目中的一个核心项目产品，开源且运行时占用的系统资源很小。</li><li>服务器其实是WEB容器和EJB程序的总称，但Tomcat没有EJB，所以只能勉强算一个轻量级的服务器。</li></ul><h2 id=ep01-tomcat服务安装>EP01. Tomcat服务安装</h2><blockquote><p>武技: 在Windows上安装Tomcat</p></blockquote><ol><li><a href=https://tomcat.apache.org/tomcat-9.0-doc/index.html>下载Tomcat</a>:<ul><li>点击Tomcat9版本的 <code>64-bit Windows zip (pgp, sha512)</code> 进行下载，直接解压缩即可:</li></ul></li></ol><table><thead><tr><th>目录结构</th><th>描述</th></tr></thead><tbody><tr><td><code>bin</code></td><td>存放windows/Linux平台上Tomcat相关的可执行文件</td></tr><tr><td><code>conf</code></td><td>存放Tomcat容器的各种全局配置文件，其中最重要的是 <code>server.xml</code> 和 <code>web.xml</code></td></tr><tr><td><code>lib</code></td><td>存放Tomcat执行时的一些jar包文件</td></tr><tr><td><code>logs</code></td><td>存放Tomcat执行时的日志文件</td></tr><tr><td><code>temp</code></td><td>存放Tomcat的临时文件</td></tr><tr><td><code>webapps</code></td><td>Tomcat的Web项目发布目录</td></tr><tr><td><code>work</code></td><td>存放JSP编译后产生的class文件</td></tr></tbody></table><ol start=2><li>配置Tomcat: 解决Tomcat9命令行日志中文乱码问题:<ul><li>修改日志属性文件 <code>@\conf\logging.properties</code> 中的控制台编码配置项目:</li></ul></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#75715e># 兼容windows命令行</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>java.util.logging.ConsoleHandler.encoding</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>GBK</span>
</span></span></code></pre></div><ol start=3><li>启动Tomcat: 点击 <code>bin\startup.bat</code> 文件:<ul><li>cmd: <code>netstat -ano | findstr 8080</code>: 查看8080进程的PID值。</li><li>cmd: <code>tasklist | findstr 12138</code>: 通过PID查询是该进程的具体信息。</li><li>cmd: <code>taskkill /f /t /pid 12138</code>: 通过PID强制关闭12138进程及其子进程。</li></ul></li><li>关闭Tomcat: 点击 <code>bin\shutdown.bat</code> 文件。</li></ol><h2 id=ep02-tomcat容器安装>EP02. Tomcat容器安装</h2><blockquote><p>武技: 在Docker中安装Tomcat容器</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-dockerfile data-lang=dockerfile><span style=display:flex><span><span style=color:#75715e># 创建Tomcat相关目录</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>mkdir -p /opt/tomcat/conf;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>mkdir -p /opt/tomcat/logs;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>chmod -R <span style=color:#ae81ff>777</span> /opt/tomcat;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># 创建并运行临时的容器: 该容器仅用于拷贝配置文件，用完即删</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>docker run -d --name tmp tomcat:9<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># 拷贝主配和webapps目录到虚拟机</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>docker cp tmp:/usr/local/tomcat/conf/server.xml /opt/tomcat/conf;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>docker cp tmp:/usr/local/tomcat/webapps.dist /opt/tomcat/webapps;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># 删除临时容器，为后续真正的容器让出端口</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>docker rm -f tmp<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># 创建并运行真正的容器</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>docker run --name tomcat -dp 8080:8080 --network my-net <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -v /opt/tomcat/webapps:/usr/local/tomcat/webapps <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -v /opt/tomcat/conf/server.xml:/usr/local/tomcat/conf/server.xml <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -v /opt/tomcat/logs:/usr/local/tomcat/logs <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    tomcat:9<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># 查看容器</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>docker ps -a --format <span style=color:#e6db74>&#34;table {{.ID}}\t{{.Names}}\t{{.Ports}}&#34;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>docker logs tomcat --tail <span style=color:#ae81ff>30</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># 进入容器的内部: 可用 `exit` 命令退出容器</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>docker exec -it tomcat bash<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># 查看Tomcat版本</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>version.sh<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># 访问容器</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>firewall-cmd --add-port<span style=color:#f92672>=</span>8080/tcp --permanent<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>firewall-cmd --reload<span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><ul><li>cli: <code>http://192.168.40.77:8080</code></li></ul><h2 id=ep03-tomcat服务整合>EP03. Tomcat服务整合</h2><blockquote><p>武技: 将Tomcat整合到IDEA中</p></blockquote><ol><li>点击IDEA右上角 <code>Edit Configurations/Add Configurations</code> 进入运行配置页面。</li></ol><p><img src=/%E7%AC%AC2%E9%98%B6%E6%AE%B5-WEB/JB2-5-Tomcat/image/963cd73d796d8baee2440222691fa224.png alt></p><ol start=2><li>初次配置时依次点击 <code>+ -> Tomcat Server -> Local</code> 进入Tomcat添加页面。<ol><li>在 <code>Name</code> 栏配置Tomcat的名字，如 <code>Tomcat9040</code>。</li><li>在 <code>Application server</code> 栏点击 <code>Configure...</code> 按钮，选择Tomcat家目录进行配置。</li><li>在 <code>HTTP port</code> 栏修改端口，默认为8080。</li></ol></li></ol><p><img src=/%E7%AC%AC2%E9%98%B6%E6%AE%B5-WEB/JB2-5-Tomcat/image/4243ea9f86e93a06e19da496d08d31e8.png alt></p><blockquote><p>武技: 创建War包Maven子项目 <code>v2-5-web-tomcat</code>，该项目用于学习Tomcat技术</p></blockquote><ol><li>进入 <code>File -> New Module</code> 界面，左侧选择 <code>Maven</code> 选项卡。</li><li>勾选 <code>Create from archetype</code> 选项:<ul><li>在下方选择 <code>org.apache.maven.archetypes:maven-archetype-webapp</code> 并点击 <code>Next</code> 按钮。</li></ul></li></ol><p><img src=/%E7%AC%AC2%E9%98%B6%E6%AE%B5-WEB/JB2-5-Tomcat/image/a57252578cd5fc97984e03a04750f3d6.png alt></p><ol start=3><li>输入项目名称 <code>v2-5-web-tomcat</code> 并点击 <code>Next</code> 按钮:<ul><li>检查Maven相关地址和配置路径，然后点击 <code>Next</code> 按钮。</li></ul></li><li>将项目中自带的 <code>index.jsp</code> 替换为 <code>index.html</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>html</span> <span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>charset</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;UTF-8&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>title</span>&gt;Title&lt;/<span style=color:#f92672>title</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>你好 Tomcat!
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;
</span></span></code></pre></div><h2 id=ep04-tomcat项目部署>EP04. Tomcat项目部署</h2><blockquote><p>武技: 将子项目 <code>v2-5-web-tomcat</code> 部署到Tomcat中</p></blockquote><ol><li>切换到 <code>Deployment</code> 选项卡，点击 <code>+ -> Artifact...</code>: 选择 <code>exploded</code> 后缀的项目，否则热部署可能失效。</li></ol><p><img src=/%E7%AC%AC2%E9%98%B6%E6%AE%B5-WEB/JB2-5-Tomcat/image/7a99f8c22753d5cc29ab9a5b23b5349d.png alt></p><p><img src=/%E7%AC%AC2%E9%98%B6%E6%AE%B5-WEB/JB2-5-Tomcat/image/a57558c583203d4b7f362771fda4a789.png alt></p><ol start=2><li>在底部 <code>Application context</code> 中修改项目发布名，开头的 <code>/</code> 不能省略。</li></ol><p><img src=/%E7%AC%AC2%E9%98%B6%E6%AE%B5-WEB/JB2-5-Tomcat/image/6664f10fbdc3ee84ba617d1817880bc4.png alt></p><ol start=3><li>切换到 <code>Server</code> 选项卡:<ol><li>选择 <code>On "Update" action</code> 为 <code>Update classes and resources</code> 以开启热部署。</li><li>选择 <code>On frame deactivation</code> 为 <code>Update classes and resources</code> 以开启热部署。</li></ol></li></ol><p><img src=/%E7%AC%AC2%E9%98%B6%E6%AE%B5-WEB/JB2-5-Tomcat/image/9b440962c4f943d43f96938f8eb51e60.png alt></p><ol start=4><li>点击OK完成部署，使用debug方式启动Tomcat并访问首页，否则热部署失:<ul><li>cli: <code>http://localhost:8080/tomcat</code></li></ul></li></ol><h1 id=ch03-汤姆猫配置详解>CH03. 汤姆猫配置详解</h1><blockquote><p>心法: Tomcat主配文件 <code>conf/server.xml</code></p></blockquote><ul><li>Tomcat主配文件中的每一个标签都对应了Tomcat中的一个组件，负责对Tomcat中各个组件的控制。</li></ul><h2 id=ep01-server顶级标签>EP01. Server顶级标签</h2><blockquote><p>心法: 顶级标签 <code>&lt;Server></code> + <code>&lt;Listener>/&lt;GlobalNamingResources></code></p></blockquote><ul><li>父标签 <code>&lt;Server></code> 是Tomcat配置文件的根标签，代表整个Tomcat容器:<ul><li><code>&lt;Server></code> 只能存在一个。</li></ul></li><li>子标签 <code>&lt;Listener></code> 用于设置监听类。</li><li>子标签 <code>&lt;GlobalNamingResources></code> 用于配置全局资源。</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#75715e>    port=&#34;8005&#34;: 设置 `&lt;Server&gt;` 的端口号为 `8005`，若设置为 `-1` 表示禁用
</span></span></span><span style=display:flex><span><span style=color:#75715e>    shutdown=&#34;SHUTDOWN&#34;: 允许通过 `shutdown 8005` 指令来关闭Tomcat容器
</span></span></span><span style=display:flex><span><span style=color:#75715e>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;Server</span> <span style=color:#a6e22e>port=</span><span style=color:#e6db74>&#34;8005&#34;</span> <span style=color:#a6e22e>shutdown=</span><span style=color:#e6db74>&#34;SHUTDOWN&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!--监听器: Tomcat启动时，记录启动日志信息，该监听器必须写在其他监听器之前--&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;Listener</span> <span style=color:#a6e22e>className=</span><span style=color:#e6db74>&#34;org.apache.catalina.startup.VersionLoggerListener&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!--监听器: Tomcat启动时，检查APR库，即Apache可移植运行库，若存在则加载--&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;Listener</span> <span style=color:#a6e22e>className=</span><span style=color:#e6db74>&#34;org.apache.catalina.core.AprLifecycleListener&#34;</span> <span style=color:#a6e22e>SSLEngine=</span><span style=color:#e6db74>&#34;on&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!--监听器: 该监听类与类加载器导致的内存泄露有关--&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;Listener</span> <span style=color:#a6e22e>className=</span><span style=color:#e6db74>&#34;org.apache.catalina.core.JreMemoryLeakPreventionListener&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!--监听器: 初始化 `&lt;GlobalNamingResources&gt;` 标签中定义的全局JNDI资源--&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;Listener</span> <span style=color:#a6e22e>className=</span><span style=color:#e6db74>&#34;org.apache.catalina.mbeans.GlobalResourcesLifecycleListener&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!--监听器: 当Web应用因ThreadLocal导致的内存泄露而要停止时，该监听器会触发线程池中线程的更新--&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;Listener</span> <span style=color:#a6e22e>className=</span><span style=color:#e6db74>&#34;org.apache.catalina.core.ThreadLocalLeakPreventionListener&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!--全局资源标签: 用于读取某个配置文件信息以定义全局资源--&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;GlobalNamingResources&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!--读取了 `conf/tomcat-users.xml` 文件的信息--&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;Resource</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;UserDatabase&#34;</span> <span style=color:#a6e22e>auth=</span><span style=color:#e6db74>&#34;Container&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;org.apache.catalina.UserDatabase&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>description=</span><span style=color:#e6db74>&#34;User database that can be updated and saved&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>factory=</span><span style=color:#e6db74>&#34;org.apache.catalina.users.MemoryUserDatabaseFactory&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>pathname=</span><span style=color:#e6db74>&#34;conf/tomcat-users.xml&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/GlobalNamingResources&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/Server&gt;</span>
</span></span></code></pre></div><h2 id=ep02-server服务标签>EP02. Server服务标签</h2><blockquote><p>心法: 服务标签 <code>&lt;Service></code> + <code>&lt;Connector></code></p></blockquote><ul><li>父标签 <code>&lt;Service></code> 负责对外提供服务，是请求和响应的接头人:<ul><li>父标签可以存在多个以监听不同的端口。</li></ul></li><li>子标签 <code>&lt;Connector></code> 负责从客户端接收连接请求，可以存在多个，当它接收到连接请求后:<ol><li>创建 <code>request</code> 和 <code>response</code> 对象。</li><li>分配线程让 <code>&lt;Engine></code> 来处理。</li><li>接收响应结果并返回给客户端。</li></ol></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!--顶级配置标签--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;Server&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!--name=&#34;Catalina&#34;: 组件名称--&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;Service</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Catalina&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#75715e>            port=&#34;8080&#34;: 连接端口号，即允许客户端通过什么端口号连接到Tomcat
</span></span></span><span style=display:flex><span><span style=color:#75715e>            protocol=&#34;HTTP/1.1&#34;: 请求协议类型，可选 `HTTP/1.1` 或者 `AJP/1.3`（见后文）
</span></span></span><span style=display:flex><span><span style=color:#75715e>            connectionTimeout=&#34;20000&#34;`: 连接的超时时间为20秒
</span></span></span><span style=display:flex><span><span style=color:#75715e>            redirectPort=&#34;8443&#34;`: 当protocol不满足时，重定向到8443端口的 `&lt;Connector&gt;`
</span></span></span><span style=display:flex><span><span style=color:#75715e>        --&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;Connector</span> <span style=color:#a6e22e>port=</span><span style=color:#e6db74>&#34;8080&#34;</span> <span style=color:#a6e22e>protocol=</span><span style=color:#e6db74>&#34;HTTP/1.1&#34;</span> <span style=color:#a6e22e>connectionTimeout=</span><span style=color:#e6db74>&#34;20000&#34;</span> <span style=color:#a6e22e>redirectPort=</span><span style=color:#e6db74>&#34;8443&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#75715e>            AJP协议:
</span></span></span><span style=display:flex><span><span style=color:#75715e>            该协议负责和其他的HTTP服务器建立连接，在把Tomcat与其他HTTP服务器集成时，就需要用到这个连接器，
</span></span></span><span style=display:flex><span><span style=color:#75715e>            之所以使用Tomcat和其他服务器集成，是因为虽然Tomcat可以用作Servlet/JSP容器，
</span></span></span><span style=display:flex><span><span style=color:#75715e>            但是对静态资源的处理速度较慢，不如Apache和IIS等HTTP服务器，
</span></span></span><span style=display:flex><span><span style=color:#75715e>            因此常常将Tomcat与Apache等集成，前者作Servlet容器，
</span></span></span><span style=display:flex><span><span style=color:#75715e>            后者处理静态资源，而AJP协议便负责Tomcat和Apache的连接。
</span></span></span><span style=display:flex><span><span style=color:#75715e>        --&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/Service&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/Server&gt;</span>
</span></span></code></pre></div><h2 id=ep03-server引擎标签>EP03. Server引擎标签</h2><blockquote><p>心法: 引擎标签 <code>&lt;Engine></code> + <code>&lt;Realm></code></p></blockquote><ul><li>父标签 <code>&lt;Engine></code> 负责从某些 <code>&lt;Connector></code> 中接收请求，处理请求然后响应数据:<ul><li>该标签只能存在一个。</li></ul></li><li>子标签 <code>&lt;Realm></code> 提供了一种用户密码与WEB应用的映射关系，从而达到角色安全管理的作用。</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!--连接请求标签--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;Connector&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!-- 
</span></span></span><span style=display:flex><span><span style=color:#75715e>        name=&#34;Catalina&#34;: 组件名，用于用于日志和错误信息
</span></span></span><span style=display:flex><span><span style=color:#75715e>        defaultHost=&#34;localhost&#34;: 默认绑定的HOST地址为本机，此值需要与某个 `&lt;Host&gt;` 的 `name` 绑定
</span></span></span><span style=display:flex><span><span style=color:#75715e>    --&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;Engine</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Catalina&#34;</span> <span style=color:#a6e22e>defaultHost=</span><span style=color:#e6db74>&#34;localhost&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!--提供了一种用户密码与WEB应用的映射关系，从而达到角色安全管理的作用--&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;Realm</span> <span style=color:#a6e22e>className=</span><span style=color:#e6db74>&#34;org.apache.catalina.realm.LockOutRealm&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!-- 
</span></span></span><span style=display:flex><span><span style=color:#75715e>                className=&#34;org.apache.catalina.realm.UserDatabaseRealm&#34;: 一种安全管理实现类
</span></span></span><span style=display:flex><span><span style=color:#75715e>                resourceName=&#34;UserDatabase&#34;: 这个实现是在 `&lt;GlobalNamingResources&gt;` 中配置的
</span></span></span><span style=display:flex><span><span style=color:#75715e>            --&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;Realm</span> <span style=color:#a6e22e>className=</span><span style=color:#e6db74>&#34;org.apache.catalina.realm.UserDatabaseRealm&#34;</span>
</span></span><span style=display:flex><span>                   <span style=color:#a6e22e>resourceName=</span><span style=color:#e6db74>&#34;UserDatabase&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/Realm&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/Engine&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/Connector&gt;</span>
</span></span></code></pre></div><h2 id=ep04-server地址标签>EP04. Server地址标签</h2><blockquote><p>心法: 地址标签 <code>&lt;Host></code> + <code>&lt;Valve></code></p></blockquote><ul><li>父标签 <code>&lt;Host></code> 负责为Tomcat设置域名:<ul><li>父标签至少包含一个。</li></ul></li><li>子标签 <code>&lt;Valve></code>: 用于提供日志相关配置。</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!--处理引擎标签--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;Engine&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#75715e>        name=&#34;localhost&#34;: 对应 `&lt;Engine&gt;` 的 `defaultHost` 属性值
</span></span></span><span style=display:flex><span><span style=color:#75715e>        appBase=&#34;webapps&#34;: 指定Web应用所在的目录，是一个Tomcat根目录的相对路径
</span></span></span><span style=display:flex><span><span style=color:#75715e>        unpackWARs=&#34;true&#34;: tomcat则会将war包项目解压成文件夹后运行，反之表示tomcat直接运行war包项目
</span></span></span><span style=display:flex><span><span style=color:#75715e>        autoDeploy=&#34;true&#34;: tomcat在运行时定期检查新的Web应用或Web应用的更新，然后自动部署，反之不进行自动部署
</span></span></span><span style=display:flex><span><span style=color:#75715e>    --&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;Host</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;localhost&#34;</span> <span style=color:#a6e22e>appBase=</span><span style=color:#e6db74>&#34;webapps&#34;</span> <span style=color:#a6e22e>unpackWARs=</span><span style=color:#e6db74>&#34;true&#34;</span> <span style=color:#a6e22e>autoDeploy=</span><span style=color:#e6db74>&#34;true&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#75715e>            className=&#34;org.apache.catalina.valves.AccessLogValve&#34;: 日志记录类    
</span></span></span><span style=display:flex><span><span style=color:#75715e>            directory=&#34;logs&#34;: 日志存储的位置，是一个Tomcat根目录的相对路径
</span></span></span><span style=display:flex><span><span style=color:#75715e>            prefix=&#34;localhost_access_log&#34;: 日志文件的前缀  
</span></span></span><span style=display:flex><span><span style=color:#75715e>            suffix=&#34;.txt&#34;: 日志文件的后缀 
</span></span></span><span style=display:flex><span><span style=color:#75715e>            pattern=&#34;%h %l %u %t &amp;quot;%r&amp;quot; %s %b&#34;: 日志文件的格式
</span></span></span><span style=display:flex><span><span style=color:#75715e>                `%h`: 远程主机名或IP地址。
</span></span></span><span style=display:flex><span><span style=color:#75715e>                `%l`: 远程逻辑用户名，一律是&#34;-&#34;，可以忽略。
</span></span></span><span style=display:flex><span><span style=color:#75715e>                `%u`: 授权的远程用户名，如果没有，则是&#34;-&#34;。
</span></span></span><span style=display:flex><span><span style=color:#75715e>                `%t`: 访问的时间。
</span></span></span><span style=display:flex><span><span style=color:#75715e>                `%r`: 请求的第一行，即请求方法(get/post等)，uri及协议。
</span></span></span><span style=display:flex><span><span style=color:#75715e>                `%s`: 响应状态，200，404等等。
</span></span></span><span style=display:flex><span><span style=color:#75715e>                `%b`: 响应的数据量，不包括请求头，如果为0，则是&#34;-&#34;。
</span></span></span><span style=display:flex><span><span style=color:#75715e>        --&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;Valve</span> <span style=color:#a6e22e>className=</span><span style=color:#e6db74>&#34;org.apache.catalina.valves.AccessLogValve&#34;</span> <span style=color:#a6e22e>directory=</span><span style=color:#e6db74>&#34;logs&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>prefix=</span><span style=color:#e6db74>&#34;localhost_access_log&#34;</span> <span style=color:#a6e22e>suffix=</span><span style=color:#e6db74>&#34;.txt&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>pattern=</span><span style=color:#e6db74>&#34;%h %l %u %t &amp;quot;%r&amp;quot; %s %b&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/Host&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/Engine&gt;</span>
</span></span></code></pre></div><h2 id=ep05-server内容标签>EP05. Server内容标签</h2><blockquote><p>心法: 内容标签 <code>&lt;Context></code></p></blockquote><ul><li>该标签包裹内容，即一个Web应用，每个Web应用基于WAR文件，或WAR文件解压后对应的目录。</li><li>该标签在一个 <code>&lt;Host></code> 标签中可以存在多个。</li></ul><blockquote><p>武技: 在Tomcat中配置虚拟路径</p></blockquote><ol><li>在 <code>conf/server.xml</code> 中的 <code>&lt;Host></code> 首行位置映射路径:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!--地址标签--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;Host&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#75715e>        path=&#34;/upload&#34;: 设置URL虚拟路径，必须以 `/` 开头且不建议设置多层结构
</span></span></span><span style=display:flex><span><span style=color:#75715e>        docBase=&#34;C:\Users\yy062\Pictures\壁纸&#34;: 真实物理路径，要求必须真实存在，否则Tomcat启动报空指针
</span></span></span><span style=display:flex><span><span style=color:#75715e>        reloadable=&#34;true&#34;: 监听WEB-INF/classes和WEB-INF/lib目录下class文件，一旦改动则触发Web应用的重新加载
</span></span></span><span style=display:flex><span><span style=color:#75715e>    --&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;Context</span> <span style=color:#a6e22e>path=</span><span style=color:#e6db74>&#34;/upload&#34;</span> <span style=color:#a6e22e>docBase=</span><span style=color:#e6db74>&#34;C:\Users\yy062\Pictures\壁纸&#34;</span> <span style=color:#a6e22e>reloadable=</span><span style=color:#e6db74>&#34;true&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/Host&gt;</span>
</span></span></code></pre></div><ol start=2><li>在IDEA右上角点击 <code>Edit Configurations...</code>:<ul><li>勾选 <code>Deploy applications configured in Tomcat instance</code> 选项使 <code>server.xml</code> 的改动生效。</li><li>cli: <code>localhost:8080/upload/123.png</code>，路径中不要添加项目工程名。</li></ul></li><li>在IDEA中配置虚拟路径:<ul><li>点击右上角 <code>Edit Configurations...</code> 并进入 <code>Deployment</code> 选项卡。</li><li>点击 <code>+</code> - <code>External Source...</code>，选择 <code>C:\Users\yy062\Pictures\壁纸</code> 文件夹。</li><li>在下 <code>Application context</code> 栏中输入虚拟路径 <code>/upload</code> 并启动Tomcat。</li></ul></li><li>编写首页代码:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!--主题--&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>section</span>&gt;
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!--不要添加项目工程名--&gt;</span>
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/upload/123.png&#34;</span>&gt;测试Tomcat虚拟目录&lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>section</span>&gt;
</span></span></code></pre></div><ol start=5><li>测试Tomcat虚拟目录:<ul><li>cli: <code>localhost:8080/tomcat/index.html</code></li></ul></li></ol></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div></main><footer class=footer><span>&copy; 2024 The Marauders</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>